{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { append, addClass, remove, isNullOrUndefined, setStyleAttribute, createElement, prepend, removeClass } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\n/**\n * Virtual Scroll\n */\nvar VirtualScroll = /** @class */function () {\n  function VirtualScroll(parent) {\n    this.translateY = 0;\n    this.itemSize = 60;\n    this.renderedLength = 0;\n    this.averageRowHeight = 0;\n    this.startIndex = 0;\n    this.existingDataCollection = [];\n    this.enableTransition = true;\n    this.parent = parent;\n    this.bufferCount = parent.activeViewOptions.overscanCount < 3 ? 3 : parent.activeViewOptions.overscanCount;\n    this.addEventListener();\n  }\n  VirtualScroll.prototype.addEventListener = function () {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.virtualScroll, this.virtualScrolling, this);\n  };\n  VirtualScroll.prototype.removeEventListener = function () {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.virtualScroll, this.virtualScrolling);\n  };\n  VirtualScroll.prototype.getRenderedCount = function () {\n    this.setItemSize();\n    var containerSize = this.isHorizontalScroll ? this.parent.element.clientWidth : this.parent.element.clientHeight;\n    this.renderedLength = Math.ceil(containerSize / this.itemSize) + this.bufferCount;\n    return this.renderedLength;\n  };\n  VirtualScroll.prototype.renderVirtualTrack = function (contentWrap) {\n    var wrap = createElement('div', {\n      className: cls.VIRTUAL_TRACK_CLASS\n    });\n    if (this.isHorizontalScroll) {\n      var colCount = this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 1].length;\n      wrap.style.width = colCount * this.itemSize + 'px';\n    } else {\n      wrap.style.height = this.parent.resourceBase.expandedResources.length * this.itemSize + 'px';\n    }\n    contentWrap.appendChild(wrap);\n  };\n  VirtualScroll.prototype.updateVirtualScrollHeight = function () {\n    var virtual = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n    var lastResourceIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n    var lastRenderIndex = this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex;\n    if (lastRenderIndex !== lastResourceIndex) {\n      var conTable = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n      this.renderedLength = conTable.querySelector('tbody').children.length;\n      virtual.style.height = conTable.offsetHeight + (this.parent.resourceBase.expandedResources.length - this.renderedLength) * conTable.offsetHeight / this.renderedLength + 'px';\n      var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      if (conWrap.scrollHeight - conWrap.scrollTop < conWrap.offsetHeight * this.bufferCount) {\n        virtual.style.height = parseInt(virtual.style.height, 10) + conWrap.offsetHeight * this.bufferCount + 'px';\n      }\n    } else {\n      virtual.style.height = '';\n    }\n    this.averageRowHeight = virtual.offsetHeight / this.parent.resourceBase.expandedResources.length;\n  };\n  VirtualScroll.prototype.updateVirtualTrackHeight = function (wrap) {\n    var resourceCount = this.parent.resourceBase.renderedResources.length;\n    if (resourceCount !== this.getRenderedCount()) {\n      wrap.style.height = this.parent.element.querySelector('.e-content-wrap').clientHeight + 'px';\n      var resWrap = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n      var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      var eventWrap = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n      this.translateY = 0;\n      this.setTranslate(resWrap, conWrap, eventWrap);\n    } else {\n      var lastRenderIndex = this.parent.resourceBase.renderedResources[resourceCount - 1].groupIndex;\n      var lastCollIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n      var renderedResCount = resourceCount + (lastCollIndex - lastRenderIndex);\n      renderedResCount = renderedResCount > this.parent.resourceBase.expandedResources.length ? this.parent.resourceBase.expandedResources.length : renderedResCount;\n      wrap.style.height = renderedResCount * this.itemSize + 'px';\n    }\n  };\n  VirtualScroll.prototype.setItemSize = function () {\n    if (this.isHorizontalScroll) {\n      this.itemSize = util.getElementWidthFromClass(this.parent.activeView.element, cls.WORK_CELLS_CLASS, this.parent.uiStateValues.isTransformed) || this.itemSize;\n    } else {\n      this.itemSize = this.parent.getElementHeightFromClass(this.parent.activeView.element, cls.WORK_CELLS_CLASS) || this.itemSize;\n    }\n  };\n  VirtualScroll.prototype.refreshLayout = function () {\n    var initialHeight = this.parent.uiStateValues.scheduleHeight;\n    this.parent.uiStateValues.scheduleHeight = this.parent.element.offsetHeight;\n    var preRenderedLength = this.renderedLength;\n    if (this.parent.uiStateValues.scheduleHeight !== initialHeight) {\n      if (preRenderedLength < this.getRenderedCount()) {\n        this.isRemoteRefresh = true;\n      }\n      var resWrap = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n      var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      var eventWrap = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n      if (!this.parent.rowAutoHeight) {\n        this.enableTransition = false;\n        removeClass([conWrap, resWrap], 'e-transition');\n      }\n      var firstTDIndex = parseInt(resWrap.querySelector('tbody td').getAttribute('data-group-index'), 10);\n      var endIndex = firstTDIndex + this.renderedLength;\n      firstTDIndex = endIndex > this.parent.resourceBase.expandedResources.length ? this.parent.resourceBase.expandedResources.length - this.renderedLength : firstTDIndex;\n      firstTDIndex = firstTDIndex < 0 ? 0 : firstTDIndex;\n      this.existingDataCollection = this.parent.resourceBase.renderedResources;\n      this.parent.resourceBase.renderedResources = this.parent.resourceBase.expandedResources.slice(firstTDIndex, endIndex);\n      if (this.parent.resourceBase.renderedResources.length > 0) {\n        this.updateContent(resWrap, conWrap, eventWrap, this.parent.resourceBase.renderedResources);\n      }\n    }\n  };\n  VirtualScroll.prototype.renderEvents = function () {\n    this.setTabIndex();\n    var dynamicData = this.triggerScrollEvent(events.virtualScrollStop);\n    if (this.parent.activeViewOptions && this.parent.activeViewOptions.enableLazyLoading && this.parent.crudModule) {\n      if (dynamicData.length > 0) {\n        this.parent.crudModule.refreshProcessedData(true, dynamicData);\n        this.parent.hideSpinner();\n        return;\n      }\n      this.parent.crudModule.refreshDataManager();\n      return;\n    }\n    if (this.parent.crudModule) {\n      this.parent.crudModule.refreshProcessedData(true);\n    }\n    if (this.parent.currentView !== 'Month') {\n      this.parent.notify(events.contentReady, {});\n    }\n    this.parent.hideSpinner();\n  };\n  VirtualScroll.prototype.virtualScrolling = function () {\n    var _this = this;\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide();\n      this.parent.quickPopup.morePopup.hide();\n    }\n    var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    if (this.isHorizontalScroll) {\n      this.horizontalScrolling(conWrap);\n    } else {\n      var resWrap = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n      var eventWrap = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n      var timeIndicator = this.parent.element.querySelector('.' + cls.CURRENT_TIMELINE_CLASS);\n      var conTable = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n      if (!this.parent.rowAutoHeight) {\n        addClass([conWrap, resWrap], 'e-transition');\n      }\n      this.renderedLength = resWrap.querySelector('tbody').children.length;\n      var firstTDIndex = parseInt(resWrap.querySelector('tbody td').getAttribute('data-group-index'), 10);\n      var scrollHeight = this.parent.rowAutoHeight ? conTable.offsetHeight - conWrap.offsetHeight : this.bufferCount * this.itemSize;\n      var resCollection = [];\n      this.existingDataCollection = this.parent.resourceBase.renderedResources;\n      if (conWrap.scrollTop - this.translateY < 0) {\n        resCollection = this.upScroll(conWrap, firstTDIndex);\n      } else if (conWrap.scrollTop - this.translateY > scrollHeight) {\n        resCollection = this.downScroll(conWrap, firstTDIndex);\n      }\n      if (!isNullOrUndefined(resCollection) && resCollection.length > 0) {\n        this.triggerScrollEvent(events.virtualScrollStart);\n        var selectedEle = this.parent.getSelectedCells();\n        this.focusedEle = selectedEle[selectedEle.length - 1] || this.focusedEle;\n        this.updateContent(resWrap, conWrap, eventWrap, resCollection);\n        this.setTranslate(resWrap, conWrap, eventWrap, timeIndicator);\n        if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj.action === 'drag') {\n          this.parent.dragAndDropModule.navigationWrapper();\n        }\n        window.clearTimeout(this.timeValue);\n        this.timeValue = window.setTimeout(function () {\n          _this.renderEvents();\n        }, 250);\n      }\n    }\n  };\n  VirtualScroll.prototype.horizontalScrolling = function (conWrap) {\n    var _this = this;\n    var resCollection = [];\n    var scrollWidth = this.bufferCount * this.itemSize;\n    if (Math.abs(conWrap.scrollLeft) - Math.abs(this.translateY) < 0) {\n      resCollection = this.leftScroll(conWrap);\n    } else if (Math.abs(conWrap.scrollLeft) - Math.abs(this.translateY) > scrollWidth) {\n      resCollection = this.rightScroll(conWrap);\n    }\n    if (!isNullOrUndefined(resCollection) && resCollection.length > 0) {\n      if (this.parent.resourceBase.expandedResources.length !== resCollection.length || this.parent.resourceBase.expandedResources[0] !== resCollection[0] || this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1] !== resCollection[resCollection.length - 1]) {\n        this.triggerScrollEvent(events.virtualScrollStart);\n        var colLevels = this.parent.activeView.colLevels.slice(0);\n        this.updateHorizontalContent(conWrap, resCollection);\n        setStyleAttribute(conWrap.querySelector('table'), {\n          transform: \"translateX(\" + this.translateY + \"px)\"\n        });\n        this.parent.activeView.colLevels = colLevels;\n        if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj.action === 'drag') {\n          this.parent.dragAndDropModule.navigationWrapper();\n        }\n      }\n      window.clearTimeout(this.timeValue);\n      this.timeValue = window.setTimeout(function () {\n        _this.renderEvents();\n      }, 250);\n    }\n  };\n  VirtualScroll.prototype.triggerScrollEvent = function (action) {\n    var _this = this;\n    var dynamicData = [];\n    if (!this.parent.activeView) {\n      return dynamicData;\n    }\n    var eventArgs = {\n      startDate: this.parent.activeView.startDate(),\n      endDate: this.parent.activeView.endDate(),\n      startIndex: this.parent.resourceBase.renderedResources[0].groupIndex,\n      endIndex: this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex,\n      resourceData: this.parent.resourceBase.renderedResources.map(function (x) {\n        return x.resourceData;\n      }),\n      name: action\n    };\n    this.parent.trigger(action, eventArgs, function (args) {\n      if (action === events.virtualScrollStart) {\n        _this.parent.showSpinner();\n      } else if (action === events.virtualScrollStop && !isNullOrUndefined(args.eventData) && args.eventData.length > 0) {\n        dynamicData = args.eventData;\n      }\n    });\n    return dynamicData;\n  };\n  VirtualScroll.prototype.upScroll = function (conWrap, firstTDIndex) {\n    var index = 0;\n    index = ~~(conWrap.scrollTop / this.itemSize) + Math.ceil(conWrap.clientHeight / this.itemSize) - this.renderedLength;\n    if (this.parent.rowAutoHeight) {\n      index = index > firstTDIndex ? firstTDIndex - this.bufferCount : index;\n    }\n    index = index > 0 ? index : 0;\n    var prevSetCollection = this.getBufferCollection(index, index + this.renderedLength);\n    this.parent.resourceBase.renderedResources = prevSetCollection;\n    if (firstTDIndex === 0) {\n      this.translateY = conWrap.scrollTop;\n    } else {\n      var height = this.parent.rowAutoHeight ? this.averageRowHeight : this.itemSize;\n      height = height > 0 ? height : this.itemSize;\n      this.translateY = conWrap.scrollTop - this.bufferCount * height > 0 ? conWrap.scrollTop - this.bufferCount * height : 0;\n    }\n    return prevSetCollection;\n  };\n  VirtualScroll.prototype.downScroll = function (conWrap, firstTDIndex) {\n    var lastResource = this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex;\n    var lastResourceIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n    if (lastResource === lastResourceIndex) {\n      return null;\n    }\n    var nextSetResIndex = 0;\n    nextSetResIndex = ~~(conWrap.scrollTop / this.itemSize);\n    if (this.parent.rowAutoHeight) {\n      nextSetResIndex = ~~((conWrap.scrollTop - this.translateY) / this.averageRowHeight) + firstTDIndex;\n      nextSetResIndex = nextSetResIndex > firstTDIndex + this.bufferCount ? nextSetResIndex : firstTDIndex + this.bufferCount;\n    }\n    var lastIndex = nextSetResIndex + this.renderedLength;\n    lastIndex = lastIndex > this.parent.resourceBase.expandedResources.length ? nextSetResIndex + (this.parent.resourceBase.expandedResources.length - nextSetResIndex) : lastIndex;\n    var nextSetCollection = this.getBufferCollection(lastIndex - this.renderedLength, lastIndex);\n    this.translateY = conWrap.scrollTop;\n    return nextSetCollection;\n  };\n  VirtualScroll.prototype.leftScroll = function (conWrap) {\n    var index = 0;\n    index = ~~(Math.abs(conWrap.scrollLeft) / this.itemSize) + Math.ceil(conWrap.clientWidth / this.itemSize) - this.renderedLength;\n    index = index > 0 ? index : 0;\n    return this.getCollection(index, index + this.renderedLength);\n  };\n  VirtualScroll.prototype.rightScroll = function (conWrap) {\n    var lastLevel = this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 1];\n    var nextSetIndex = 0;\n    nextSetIndex = ~~(Math.abs(conWrap.scrollLeft) / this.itemSize);\n    var lastIndex = nextSetIndex + this.renderedLength;\n    lastIndex = lastIndex > lastLevel.length - 1 ? lastLevel.length - 1 : lastIndex;\n    return this.getCollection(lastIndex - this.renderedLength, lastIndex);\n  };\n  VirtualScroll.prototype.getCollection = function (startIndex, endIndex) {\n    this.translateY = startIndex * this.itemSize;\n    startIndex = startIndex < 0 ? 0 : startIndex;\n    var lastLevel = this.getResCollection(startIndex, endIndex);\n    if (this.parent.enableRtl) {\n      this.translateY = -this.translateY;\n    }\n    return lastLevel;\n  };\n  VirtualScroll.prototype.getResCollection = function (startIndex, endIndex) {\n    var lastLevel = this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 1];\n    endIndex = endIndex > lastLevel.length ? lastLevel.length - 1 : endIndex;\n    var resCollection = [];\n    var index = {\n      startIndex: 0,\n      endIndex: 0\n    };\n    if (this.parent.activeViewOptions.group.byDate) {\n      if (lastLevel[parseInt(startIndex.toString(), 10)].date.getTime() === this.parent.resourceBase.expandedResources[0].date.getTime() && lastLevel[parseInt(endIndex.toString(), 10)].date.getTime() === this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].date.getTime()) {\n        return this.parent.resourceBase.expandedResources;\n      }\n      resCollection = this.getByDateCollection(lastLevel[parseInt(startIndex.toString(), 10)], lastLevel[parseInt(endIndex.toString(), 10)], index);\n      this.setRenderedDates(resCollection);\n    } else {\n      if (lastLevel[parseInt(startIndex.toString(), 10)].groupIndex === this.parent.resourceBase.expandedResources[0].groupIndex && lastLevel[parseInt(endIndex.toString(), 10)].groupIndex === this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex) {\n        return this.parent.resourceBase.expandedResources;\n      }\n      resCollection = this.getByIdCollection(lastLevel[parseInt(startIndex.toString(), 10)], lastLevel[parseInt(endIndex.toString(), 10)], index);\n    }\n    if (this.parent.currentView !== 'Month') {\n      this.startIndex = index.startIndex;\n      resCollection = lastLevel.slice(index.startIndex, index.endIndex);\n    }\n    this.translateY = index.startIndex * this.itemSize;\n    return resCollection;\n  };\n  VirtualScroll.prototype.getByDateCollection = function (firstItem, lastItem, index) {\n    var resCollection = this.parent.activeView.colLevels[0].filter(function (data) {\n      return firstItem.date.getTime() <= data.date.getTime() && data.date.getTime() <= lastItem.date.getTime();\n    });\n    this.setStartEndIndex(this.parent.activeView.colLevels[0], resCollection[0], resCollection[resCollection.length - 1], index);\n    return resCollection;\n  };\n  VirtualScroll.prototype.getByIdCollection = function (firstItem, lastItem, index) {\n    var resCollection = this.parent.resourceBase.lastResourceLevel.filter(function (data) {\n      return firstItem.groupIndex <= data.groupIndex && data.groupIndex <= lastItem.groupIndex;\n    });\n    this.parent.resourceBase.renderedResources = resCollection;\n    this.setStartEndIndex(this.parent.resourceBase.lastResourceLevel, resCollection[0], resCollection[resCollection.length - 1], index);\n    return resCollection;\n  };\n  VirtualScroll.prototype.setStartEndIndex = function (data, firstItem, lastItem, colIndex) {\n    var index = 0;\n    data.filter(function (data) {\n      if (firstItem === data) {\n        colIndex.startIndex = index;\n      } else if (lastItem === data) {\n        colIndex.endIndex = index + data.colSpan;\n      }\n      index += data.colSpan;\n    });\n    if (firstItem === lastItem) {\n      colIndex.endIndex = colIndex.startIndex + lastItem.colSpan;\n    }\n  };\n  VirtualScroll.prototype.updateContent = function (resWrap, conWrap, eventWrap, resCollection) {\n    var renderedLength = resWrap.querySelector('tbody').children.length;\n    if (document.activeElement && document.activeElement.classList.contains(cls.RESOURCE_CELLS_CLASS)) {\n      this.isResourceCell = true;\n      this.parent.element.focus();\n    }\n    for (var i = 0; i < renderedLength; i++) {\n      remove(eventWrap.querySelector('div'));\n    }\n    this.parent.resourceBase.renderedResources = resCollection;\n    var currentGroupIndices = this.parent.activeView.getGroupIndices(resCollection);\n    var previousGroupIndices = this.parent.activeView.getGroupIndices(this.existingDataCollection);\n    var newGroupIndices = currentGroupIndices.filter(function (index) {\n      return previousGroupIndices.indexOf(index) < 0;\n    });\n    var resWrapRows = Array.from(resWrap.querySelectorAll('tbody tr'));\n    var conWrapRows = Array.from(conWrap.querySelectorAll('tbody tr'));\n    var resWrapBody = resWrap.querySelector('tbody');\n    var conWrapBody = conWrap.querySelector('tbody');\n    this.removeObsoleteRows(resWrapRows, currentGroupIndices);\n    this.removeObsoleteRows(conWrapRows, currentGroupIndices);\n    var resourceRows = this.parent.resourceBase.getContentRows(resCollection, true);\n    var contentRows = this.parent.activeView.getContentRows();\n    var eventRows = this.parent.activeView.getEventRows(resCollection.length);\n    for (var i = 0; i < newGroupIndices.length; i++) {\n      var index = currentGroupIndices.indexOf(newGroupIndices[parseInt(i.toString(), 10)]);\n      if (index === 0) {\n        prepend([resourceRows[parseInt(i.toString(), 10)]], resWrapBody);\n        prepend([contentRows[parseInt(i.toString(), 10)]], conWrapBody);\n      } else if (resWrapBody && conWrapBody && resWrapBody.children[parseInt(index.toString(), 10)] && conWrapBody.children[parseInt(index.toString(), 10)]) {\n        resWrapBody.insertBefore(resourceRows[parseInt(i.toString(), 10)], resWrapBody.children[parseInt(index.toString(), 10)]);\n        conWrapBody.insertBefore(contentRows[parseInt(i.toString(), 10)], conWrapBody.children[parseInt(index.toString(), 10)]);\n      } else {\n        append([resourceRows[parseInt(i.toString(), 10)]], resWrapBody);\n        append([contentRows[parseInt(i.toString(), 10)]], conWrapBody);\n      }\n    }\n    append(eventRows, eventWrap);\n  };\n  VirtualScroll.prototype.removeObsoleteRows = function (elements, currentGroupIndices) {\n    elements.forEach(function (element) {\n      var groupIndex = parseInt(element.firstElementChild.getAttribute('data-group-index'), 10);\n      if (currentGroupIndices.indexOf(groupIndex) < 0) {\n        remove(element);\n      }\n    });\n  };\n  VirtualScroll.prototype.updateHorizontalContent = function (conWrap, resCollection) {\n    this.existingDataCollection = this.parent.resourceBase.expandedResources;\n    this.parent.resourceBase.expandedResources = resCollection;\n    var selectedEle = this.parent.getSelectedCells();\n    this.focusedEle = selectedEle[selectedEle.length - 1] || this.focusedEle;\n    var tbody = conWrap.querySelector('tbody');\n    var renderedRows = Array.from(tbody.querySelectorAll('tr'));\n    if (this.parent.currentView === 'Month') {\n      this.updateMonthViewContent(conWrap, resCollection);\n    } else {\n      this.updateOtherViewContent(conWrap, resCollection, renderedRows);\n    }\n  };\n  VirtualScroll.prototype.updateMonthViewContent = function (conWrap, resCollection) {\n    var renderedLength = conWrap.querySelectorAll(' tr').length;\n    for (var i = 0; i < renderedLength; i++) {\n      remove(conWrap.querySelector('tbody tr'));\n    }\n    if (this.parent.activeViewOptions.group.byDate) {\n      this.parent.activeView.colLevels[0] = resCollection;\n    } else {\n      this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 2] = resCollection;\n    }\n    var contentRows = this.parent.activeView.getContentRows();\n    append(contentRows, conWrap.querySelector('tbody'));\n  };\n  VirtualScroll.prototype.updateOtherViewContent = function (conWrap, resCollection, renderedRows) {\n    var tbody = conWrap.querySelector('tbody');\n    var colGroup = conWrap.querySelector('colgroup');\n    var thead = conWrap.querySelector('thead');\n    var table = conWrap.querySelector('table');\n    this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 1] = resCollection;\n    var newGroupIndices = new Set(resCollection.map(function (data) {\n      return data.groupIndex;\n    }));\n    renderedRows.forEach(function (row) {\n      var tdElements = row.querySelectorAll('td');\n      tdElements.forEach(function (td) {\n        var groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        if (!newGroupIndices.has(groupIndex)) {\n          td.remove();\n        }\n      });\n    });\n    var col = [].slice.call(conWrap.querySelector('colgroup').children);\n    for (var i = 0; i < col.length; i++) {\n      remove(col[parseInt(i.toString(), 10)]);\n    }\n    resCollection.forEach(function () {\n      return colGroup.appendChild(createElement('col'));\n    });\n    var tHead = [].slice.call(conWrap.querySelector('thead').children);\n    for (var i = 0; i < tHead.length; i++) {\n      remove(tHead[parseInt(i.toString(), 10)]);\n    }\n    thead.appendChild(this.parent.eventBase.createEventWrapper('', this.startIndex > 0 ? this.startIndex : 0));\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      thead.appendChild(this.parent.eventBase.createEventWrapper('timeIndicator'));\n    }\n    prepend([thead], table);\n    var contentRows = this.parent.activeView.getContentRows();\n    this.mergeNewTdData(tbody, contentRows);\n  };\n  VirtualScroll.prototype.mergeNewTdData = function (tbody, contentRows) {\n    var existingRows = Array.from(tbody.querySelectorAll('tr'));\n    existingRows.forEach(function (existingRow, rowIndex) {\n      if (rowIndex < contentRows.length) {\n        var newRow = contentRows[parseInt(rowIndex.toString(), 10)];\n        var existingTds_1 = Array.from(existingRow.querySelectorAll('td'));\n        var newTds = Array.from(newRow.querySelectorAll('td'));\n        newTds.forEach(function (newTd) {\n          var newGroupIndex = parseInt(newTd.getAttribute('data-group-index').toString(), 10);\n          var inserted = false;\n          for (var _i = 0, existingTds_2 = existingTds_1; _i < existingTds_2.length; _i++) {\n            var existingTd = existingTds_2[_i];\n            var existingGroupIndex = parseInt(existingTd.getAttribute('data-group-index').toString(), 10);\n            if (newGroupIndex < existingGroupIndex) {\n              existingRow.insertBefore(newTd, existingTd);\n              inserted = true;\n              break;\n            }\n          }\n          if (!inserted) {\n            existingRow.appendChild(newTd);\n          }\n        });\n      }\n    });\n  };\n  VirtualScroll.prototype.getBufferCollection = function (startIndex, endIndex) {\n    return this.parent.resourceBase.expandedResources.slice(startIndex, endIndex);\n  };\n  VirtualScroll.prototype.setTranslate = function (resWrap, conWrap, eventWrap, timeIndicator) {\n    setStyleAttribute(resWrap.querySelector('table'), {\n      transform: \"translateY(\" + this.translateY + \"px)\"\n    });\n    setStyleAttribute(conWrap.querySelector('table'), {\n      transform: \"translateY(\" + this.translateY + \"px)\"\n    });\n    setStyleAttribute(eventWrap, {\n      transform: \"translateY(\" + this.translateY + \"px)\"\n    });\n    if (!isNullOrUndefined(timeIndicator)) {\n      setStyleAttribute(timeIndicator, {\n        transform: \"translateY(\" + this.translateY + \"px)\"\n      });\n    }\n  };\n  VirtualScroll.prototype.updateFocusedWorkCell = function () {\n    if (this.focusedEle) {\n      var date = parseInt(this.focusedEle.getAttribute('data-date'), 10);\n      var groupIndex = parseInt(this.focusedEle.getAttribute('data-group-index'), 10);\n      var ele = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-date=\\\"\" + date + \"\\\"][data-group-index=\\\"\" + groupIndex + \"\\\"]\");\n      if (ele) {\n        this.parent.addSelectedClass([ele], ele, true);\n      }\n      this.focusedEle = null;\n    }\n  };\n  VirtualScroll.prototype.setRenderedDates = function (resCollection) {\n    if (this.parent.currentView !== 'Month') {\n      var dateCol_1 = resCollection.map(function (x) {\n        return x.date;\n      });\n      this.parent.resourceBase.renderedResources.forEach(function (x) {\n        return x.renderDates = dateCol_1;\n      });\n    } else {\n      var dateCol_2 = resCollection.map(function (x) {\n        return x.date.getDay();\n      });\n      var renderDates_1 = this.parent.activeView.renderDates.filter(function (x) {\n        return dateCol_2.indexOf(x.getDay()) >= 0;\n      });\n      this.parent.resourceBase.renderedResources.forEach(function (x) {\n        return x.renderDates = renderDates_1;\n      });\n    }\n  };\n  VirtualScroll.prototype.setTabIndex = function () {\n    var resColWrap = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n    var resCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.RESOURCE_CELLS_CLASS));\n    if (resCells && resColWrap) {\n      resCells.forEach(function (element) {\n        if (element.getBoundingClientRect().top >= resColWrap.getBoundingClientRect().top) {\n          element.setAttribute('tabindex', '0');\n        }\n      });\n    }\n    var focusResCell = this.parent.element.querySelector(\".\" + cls.RESOURCE_CELLS_CLASS + \"[tabindex=\\\"\" + 0 + \"\\\"]\");\n    if (this.isResourceCell && focusResCell) {\n      focusResCell.focus();\n      this.isResourceCell = false;\n    }\n  };\n  VirtualScroll.prototype.destroy = function () {\n    this.removeEventListener();\n    this.focusedEle = null;\n  };\n  return VirtualScroll;\n}();\nexport { VirtualScroll };","map":{"version":3,"names":["append","addClass","remove","isNullOrUndefined","setStyleAttribute","createElement","prepend","removeClass","events","cls","util","VirtualScroll","parent","translateY","itemSize","renderedLength","averageRowHeight","startIndex","existingDataCollection","enableTransition","bufferCount","activeViewOptions","overscanCount","addEventListener","prototype","isDestroyed","on","virtualScroll","virtualScrolling","removeEventListener","off","getRenderedCount","setItemSize","containerSize","isHorizontalScroll","element","clientWidth","clientHeight","Math","ceil","renderVirtualTrack","contentWrap","wrap","className","VIRTUAL_TRACK_CLASS","colCount","activeView","colLevels","length","style","width","height","resourceBase","expandedResources","appendChild","updateVirtualScrollHeight","virtual","querySelector","lastResourceIndex","groupIndex","lastRenderIndex","renderedResources","conTable","CONTENT_TABLE_CLASS","children","offsetHeight","conWrap","CONTENT_WRAP_CLASS","scrollHeight","scrollTop","parseInt","updateVirtualTrackHeight","resourceCount","resWrap","RESOURCE_COLUMN_WRAP_CLASS","eventWrap","EVENT_TABLE_CLASS","setTranslate","lastCollIndex","renderedResCount","getElementWidthFromClass","WORK_CELLS_CLASS","uiStateValues","isTransformed","getElementHeightFromClass","refreshLayout","initialHeight","scheduleHeight","preRenderedLength","isRemoteRefresh","rowAutoHeight","firstTDIndex","getAttribute","endIndex","slice","updateContent","renderEvents","setTabIndex","dynamicData","triggerScrollEvent","virtualScrollStop","enableLazyLoading","crudModule","refreshProcessedData","hideSpinner","refreshDataManager","currentView","notify","contentReady","_this","quickPopup","quickPopupHide","morePopup","hide","horizontalScrolling","timeIndicator","CURRENT_TIMELINE_CLASS","resCollection","upScroll","downScroll","virtualScrollStart","selectedEle","getSelectedCells","focusedEle","dragAndDropModule","actionObj","action","navigationWrapper","window","clearTimeout","timeValue","setTimeout","scrollWidth","abs","scrollLeft","leftScroll","rightScroll","updateHorizontalContent","transform","eventArgs","startDate","endDate","resourceData","map","x","name","trigger","args","showSpinner","eventData","index","prevSetCollection","getBufferCollection","lastResource","nextSetResIndex","lastIndex","nextSetCollection","getCollection","lastLevel","nextSetIndex","getResCollection","enableRtl","group","byDate","toString","date","getTime","getByDateCollection","setRenderedDates","getByIdCollection","firstItem","lastItem","filter","data","setStartEndIndex","lastResourceLevel","colIndex","colSpan","document","activeElement","classList","contains","RESOURCE_CELLS_CLASS","isResourceCell","focus","i","currentGroupIndices","getGroupIndices","previousGroupIndices","newGroupIndices","indexOf","resWrapRows","Array","from","querySelectorAll","conWrapRows","resWrapBody","conWrapBody","removeObsoleteRows","resourceRows","getContentRows","contentRows","eventRows","getEventRows","insertBefore","elements","forEach","firstElementChild","tbody","renderedRows","updateMonthViewContent","updateOtherViewContent","colGroup","thead","table","Set","row","tdElements","td","has","col","call","tHead","eventBase","createEventWrapper","timeScale","enable","mergeNewTdData","existingRows","existingRow","rowIndex","newRow","existingTds_1","newTds","newTd","newGroupIndex","inserted","_i","existingTds_2","existingTd","existingGroupIndex","updateFocusedWorkCell","ele","addSelectedClass","dateCol_1","renderDates","dateCol_2","getDay","renderDates_1","resColWrap","resCells","getBoundingClientRect","top","setAttribute","focusResCell","destroy"],"sources":["C:/Users/Dell/OneDrive/Desktop/Programs/soc-portal/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/virtual-scroll.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { append, addClass, remove, isNullOrUndefined, setStyleAttribute, createElement, prepend, removeClass } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\n/**\n * Virtual Scroll\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll(parent) {\n        this.translateY = 0;\n        this.itemSize = 60;\n        this.renderedLength = 0;\n        this.averageRowHeight = 0;\n        this.startIndex = 0;\n        this.existingDataCollection = [];\n        this.enableTransition = true;\n        this.parent = parent;\n        this.bufferCount = parent.activeViewOptions.overscanCount < 3 ? 3 : parent.activeViewOptions.overscanCount;\n        this.addEventListener();\n    }\n    VirtualScroll.prototype.addEventListener = function () {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.virtualScroll, this.virtualScrolling, this);\n    };\n    VirtualScroll.prototype.removeEventListener = function () {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.virtualScroll, this.virtualScrolling);\n    };\n    VirtualScroll.prototype.getRenderedCount = function () {\n        this.setItemSize();\n        var containerSize = this.isHorizontalScroll ? this.parent.element.clientWidth : this.parent.element.clientHeight;\n        this.renderedLength = Math.ceil(containerSize / this.itemSize) + this.bufferCount;\n        return this.renderedLength;\n    };\n    VirtualScroll.prototype.renderVirtualTrack = function (contentWrap) {\n        var wrap = createElement('div', { className: cls.VIRTUAL_TRACK_CLASS });\n        if (this.isHorizontalScroll) {\n            var colCount = this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 1].length;\n            wrap.style.width = (colCount * this.itemSize) + 'px';\n        }\n        else {\n            wrap.style.height = (this.parent.resourceBase.expandedResources.length * this.itemSize) + 'px';\n        }\n        contentWrap.appendChild(wrap);\n    };\n    VirtualScroll.prototype.updateVirtualScrollHeight = function () {\n        var virtual = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n        var lastResourceIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n        var lastRenderIndex = this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex;\n        if (lastRenderIndex !== lastResourceIndex) {\n            var conTable = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n            this.renderedLength = conTable.querySelector('tbody').children.length;\n            virtual.style.height = (conTable.offsetHeight + (this.parent.resourceBase.expandedResources.length - (this.renderedLength)) *\n                conTable.offsetHeight / this.renderedLength) + 'px';\n            var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            if ((conWrap.scrollHeight - conWrap.scrollTop) < conWrap.offsetHeight * this.bufferCount) {\n                virtual.style.height = parseInt(virtual.style.height, 10) + (conWrap.offsetHeight * this.bufferCount) + 'px';\n            }\n        }\n        else {\n            virtual.style.height = '';\n        }\n        this.averageRowHeight = virtual.offsetHeight / this.parent.resourceBase.expandedResources.length;\n    };\n    VirtualScroll.prototype.updateVirtualTrackHeight = function (wrap) {\n        var resourceCount = this.parent.resourceBase.renderedResources.length;\n        if (resourceCount !== this.getRenderedCount()) {\n            wrap.style.height = this.parent.element.querySelector('.e-content-wrap').clientHeight + 'px';\n            var resWrap = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n            var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            var eventWrap = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n            this.translateY = 0;\n            this.setTranslate(resWrap, conWrap, eventWrap);\n        }\n        else {\n            var lastRenderIndex = this.parent.resourceBase.renderedResources[resourceCount - 1].groupIndex;\n            var lastCollIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n            var renderedResCount = resourceCount + (lastCollIndex - lastRenderIndex);\n            renderedResCount = (renderedResCount > this.parent.resourceBase.expandedResources.length) ?\n                this.parent.resourceBase.expandedResources.length : renderedResCount;\n            wrap.style.height = (renderedResCount * this.itemSize) + 'px';\n        }\n    };\n    VirtualScroll.prototype.setItemSize = function () {\n        if (this.isHorizontalScroll) {\n            this.itemSize = util.getElementWidthFromClass(this.parent.activeView.element, cls.WORK_CELLS_CLASS, this.parent.uiStateValues.isTransformed) || this.itemSize;\n        }\n        else {\n            this.itemSize = this.parent.getElementHeightFromClass(this.parent.activeView.element, cls.WORK_CELLS_CLASS) || this.itemSize;\n        }\n    };\n    VirtualScroll.prototype.refreshLayout = function () {\n        var initialHeight = this.parent.uiStateValues.scheduleHeight;\n        this.parent.uiStateValues.scheduleHeight = this.parent.element.offsetHeight;\n        var preRenderedLength = this.renderedLength;\n        if (this.parent.uiStateValues.scheduleHeight !== initialHeight) {\n            if (preRenderedLength < this.getRenderedCount()) {\n                this.isRemoteRefresh = true;\n            }\n            var resWrap = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n            var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            var eventWrap = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n            if (!this.parent.rowAutoHeight) {\n                this.enableTransition = false;\n                removeClass([conWrap, resWrap], 'e-transition');\n            }\n            var firstTDIndex = parseInt(resWrap.querySelector('tbody td').getAttribute('data-group-index'), 10);\n            var endIndex = (firstTDIndex + this.renderedLength);\n            firstTDIndex = (endIndex > this.parent.resourceBase.expandedResources.length) ?\n                (this.parent.resourceBase.expandedResources.length - this.renderedLength) : firstTDIndex;\n            firstTDIndex = firstTDIndex < 0 ? 0 : firstTDIndex;\n            this.existingDataCollection = this.parent.resourceBase.renderedResources;\n            this.parent.resourceBase.renderedResources = this.parent.resourceBase.expandedResources.slice(firstTDIndex, endIndex);\n            if (this.parent.resourceBase.renderedResources.length > 0) {\n                this.updateContent(resWrap, conWrap, eventWrap, this.parent.resourceBase.renderedResources);\n            }\n        }\n    };\n    VirtualScroll.prototype.renderEvents = function () {\n        this.setTabIndex();\n        var dynamicData = this.triggerScrollEvent(events.virtualScrollStop);\n        if (this.parent.activeViewOptions && this.parent.activeViewOptions.enableLazyLoading && this.parent.crudModule) {\n            if (dynamicData.length > 0) {\n                this.parent.crudModule.refreshProcessedData(true, dynamicData);\n                this.parent.hideSpinner();\n                return;\n            }\n            this.parent.crudModule.refreshDataManager();\n            return;\n        }\n        if (this.parent.crudModule) {\n            this.parent.crudModule.refreshProcessedData(true);\n        }\n        if (this.parent.currentView !== 'Month') {\n            this.parent.notify(events.contentReady, {});\n        }\n        this.parent.hideSpinner();\n    };\n    VirtualScroll.prototype.virtualScrolling = function () {\n        var _this = this;\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n            this.parent.quickPopup.morePopup.hide();\n        }\n        var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (this.isHorizontalScroll) {\n            this.horizontalScrolling(conWrap);\n        }\n        else {\n            var resWrap = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n            var eventWrap = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n            var timeIndicator = this.parent.element.querySelector('.' + cls.CURRENT_TIMELINE_CLASS);\n            var conTable = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n            if (!this.parent.rowAutoHeight) {\n                addClass([conWrap, resWrap], 'e-transition');\n            }\n            this.renderedLength = resWrap.querySelector('tbody').children.length;\n            var firstTDIndex = parseInt(resWrap.querySelector('tbody td').getAttribute('data-group-index'), 10);\n            var scrollHeight = this.parent.rowAutoHeight ?\n                (conTable.offsetHeight - conWrap.offsetHeight) : this.bufferCount * this.itemSize;\n            var resCollection = [];\n            this.existingDataCollection = this.parent.resourceBase.renderedResources;\n            if ((conWrap.scrollTop) - this.translateY < 0) {\n                resCollection = this.upScroll(conWrap, firstTDIndex);\n            }\n            else if (conWrap.scrollTop - this.translateY > scrollHeight) {\n                resCollection = this.downScroll(conWrap, firstTDIndex);\n            }\n            if (!isNullOrUndefined(resCollection) && resCollection.length > 0) {\n                this.triggerScrollEvent(events.virtualScrollStart);\n                var selectedEle = this.parent.getSelectedCells();\n                this.focusedEle = selectedEle[selectedEle.length - 1] || this.focusedEle;\n                this.updateContent(resWrap, conWrap, eventWrap, resCollection);\n                this.setTranslate(resWrap, conWrap, eventWrap, timeIndicator);\n                if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj.action === 'drag') {\n                    this.parent.dragAndDropModule.navigationWrapper();\n                }\n                window.clearTimeout(this.timeValue);\n                this.timeValue = window.setTimeout(function () { _this.renderEvents(); }, 250);\n            }\n        }\n    };\n    VirtualScroll.prototype.horizontalScrolling = function (conWrap) {\n        var _this = this;\n        var resCollection = [];\n        var scrollWidth = this.bufferCount * this.itemSize;\n        if (Math.abs(conWrap.scrollLeft) - Math.abs(this.translateY) < 0) {\n            resCollection = this.leftScroll(conWrap);\n        }\n        else if (Math.abs(conWrap.scrollLeft) - Math.abs(this.translateY) > scrollWidth) {\n            resCollection = this.rightScroll(conWrap);\n        }\n        if (!isNullOrUndefined(resCollection) && resCollection.length > 0) {\n            if (this.parent.resourceBase.expandedResources.length !== resCollection.length ||\n                this.parent.resourceBase.expandedResources[0] !== resCollection[0] ||\n                this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1] !==\n                    resCollection[resCollection.length - 1]) {\n                this.triggerScrollEvent(events.virtualScrollStart);\n                var colLevels = this.parent.activeView.colLevels.slice(0);\n                this.updateHorizontalContent(conWrap, resCollection);\n                setStyleAttribute(conWrap.querySelector('table'), { transform: \"translateX(\" + this.translateY + \"px)\" });\n                this.parent.activeView.colLevels = colLevels;\n                if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj.action === 'drag') {\n                    this.parent.dragAndDropModule.navigationWrapper();\n                }\n            }\n            window.clearTimeout(this.timeValue);\n            this.timeValue = window.setTimeout(function () { _this.renderEvents(); }, 250);\n        }\n    };\n    VirtualScroll.prototype.triggerScrollEvent = function (action) {\n        var _this = this;\n        var dynamicData = [];\n        if (!this.parent.activeView) {\n            return dynamicData;\n        }\n        var eventArgs = {\n            startDate: this.parent.activeView.startDate(),\n            endDate: this.parent.activeView.endDate(),\n            startIndex: this.parent.resourceBase.renderedResources[0].groupIndex,\n            endIndex: this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex,\n            resourceData: this.parent.resourceBase.renderedResources.map(function (x) { return x.resourceData; }),\n            name: action\n        };\n        this.parent.trigger(action, eventArgs, function (args) {\n            if (action === events.virtualScrollStart) {\n                _this.parent.showSpinner();\n            }\n            else if (action === events.virtualScrollStop && !isNullOrUndefined(args.eventData) && args.eventData.length > 0) {\n                dynamicData = args.eventData;\n            }\n        });\n        return dynamicData;\n    };\n    VirtualScroll.prototype.upScroll = function (conWrap, firstTDIndex) {\n        var index = 0;\n        index = (~~(conWrap.scrollTop / this.itemSize) + Math.ceil(conWrap.clientHeight / this.itemSize)) - this.renderedLength;\n        if (this.parent.rowAutoHeight) {\n            index = (index > firstTDIndex) ? firstTDIndex - this.bufferCount : index;\n        }\n        index = (index > 0) ? index : 0;\n        var prevSetCollection = this.getBufferCollection(index, index + this.renderedLength);\n        this.parent.resourceBase.renderedResources = prevSetCollection;\n        if (firstTDIndex === 0) {\n            this.translateY = conWrap.scrollTop;\n        }\n        else {\n            var height = (this.parent.rowAutoHeight) ? this.averageRowHeight : this.itemSize;\n            height = (height > 0) ? height : this.itemSize;\n            this.translateY = (conWrap.scrollTop - (this.bufferCount * height) > 0) ?\n                conWrap.scrollTop - (this.bufferCount * height) : 0;\n        }\n        return prevSetCollection;\n    };\n    VirtualScroll.prototype.downScroll = function (conWrap, firstTDIndex) {\n        var lastResource = this.parent.resourceBase.\n            renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex;\n        var lastResourceIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n        if (lastResource === lastResourceIndex) {\n            return null;\n        }\n        var nextSetResIndex = 0;\n        nextSetResIndex = ~~(conWrap.scrollTop / this.itemSize);\n        if (this.parent.rowAutoHeight) {\n            nextSetResIndex = ~~((conWrap.scrollTop - this.translateY) / this.averageRowHeight) + firstTDIndex;\n            nextSetResIndex = (nextSetResIndex > firstTDIndex + this.bufferCount) ? nextSetResIndex : firstTDIndex + this.bufferCount;\n        }\n        var lastIndex = nextSetResIndex + this.renderedLength;\n        lastIndex = (lastIndex > this.parent.resourceBase.expandedResources.length) ?\n            nextSetResIndex + (this.parent.resourceBase.expandedResources.length - nextSetResIndex) : lastIndex;\n        var nextSetCollection = this.getBufferCollection(lastIndex - this.renderedLength, lastIndex);\n        this.translateY = conWrap.scrollTop;\n        return nextSetCollection;\n    };\n    VirtualScroll.prototype.leftScroll = function (conWrap) {\n        var index = 0;\n        index = (~~(Math.abs(conWrap.scrollLeft) / this.itemSize) + Math.ceil(conWrap.clientWidth / this.itemSize)) - this.renderedLength;\n        index = (index > 0) ? index : 0;\n        return this.getCollection(index, index + this.renderedLength);\n    };\n    VirtualScroll.prototype.rightScroll = function (conWrap) {\n        var lastLevel = this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 1];\n        var nextSetIndex = 0;\n        nextSetIndex = ~~(Math.abs(conWrap.scrollLeft) / this.itemSize);\n        var lastIndex = nextSetIndex + this.renderedLength;\n        lastIndex = (lastIndex > lastLevel.length - 1) ? lastLevel.length - 1 : lastIndex;\n        return this.getCollection(lastIndex - this.renderedLength, lastIndex);\n    };\n    VirtualScroll.prototype.getCollection = function (startIndex, endIndex) {\n        this.translateY = startIndex * this.itemSize;\n        startIndex = (startIndex < 0) ? 0 : startIndex;\n        var lastLevel = this.getResCollection(startIndex, endIndex);\n        if (this.parent.enableRtl) {\n            this.translateY = -this.translateY;\n        }\n        return lastLevel;\n    };\n    VirtualScroll.prototype.getResCollection = function (startIndex, endIndex) {\n        var lastLevel = this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 1];\n        endIndex = endIndex > lastLevel.length ? lastLevel.length - 1 : endIndex;\n        var resCollection = [];\n        var index = { startIndex: 0, endIndex: 0 };\n        if (this.parent.activeViewOptions.group.byDate) {\n            if (lastLevel[parseInt(startIndex.toString(), 10)].date.getTime() ===\n                this.parent.resourceBase.expandedResources[0].date.getTime() &&\n                lastLevel[parseInt(endIndex.toString(), 10)].date.getTime() ===\n                    this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].date.getTime()) {\n                return this.parent.resourceBase.expandedResources;\n            }\n            resCollection =\n                this.getByDateCollection(lastLevel[parseInt(startIndex.toString(), 10)], lastLevel[parseInt(endIndex.toString(), 10)], index);\n            this.setRenderedDates(resCollection);\n        }\n        else {\n            if (lastLevel[parseInt(startIndex.toString(), 10)].groupIndex === this.parent.resourceBase.expandedResources[0].groupIndex &&\n                lastLevel[parseInt(endIndex.toString(), 10)].groupIndex ===\n                    this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex) {\n                return this.parent.resourceBase.expandedResources;\n            }\n            resCollection =\n                this.getByIdCollection(lastLevel[parseInt(startIndex.toString(), 10)], lastLevel[parseInt(endIndex.toString(), 10)], index);\n        }\n        if (this.parent.currentView !== 'Month') {\n            this.startIndex = index.startIndex;\n            resCollection = lastLevel.slice(index.startIndex, index.endIndex);\n        }\n        this.translateY = index.startIndex * this.itemSize;\n        return resCollection;\n    };\n    VirtualScroll.prototype.getByDateCollection = function (firstItem, lastItem, index) {\n        var resCollection = this.parent.activeView.colLevels[0].filter(function (data) {\n            return firstItem.date.getTime() <= data.date.getTime() &&\n                data.date.getTime() <= lastItem.date.getTime();\n        });\n        this.setStartEndIndex(this.parent.activeView.colLevels[0], resCollection[0], resCollection[resCollection.length - 1], index);\n        return resCollection;\n    };\n    VirtualScroll.prototype.getByIdCollection = function (firstItem, lastItem, index) {\n        var resCollection = this.parent.resourceBase.lastResourceLevel.filter(function (data) {\n            return firstItem.groupIndex <= data.groupIndex && data.groupIndex <= lastItem.groupIndex;\n        });\n        this.parent.resourceBase.renderedResources = resCollection;\n        this.setStartEndIndex(this.parent.resourceBase.lastResourceLevel, resCollection[0], resCollection[resCollection.length - 1], index);\n        return resCollection;\n    };\n    VirtualScroll.prototype.setStartEndIndex = function (data, firstItem, lastItem, colIndex) {\n        var index = 0;\n        data.filter(function (data) {\n            if (firstItem === data) {\n                colIndex.startIndex = index;\n            }\n            else if (lastItem === data) {\n                colIndex.endIndex = index + data.colSpan;\n            }\n            index += data.colSpan;\n        });\n        if (firstItem === lastItem) {\n            colIndex.endIndex = colIndex.startIndex + lastItem.colSpan;\n        }\n    };\n    VirtualScroll.prototype.updateContent = function (resWrap, conWrap, eventWrap, resCollection) {\n        var renderedLength = resWrap.querySelector('tbody').children.length;\n        if (document.activeElement && document.activeElement.classList.contains(cls.RESOURCE_CELLS_CLASS)) {\n            this.isResourceCell = true;\n            this.parent.element.focus();\n        }\n        for (var i = 0; i < renderedLength; i++) {\n            remove(eventWrap.querySelector('div'));\n        }\n        this.parent.resourceBase.renderedResources = resCollection;\n        var currentGroupIndices = this.parent.activeView.getGroupIndices(resCollection);\n        var previousGroupIndices = this.parent.activeView.getGroupIndices(this.existingDataCollection);\n        var newGroupIndices = currentGroupIndices.filter(function (index) { return previousGroupIndices.indexOf(index) < 0; });\n        var resWrapRows = Array.from(resWrap.querySelectorAll('tbody tr'));\n        var conWrapRows = Array.from(conWrap.querySelectorAll('tbody tr'));\n        var resWrapBody = resWrap.querySelector('tbody');\n        var conWrapBody = conWrap.querySelector('tbody');\n        this.removeObsoleteRows(resWrapRows, currentGroupIndices);\n        this.removeObsoleteRows(conWrapRows, currentGroupIndices);\n        var resourceRows = this.parent.resourceBase.getContentRows(resCollection, true);\n        var contentRows = this.parent.activeView.getContentRows();\n        var eventRows = this.parent.activeView.getEventRows(resCollection.length);\n        for (var i = 0; i < newGroupIndices.length; i++) {\n            var index = currentGroupIndices.indexOf(newGroupIndices[parseInt(i.toString(), 10)]);\n            if (index === 0) {\n                prepend([resourceRows[parseInt(i.toString(), 10)]], resWrapBody);\n                prepend([contentRows[parseInt(i.toString(), 10)]], conWrapBody);\n            }\n            else if (resWrapBody && conWrapBody && resWrapBody.children[parseInt(index.toString(), 10)] &&\n                conWrapBody.children[parseInt(index.toString(), 10)]) {\n                resWrapBody.insertBefore(resourceRows[parseInt(i.toString(), 10)], resWrapBody.children[parseInt(index.toString(), 10)]);\n                conWrapBody.insertBefore(contentRows[parseInt(i.toString(), 10)], conWrapBody.children[parseInt(index.toString(), 10)]);\n            }\n            else {\n                append([resourceRows[parseInt(i.toString(), 10)]], resWrapBody);\n                append([contentRows[parseInt(i.toString(), 10)]], conWrapBody);\n            }\n        }\n        append(eventRows, eventWrap);\n    };\n    VirtualScroll.prototype.removeObsoleteRows = function (elements, currentGroupIndices) {\n        elements.forEach(function (element) {\n            var groupIndex = parseInt(element.firstElementChild.getAttribute('data-group-index'), 10);\n            if (currentGroupIndices.indexOf(groupIndex) < 0) {\n                remove(element);\n            }\n        });\n    };\n    VirtualScroll.prototype.updateHorizontalContent = function (conWrap, resCollection) {\n        this.existingDataCollection = this.parent.resourceBase.expandedResources;\n        this.parent.resourceBase.expandedResources = resCollection;\n        var selectedEle = this.parent.getSelectedCells();\n        this.focusedEle = selectedEle[selectedEle.length - 1] || this.focusedEle;\n        var tbody = conWrap.querySelector('tbody');\n        var renderedRows = Array.from(tbody.querySelectorAll('tr'));\n        if (this.parent.currentView === 'Month') {\n            this.updateMonthViewContent(conWrap, resCollection);\n        }\n        else {\n            this.updateOtherViewContent(conWrap, resCollection, renderedRows);\n        }\n    };\n    VirtualScroll.prototype.updateMonthViewContent = function (conWrap, resCollection) {\n        var renderedLength = conWrap.querySelectorAll(' tr').length;\n        for (var i = 0; i < renderedLength; i++) {\n            remove(conWrap.querySelector('tbody tr'));\n        }\n        if (this.parent.activeViewOptions.group.byDate) {\n            this.parent.activeView.colLevels[0] = resCollection;\n        }\n        else {\n            this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 2] = resCollection;\n        }\n        var contentRows = this.parent.activeView.getContentRows();\n        append(contentRows, conWrap.querySelector('tbody'));\n    };\n    VirtualScroll.prototype.updateOtherViewContent = function (conWrap, resCollection, renderedRows) {\n        var tbody = conWrap.querySelector('tbody');\n        var colGroup = conWrap.querySelector('colgroup');\n        var thead = conWrap.querySelector('thead');\n        var table = conWrap.querySelector('table');\n        this.parent.activeView.colLevels[this.parent.activeView.colLevels.length - 1] = resCollection;\n        var newGroupIndices = new Set(resCollection.map(function (data) { return data.groupIndex; }));\n        renderedRows.forEach(function (row) {\n            var tdElements = row.querySelectorAll('td');\n            tdElements.forEach(function (td) {\n                var groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n                if (!newGroupIndices.has(groupIndex)) {\n                    td.remove();\n                }\n            });\n        });\n        var col = [].slice.call(conWrap.querySelector('colgroup').children);\n        for (var i = 0; i < col.length; i++) {\n            remove(col[parseInt(i.toString(), 10)]);\n        }\n        resCollection.forEach(function () { return colGroup.appendChild(createElement('col')); });\n        var tHead = [].slice.call(conWrap.querySelector('thead').children);\n        for (var i = 0; i < tHead.length; i++) {\n            remove(tHead[parseInt(i.toString(), 10)]);\n        }\n        thead.appendChild(this.parent.eventBase.createEventWrapper('', this.startIndex > 0 ? this.startIndex : 0));\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            thead.appendChild(this.parent.eventBase.createEventWrapper('timeIndicator'));\n        }\n        prepend([thead], table);\n        var contentRows = this.parent.activeView.getContentRows();\n        this.mergeNewTdData(tbody, contentRows);\n    };\n    VirtualScroll.prototype.mergeNewTdData = function (tbody, contentRows) {\n        var existingRows = Array.from(tbody.querySelectorAll('tr'));\n        existingRows.forEach(function (existingRow, rowIndex) {\n            if (rowIndex < contentRows.length) {\n                var newRow = contentRows[parseInt(rowIndex.toString(), 10)];\n                var existingTds_1 = Array.from(existingRow.querySelectorAll('td'));\n                var newTds = Array.from(newRow.querySelectorAll('td'));\n                newTds.forEach(function (newTd) {\n                    var newGroupIndex = parseInt(newTd.getAttribute('data-group-index').toString(), 10);\n                    var inserted = false;\n                    for (var _i = 0, existingTds_2 = existingTds_1; _i < existingTds_2.length; _i++) {\n                        var existingTd = existingTds_2[_i];\n                        var existingGroupIndex = parseInt(existingTd.getAttribute('data-group-index').toString(), 10);\n                        if (newGroupIndex < existingGroupIndex) {\n                            existingRow.insertBefore(newTd, existingTd);\n                            inserted = true;\n                            break;\n                        }\n                    }\n                    if (!inserted) {\n                        existingRow.appendChild(newTd);\n                    }\n                });\n            }\n        });\n    };\n    VirtualScroll.prototype.getBufferCollection = function (startIndex, endIndex) {\n        return this.parent.resourceBase.expandedResources.slice(startIndex, endIndex);\n    };\n    VirtualScroll.prototype.setTranslate = function (resWrap, conWrap, eventWrap, timeIndicator) {\n        setStyleAttribute(resWrap.querySelector('table'), { transform: \"translateY(\" + this.translateY + \"px)\" });\n        setStyleAttribute(conWrap.querySelector('table'), { transform: \"translateY(\" + this.translateY + \"px)\" });\n        setStyleAttribute(eventWrap, { transform: \"translateY(\" + this.translateY + \"px)\" });\n        if (!isNullOrUndefined(timeIndicator)) {\n            setStyleAttribute(timeIndicator, { transform: \"translateY(\" + this.translateY + \"px)\" });\n        }\n    };\n    VirtualScroll.prototype.updateFocusedWorkCell = function () {\n        if (this.focusedEle) {\n            var date = parseInt(this.focusedEle.getAttribute('data-date'), 10);\n            var groupIndex = parseInt(this.focusedEle.getAttribute('data-group-index'), 10);\n            var ele = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-date=\\\"\" + date + \"\\\"][data-group-index=\\\"\" + groupIndex + \"\\\"]\");\n            if (ele) {\n                this.parent.addSelectedClass([ele], ele, true);\n            }\n            this.focusedEle = null;\n        }\n    };\n    VirtualScroll.prototype.setRenderedDates = function (resCollection) {\n        if (this.parent.currentView !== 'Month') {\n            var dateCol_1 = resCollection.map(function (x) { return x.date; });\n            this.parent.resourceBase.renderedResources.forEach(function (x) { return x.renderDates = dateCol_1; });\n        }\n        else {\n            var dateCol_2 = resCollection.map(function (x) { return x.date.getDay(); });\n            var renderDates_1 = this.parent.activeView.renderDates.filter(function (x) { return dateCol_2.indexOf(x.getDay()) >= 0; });\n            this.parent.resourceBase.renderedResources.forEach(function (x) { return x.renderDates = renderDates_1; });\n        }\n    };\n    VirtualScroll.prototype.setTabIndex = function () {\n        var resColWrap = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n        var resCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.RESOURCE_CELLS_CLASS));\n        if (resCells && resColWrap) {\n            resCells.forEach(function (element) {\n                if (element.getBoundingClientRect().top >= resColWrap.getBoundingClientRect().top) {\n                    element.setAttribute('tabindex', '0');\n                }\n            });\n        }\n        var focusResCell = this.parent.element.querySelector(\".\" + cls.RESOURCE_CELLS_CLASS + \"[tabindex=\\\"\" + 0 + \"\\\"]\");\n        if (this.isResourceCell && focusResCell) {\n            focusResCell.focus();\n            this.isResourceCell = false;\n        }\n    };\n    VirtualScroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.focusedEle = null;\n    };\n    return VirtualScroll;\n}());\nexport { VirtualScroll };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}