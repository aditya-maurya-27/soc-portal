{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { KeyboardEvents, closest, EventHandler, extend, Browser } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, addClass, removeClass } from '@syncfusion/ej2-base';\nimport * as event from '../base/constant';\nimport * as util from '../base/util';\nimport * as cls from '../base/css-constant';\nimport { cellSelect } from '../base/constant';\n/**\n * Keyboard interaction\n */\nvar KeyboardInteraction = /** @class */function () {\n  function KeyboardInteraction(parent) {\n    this.selectedCells = [];\n    this.isCutContentPasted = false;\n    this.isCutAction = false;\n    this.keyConfigs = {\n      downArrow: 'downarrow',\n      upArrow: 'uparrow',\n      rightArrow: 'rightarrow',\n      leftArrow: 'leftarrow',\n      shiftDownArrow: 'shift+downarrow',\n      shiftUpArrow: 'shift+uparrow',\n      shiftRightArrow: 'shift+rightarrow',\n      shiftLeftArrow: 'shift+leftarrow',\n      ctrlLeftArrow: 'ctrl+leftarrow',\n      ctrlRightArrow: 'ctrl+rightarrow',\n      altOne: 'alt+1',\n      altTwo: 'alt+2',\n      altThree: 'alt+3',\n      altFour: 'alt+4',\n      altFive: 'alt+5',\n      altSix: 'alt+6',\n      altSeven: 'alt+7',\n      altEight: 'alt+8',\n      altNine: 'alt+9',\n      enter: 'enter',\n      escape: 'escape',\n      delete: 'delete',\n      backspace: 'backspace',\n      home: 'home',\n      pageUp: 'pageup',\n      pageDown: 'pagedown',\n      tab: 'tab',\n      shiftTab: 'shift+tab',\n      ctrlShiftUpArrow: 'ctrl+shift+uparrow',\n      ctrlShiftDownArrow: 'ctrl+shift+downarrow',\n      ctrlShiftLeftArrow: 'ctrl+shift+leftarrow',\n      ctrlShiftRightArrow: 'ctrl+shift+rightarrow',\n      shiftAltY: 'shift+alt+y',\n      shiftAltN: 'shift+alt+n',\n      cut: 'ctrl+x',\n      copy: 'ctrl+c',\n      cmdCut: 'cmd+x',\n      cmdCopy: 'cmd+c'\n    };\n    this.parent = parent;\n    this.parent.element.tabIndex = this.parent.element.tabIndex === -1 ? 0 : this.parent.element.tabIndex;\n    this.keyboardModule = new KeyboardEvents(this.parent.element, {\n      keyAction: this.keyActionHandler.bind(this),\n      keyConfigs: this.keyConfigs,\n      eventName: 'keydown'\n    });\n    this.addEventListener();\n    this.createClipboardElement();\n  }\n  KeyboardInteraction.prototype.keyActionHandler = function (e) {\n    switch (e.action) {\n      case 'downArrow':\n      case 'shiftDownArrow':\n        this.processDown(e, e.shiftKey);\n        break;\n      case 'upArrow':\n      case 'shiftUpArrow':\n        this.processUp(e, e.shiftKey);\n        break;\n      case 'leftArrow':\n      case 'shiftLeftArrow':\n        this.processLeft(e, e.shiftKey);\n        break;\n      case 'rightArrow':\n      case 'shiftRightArrow':\n        this.processRight(e, e.shiftKey);\n        break;\n      case 'ctrlLeftArrow':\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Previous'), e);\n        if (this.parent.headerModule) {\n          this.parent.headerModule.element.querySelector('.e-prev button').focus();\n        }\n        break;\n      case 'ctrlRightArrow':\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Next'), e);\n        if (this.parent.headerModule) {\n          this.parent.headerModule.element.querySelector('.e-next button').focus();\n        }\n        break;\n      case 'altOne':\n      case 'altTwo':\n      case 'altThree':\n      case 'altFour':\n      case 'altFive':\n      case 'altSix':\n      case 'altSeven':\n      case 'altEight':\n      case 'altNine':\n        this.processViewNavigation(e);\n        break;\n      case 'enter':\n        this.processEnter(e);\n        break;\n      case 'home':\n        this.focusFirstCell();\n        break;\n      case 'tab':\n      case 'shiftTab':\n        this.processTab(e, e.shiftKey);\n        break;\n      case 'delete':\n      case 'backspace':\n        this.processDelete(e);\n        break;\n      case 'ctrlShiftUpArrow':\n      case 'ctrlShiftDownArrow':\n      case 'ctrlShiftLeftArrow':\n      case 'ctrlShiftRightArrow':\n        this.processCtrlShiftNavigationArrows(e);\n        break;\n      case 'escape':\n        this.processEscape(e);\n        break;\n      case 'fTwelve':\n        if (this.parent.allowInline && this.parent.inlineModule) {\n          e.preventDefault();\n          this.processFTwelve(e);\n        }\n        break;\n      case 'shiftAltY':\n        this.parent.changeDate(new Date(), e);\n        break;\n      case 'shiftAltN':\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda' || this.parent.currentView === 'Year') {\n          return;\n        }\n        this.processShiftAltN(e);\n        break;\n      case 'cut':\n      case 'cmdCut':\n        this.processClipboardAction(true, undefined, e);\n        break;\n      case 'copy':\n      case 'cmdCopy':\n        this.processClipboardAction(false, undefined, e);\n        break;\n    }\n  };\n  KeyboardInteraction.prototype.processShiftAltN = function (e) {\n    var selectedCells = this.parent.getSelectedCells();\n    var target = e.target;\n    var cellData = extend({}, null, true);\n    if (selectedCells.length > 0 && (closest(target, '.' + cls.WORK_CELLS_CLASS) || closest(target, '.' + cls.ALLDAY_CELLS_CLASS) || closest(target, '.' + cls.HEADER_CELLS_CLASS))) {\n      cellData = this.getSelectedElements(target);\n    } else if (closest(target, '.' + cls.APPOINTMENT_CLASS) && !isNullOrUndefined(this.parent.activeEventData.event)) {\n      var event_1 = this.parent.activeEventData.event;\n      cellData.startTime = event_1.StartTime;\n      cellData.endTime = event_1.EndTime;\n      cellData.isAllDay = event_1.IsAllDay;\n    } else {\n      var workHour = this.parent.getStartEndTime(this.parent.workHours.start);\n      var slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n      cellData.startTime = new Date(this.parent.selectedDate);\n      cellData.startTime.setHours(workHour.getHours(), workHour.getMinutes(), 0, 0);\n      cellData.endTime = new Date(cellData.startTime.getTime() + slotInterval * 60000);\n    }\n    var args = extend(cellData, {\n      cancel: false,\n      event: e\n    });\n    if (args != null) {\n      this.parent.eventWindow.openEditor(args, 'Add');\n    }\n  };\n  KeyboardInteraction.prototype.processFTwelve = function (e) {\n    var target = e.target;\n    if (target.classList.contains(cls.WORK_CELLS_CLASS) || target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      this.parent.activeCellsData = this.getSelectedElements(target);\n      var args = extend(this.parent.activeCellsData, {\n        cancel: false,\n        event: e\n      });\n      var inlineArgs = {\n        element: args.element,\n        groupIndex: args.groupIndex,\n        type: 'Cell'\n      };\n      this.parent.notify(event.inlineClick, inlineArgs);\n    }\n    if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n      target.click();\n      return;\n    }\n  };\n  KeyboardInteraction.prototype.addEventListener = function () {\n    this.parent.on(event.cellMouseDown, this.onCellMouseDown, this);\n    if (this.parent.allowClipboard) {\n      this.parent.on(event.documentPaste, this.pasteHandler, this);\n    }\n  };\n  KeyboardInteraction.prototype.removeEventListener = function () {\n    this.parent.off(event.cellMouseDown, this.onCellMouseDown);\n    this.parent.off(event.documentPaste, this.pasteHandler);\n  };\n  KeyboardInteraction.prototype.onCellMouseDown = function (e) {\n    if (e.event.shiftKey) {\n      return;\n    }\n    this.initialTarget = this.getClosestCell(e.event);\n    if (this.parent.activeViewOptions.readonly || this.parent.currentView === 'MonthAgenda' || !this.initialTarget) {\n      return;\n    }\n    if (e.event.target.classList.contains(cls.WORK_CELLS_CLASS) && e.event.which !== 3) {\n      this.parent.removeSelectedClass();\n      EventHandler.add(this.parent.getContentTable(), 'mousemove', this.onMouseSelection, this);\n      EventHandler.add(this.parent.getContentTable(), 'mouseup mouseleave', this.onMoveUp, this);\n    }\n    if (e.event.target.classList.contains(cls.ALLDAY_CELLS_CLASS) && e.event.which !== 3) {\n      this.parent.removeSelectedClass();\n      var allDayRow = this.parent.getAllDayRow();\n      EventHandler.add(allDayRow, 'mousemove', this.onMouseSelection, this);\n      EventHandler.add(allDayRow, 'mouseup mouseleave', this.onMoveUp, this);\n    }\n  };\n  KeyboardInteraction.prototype.onMouseSelection = function (e) {\n    var appointments = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n    addClass(appointments, 'e-allow-select');\n    var selectionEdges = this.parent.boundaryValidation(e.pageY, e.pageX);\n    if (selectionEdges.bottom || selectionEdges.top || selectionEdges.left || selectionEdges.right) {\n      var parent_1 = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      var yInBounds = parent_1.offsetHeight <= parent_1.scrollHeight && parent_1.scrollTop >= 0 && parent_1.scrollTop + parent_1.offsetHeight <= parent_1.scrollHeight;\n      var xInBounds = parent_1.offsetWidth <= parent_1.scrollWidth && parent_1.scrollLeft >= 0 && parent_1.scrollLeft + parent_1.offsetWidth <= parent_1.scrollWidth;\n      if (yInBounds && (selectionEdges.top || selectionEdges.bottom)) {\n        parent_1.scrollTop += selectionEdges.top ? -e.target.offsetHeight : e.target.offsetHeight;\n      }\n      if (xInBounds && (selectionEdges.left || selectionEdges.right)) {\n        parent_1.scrollLeft += selectionEdges.left ? -e.target.offsetWidth : e.target.offsetWidth;\n      }\n    }\n    var target = this.getClosestCell(e);\n    if (target) {\n      this.selectCells(true, target);\n    }\n  };\n  KeyboardInteraction.prototype.getClosestCell = function (e) {\n    return closest(e.target, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS);\n  };\n  KeyboardInteraction.prototype.onMoveUp = function (e) {\n    var _this = this;\n    var appointments = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n    removeClass(appointments, 'e-allow-select');\n    EventHandler.remove(this.parent.getContentTable(), 'mousemove', this.onMouseSelection);\n    EventHandler.remove(this.parent.getContentTable(), 'mouseup mouseleave', this.onMoveUp);\n    if (e.target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      var allDayRow = this.parent.getAllDayRow();\n      EventHandler.remove(allDayRow, 'mousemove', this.onMouseSelection);\n      EventHandler.remove(allDayRow, 'mouseup mouseleave', this.onMoveUp);\n    }\n    if (this.isPreventAction(e)) {\n      return;\n    }\n    var queryStr = '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS + ',.' + cls.HEADER_CELLS_CLASS;\n    var target = closest(e.target, queryStr);\n    var selectedCells = this.parent.getSelectedCells();\n    if (selectedCells.length > 0 && selectedCells.indexOf(target) === -1) {\n      target = selectedCells[selectedCells.length - 1];\n    }\n    if (this.parent.currentView === 'TimelineYear' && target.classList.contains(cls.OTHERMONTH_CLASS)) {\n      return;\n    }\n    this.parent.activeCellsData = this.getSelectedElements(target);\n    var cellData = {};\n    if (this.parent.eventWindow) {\n      this.parent.eventWindow.convertToEventData(this.parent.activeCellsData, cellData);\n    }\n    var args = {\n      data: cellData,\n      element: this.parent.activeCellsData.element,\n      event: e,\n      requestType: cellSelect,\n      showQuickPopup: false\n    };\n    this.parent.trigger(event.select, args, function (selectArgs) {\n      var isPopupShow = selectArgs.showQuickPopup || _this.parent.quickInfoOnSelectionEnd;\n      if (isPopupShow && selectedCells.length > 1) {\n        var cellArgs = extend(_this.parent.activeCellsData, {\n          cancel: false,\n          event: e,\n          name: 'cellClick'\n        });\n        _this.parent.notify(event.cellClick, cellArgs);\n      }\n    });\n  };\n  KeyboardInteraction.prototype.processEnter = function (e) {\n    if (this.parent.activeViewOptions.readonly && !e.target.classList.contains(cls.APPOINTMENT_CLASS) || this.isPreventAction(e)) {\n      return;\n    }\n    if (this.parent.currentView === 'TimelineYear' && e.target.classList.contains(cls.OTHERMONTH_CLASS)) {\n      return;\n    }\n    var target = e.target;\n    if (closest(target, '.' + cls.POPUP_WRAPPER_CLASS)) {\n      if (target.classList.contains(cls.QUICK_POPUP_EVENT_DETAILS_CLASS) || target.classList.contains(cls.EVENT_CREATE_CLASS) || target.classList.contains(cls.EDIT_EVENT_CLASS) || target.classList.contains(cls.DELETE_EVENT_CLASS) || target.classList.contains(cls.CLOSE_CLASS)) {\n        target.click();\n        e.preventDefault();\n      } else if (target.classList.contains(cls.SUBJECT_CLASS)) {\n        this.parent.element.querySelector('.' + cls.EVENT_CREATE_CLASS).click();\n        e.preventDefault();\n      }\n      return;\n    }\n    if (target.classList.contains(cls.RESOURCE_CELLS_CLASS) && target.classList.contains(cls.RESOURCE_PARENT_CLASS)) {\n      var resourceIcon = target.querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n      if (resourceIcon) {\n        resourceIcon.click();\n      }\n      return;\n    }\n    if (target.classList.contains(cls.WORK_CELLS_CLASS) || target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      this.parent.activeCellsData = this.getSelectedElements(target);\n      var args = extend(this.parent.activeCellsData, {\n        cancel: false,\n        event: e\n      });\n      if (this.parent.allowInline) {\n        var inlineArgs = {\n          element: args.element,\n          groupIndex: args.groupIndex,\n          type: 'Cell'\n        };\n        this.parent.notify(event.inlineClick, inlineArgs);\n      } else {\n        if (this.parent.currentView === 'Year') {\n          target.click();\n        } else {\n          this.parent.notify(event.cellClick, args);\n        }\n      }\n      return;\n    }\n    if (target.classList.contains(cls.INLINE_SUBJECT_CLASS) && this.parent.inlineModule) {\n      this.parent.inlineModule.inlineCrudActions(target);\n      return;\n    }\n    if (target.classList.contains(cls.APPOINTMENT_CLASS) || target.classList.contains(cls.MORE_EVENT_CLOSE_CLASS) || target.classList.contains(cls.ALLDAY_APPOINTMENT_SECTION_CLASS) || target.classList.contains(cls.MORE_INDICATOR_CLASS)) {\n      target.click();\n      return;\n    }\n    if (target.classList.contains(cls.MORE_EVENT_HEADER_DATE_CLASS)) {\n      this.parent.setProperties({\n        selectedDate: this.parent.getDateFromElement(target)\n      }, true);\n      this.parent.changeView(this.parent.getNavigateView(), e);\n      this.processEscape(e);\n      return;\n    }\n  };\n  KeyboardInteraction.prototype.getSelectedElements = function (target) {\n    var cellDetails;\n    if (this.selectedCells.length > 1 && target.classList.contains(cls.SELECTED_CELL_CLASS)) {\n      var start = this.parent.getCellDetails(this.selectedCells[0]);\n      var end = this.parent.getCellDetails(this.selectedCells.slice(-1)[0]);\n      start.endTime = end.endTime;\n      start.element = target;\n      cellDetails = start;\n    } else {\n      cellDetails = this.parent.getCellDetails(target);\n    }\n    return cellDetails;\n  };\n  KeyboardInteraction.prototype.getCells = function (isInverseTable, start, end) {\n    var tableEle = this.parent.getContentTable();\n    var isTimelineYear = this.parent.currentView === 'TimelineYear';\n    var query = isTimelineYear && !isInverseTable ? '.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')' : 'td';\n    var cells = [].slice.call(tableEle.querySelectorAll(query));\n    var maxRow = tableEle.rows.length;\n    var maxColumn = tableEle.rows[0].cells.length;\n    if (start && start.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      var allDayRow = this.parent.getAllDayRow();\n      cells = [].slice.call(allDayRow.cells);\n      maxRow = 1;\n      maxColumn = allDayRow.cells.length;\n    }\n    var startIndex = cells.indexOf(start);\n    var endIndex = cells.indexOf(end);\n    var inverseCells = [];\n    if (isInverseTable) {\n      for (var i = 0; i < maxColumn; i++) {\n        for (var j = 0; j < maxRow; j++) {\n          var cell = cells[maxColumn * j + i];\n          if (isTimelineYear && cell.classList.contains(cls.OTHERMONTH_CLASS)) {\n            continue;\n          }\n          inverseCells.push(cell);\n        }\n      }\n      startIndex = inverseCells.indexOf(start);\n      endIndex = inverseCells.indexOf(end);\n    }\n    if (startIndex > endIndex) {\n      var temp = startIndex;\n      startIndex = endIndex;\n      endIndex = temp;\n    }\n    var sCells = isInverseTable ? inverseCells : cells;\n    return sCells.slice(startIndex, endIndex + 1);\n  };\n  KeyboardInteraction.prototype.focusFirstCell = function () {\n    if (this.parent.currentView === 'Agenda') {\n      var focusCell = this.parent.getContentTable().querySelector('.' + cls.AGENDA_CELLS_CLASS);\n      focusCell.setAttribute('tabindex', '0');\n      focusCell.focus();\n      return;\n    }\n    this.parent.eventBase.removeSelectedAppointmentClass();\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      var cell = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tr:not(.' + cls.HIDDEN_CLASS + ') .' + cls.WORK_CELLS_CLASS + ':not(.' + cls.RESOURCE_GROUP_CELLS_CLASS + ')');\n      this.selectCells(false, cell);\n    } else if (this.parent.currentView.indexOf('Year') > -1) {\n      var query = '.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')' + ':not(.' + cls.RESOURCE_GROUP_CELLS_CLASS + ')';\n      var isVerticalYear = this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.orientation === 'Vertical';\n      query += isVerticalYear ? '[data-date=\"' + this.parent.activeView.startDate().getTime() + '\"]' : '';\n      this.selectCells(false, this.parent.element.querySelector(query));\n    } else {\n      this.selectCells(false, this.parent.getWorkCellElements()[0]);\n    }\n  };\n  KeyboardInteraction.prototype.isInverseTableSelect = function () {\n    return this.parent.activeView.isInverseTableSelect;\n  };\n  /**\n   * Internal method to select cells\n   *\n   * @param {boolean} isMultiple Accepts to select multiple cells or not\n   * @param {HTMLTableCellElement} targetCell Accepts the target cells\n   * @returns {void}\n   * @private\n   */\n  KeyboardInteraction.prototype.selectCells = function (isMultiple, targetCell) {\n    var _this = this;\n    this.parent.removeSelectedClass();\n    var target = targetCell instanceof Array ? targetCell.slice(-1)[0] : targetCell;\n    if (isMultiple) {\n      var initialId_1;\n      var views_1 = ['Day', 'Week', 'WorkWeek', 'TimelineDay', 'TimelineWeek', 'TimelineWorkWeek', 'TimelineMonth', 'TimelineYear'];\n      var args = {\n        element: targetCell,\n        requestType: 'mousemove',\n        allowMultipleRow: true\n      };\n      this.parent.inlineModule.removeInlineAppointmentElement();\n      this.parent.trigger(event.select, args, function (selectArgs) {\n        var allowMultipleRow = !selectArgs.allowMultipleRow || !_this.parent.allowMultiRowSelection;\n        if (allowMultipleRow) {\n          var isTimelineYear = _this.parent.currentView === 'TimelineYear';\n          if (isTimelineYear && _this.parent.activeViewOptions.orientation === 'Horizontal' || _this.parent.currentView === 'Month') {\n            var isGroupYear = isTimelineYear && _this.parent.activeViewOptions.group.resources.length > 0;\n            target = isGroupYear ? _this.initialTarget : _this.initialTarget.parentElement.children[target.cellIndex];\n          } else if (views_1.indexOf(_this.parent.currentView) > -1) {\n            target = target.parentElement.children[_this.initialTarget.cellIndex];\n          }\n        }\n        var selectedCells = _this.getCells(_this.isInverseTableSelect(), _this.initialTarget, target);\n        if (_this.parent.activeViewOptions.group.resources.length > 0) {\n          initialId_1 = _this.initialTarget.getAttribute('data-group-index');\n          var resourceSelectedCells = [];\n          for (var _i = 0, selectedCells_1 = selectedCells; _i < selectedCells_1.length; _i++) {\n            var cell = selectedCells_1[_i];\n            if (cell.getAttribute('data-group-index') === initialId_1) {\n              resourceSelectedCells.push(cell);\n            }\n          }\n          selectedCells = resourceSelectedCells;\n        }\n        if (!_this.parent.allowMultiCellSelection) {\n          selectedCells = [_this.initialTarget];\n        }\n        _this.selectedCells = selectedCells;\n        if (selectedCells.length > 2 && !target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n          var allDayCells = _this.getAllDayCells(selectedCells);\n          if (_this.parent.activeViewOptions.group.resources.length > 0) {\n            var resourceAllDayCells = [];\n            for (var _a = 0, allDayCells_1 = allDayCells; _a < allDayCells_1.length; _a++) {\n              var cell = allDayCells_1[_a];\n              if (cell.getAttribute('data-group-index') === initialId_1) {\n                resourceAllDayCells.push(cell);\n              }\n            }\n            allDayCells = resourceAllDayCells;\n          }\n          selectedCells = selectedCells.concat(allDayCells);\n        }\n        if (target.getAttribute('data-group-index') !== initialId_1 && _this.parent.activeViewOptions.group.resources.length > 0) {\n          target = _this.selectedCells[_this.selectedCells.length - 1];\n        }\n        _this.parent.addSelectedClass(selectedCells, target);\n      });\n    } else {\n      var args = {\n        element: target,\n        requestType: cellSelect\n      };\n      // activeCellsData is not reset on schedule property changed(group properties)\n      // const cellData: Record<string, any> = {};\n      // const cellDetails: CellClickEventArgs = this.parent.getCellDetails(target);\n      // if (this.parent.eventWindow && cellDetails) {\n      //     if (this.parent.activeCellsData.element !== cellDetails.element) {\n      //         this.parent.activeCellsData = cellDetails;\n      //     }\n      //     this.parent.eventWindow.convertToEventData(this.parent.activeCellsData as unknown as Record<string, any>, cellData);\n      //     args.data = cellData;\n      // }\n      this.parent.trigger(event.select, args, function () {\n        _this.initialTarget = target;\n        _this.selectedCells = [target];\n        _this.parent.addSelectedClass([target], target);\n      });\n    }\n  };\n  KeyboardInteraction.prototype.selectAppointment = function (isReverse, target) {\n    var appointments = this.getAppointmentElements();\n    if (appointments.length < 0) {\n      return;\n    }\n    this.parent.eventBase.removeSelectedAppointmentClass();\n    var nextAppEle;\n    if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n      var targetIndex = appointments.indexOf(target);\n      nextAppEle = appointments[isReverse ? targetIndex - 1 : targetIndex + 1];\n    } else {\n      nextAppEle = isReverse ? appointments[appointments.length - 1] : appointments[0];\n    }\n    if (nextAppEle) {\n      this.parent.eventBase.addSelectedAppointments([nextAppEle], true);\n      nextAppEle.focus();\n      addClass([nextAppEle], cls.AGENDA_SELECTED_CELL);\n    }\n  };\n  KeyboardInteraction.prototype.selectAppointmentElementFromWorkCell = function (isReverse, target) {\n    var _this = this;\n    this.parent.eventBase.removeSelectedAppointmentClass();\n    this.parent.removeSelectedClass();\n    if (target.classList.contains(cls.WORK_CELLS_CLASS) || target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      var appointmentElements_1 = this.getUniqueAppointmentElements();\n      var filteredElements_1 = [];\n      var selectedDate_1 = this.parent.getDateFromElement(target).getTime();\n      var selectedSeriesEvents = this.parent.eventsProcessed.filter(function (eventObject) {\n        return !isReverse ? eventObject[_this.parent.eventFields.startTime].getTime() >= selectedDate_1 : eventObject[_this.parent.eventFields.startTime].getTime() <= selectedDate_1;\n      });\n      selectedSeriesEvents.filter(function (event) {\n        appointmentElements_1.filter(function (element) {\n          if (JSON.stringify(event.Guid) === JSON.stringify(element.getAttribute('data-guid'))) {\n            filteredElements_1.push(element);\n          }\n        });\n      });\n      if (filteredElements_1.length > 0) {\n        var selectedElement = isReverse ? filteredElements_1[filteredElements_1.length - 1] : filteredElements_1[0];\n        var focusElements = this.getAppointmentElementsByGuid(selectedElement.getAttribute('data-guid'));\n        this.parent.eventBase.addSelectedAppointments(focusElements, true);\n        focusElements[focusElements.length - 1].focus();\n      }\n    }\n  };\n  KeyboardInteraction.prototype.getAllDayCells = function (cells) {\n    var allDayRow = this.parent.getAllDayRow();\n    if (!allDayRow) {\n      return [];\n    }\n    var startCell = cells[0];\n    var endCell = cells[cells.length - 1];\n    var start = this.parent.getCellDetails(startCell);\n    var end = this.parent.getCellDetails(endCell);\n    if (end.endTime.getTime() - start.startTime.getTime() >= util.MS_PER_DAY) {\n      var allDayCells = [].slice.call(allDayRow.cells);\n      return allDayCells.slice(startCell.cellIndex, endCell.cellIndex + 1);\n    }\n    return [];\n  };\n  KeyboardInteraction.prototype.getAppointmentElements = function () {\n    return [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n  };\n  KeyboardInteraction.prototype.getAppointmentElementsByGuid = function (guid) {\n    return [].slice.call(this.parent.element.querySelectorAll('div[data-guid=\"' + guid + '\"]'));\n  };\n  KeyboardInteraction.prototype.getUniqueAppointmentElements = function () {\n    var appointments = this.getAppointmentElements();\n    var appointmentElements = [];\n    appointments.map(function (value) {\n      return value.getAttribute('data-guid');\n    }).filter(function (value, index, self) {\n      if (self.indexOf(value) === index) {\n        appointmentElements.push(appointments[parseInt(index.toString(), 10)]);\n      }\n    });\n    return appointmentElements;\n  };\n  KeyboardInteraction.prototype.getWorkCellFromAppointmentElement = function (target) {\n    var selectedObject = this.parent.eventBase.getEventByGuid(target.getAttribute('data-guid'));\n    return this.parent.eventBase.selectWorkCellByTime([selectedObject]);\n  };\n  KeyboardInteraction.prototype.processViewNavigation = function (e) {\n    if (isNullOrUndefined(e.code)) {\n      return;\n    }\n    var index = parseInt(e.code.slice(e.code.length - 1), 10) - 1;\n    if (!isNaN(index) && !isNullOrUndefined(this.parent.views) && index < this.parent.views.length) {\n      var view = this.parent.viewCollections[parseInt(index.toString(), 10)].option;\n      this.parent.changeView(view, e, undefined, index);\n      if (this.parent.headerModule) {\n        this.parent.headerModule.element.querySelector('.e-active-view button').focus();\n      }\n    }\n  };\n  KeyboardInteraction.prototype.isCalendarTarget = function (e) {\n    var keyTarget = e.currentTarget || e.target;\n    if (keyTarget && !isNullOrUndefined(keyTarget.querySelector('.e-header-popup.e-popup-open'))) {\n      return true;\n    }\n    return false;\n  };\n  KeyboardInteraction.prototype.cancelUpDownAction = function (isTimelineYear) {\n    var isVerticalYear = isTimelineYear && this.parent.activeViewOptions.orientation === 'Vertical';\n    var isGroup = this.parent.activeViewOptions.group.resources.length > 0;\n    if (isVerticalYear && isGroup || isTimelineYear && this.initialTarget.classList.contains(cls.OTHERMONTH_CLASS)) {\n      return true;\n    }\n    if (this.parent.activeView.isTimelineView() && !isTimelineYear || this.parent.currentView === 'MonthAgenda') {\n      return true;\n    }\n    return false;\n  };\n  KeyboardInteraction.prototype.processUp = function (e, isMultiple) {\n    var isTimelineYear = this.parent.currentView === 'TimelineYear';\n    if (isMultiple && this.cancelUpDownAction(isTimelineYear) || this.isCalendarTarget(e)) {\n      return;\n    }\n    var target = e.target;\n    var selectedElements = this.parent.getSelectedCells();\n    var selectedEventElements = this.parent.eventBase.getSelectedAppointments();\n    var moreEventWrapper = this.parent.element.querySelector('.' + cls.MORE_POPUP_WRAPPER_CLASS);\n    var quickPopupWrapper = this.getQuickPopupElement();\n    if (selectedElements.length > 0 && !e.target.classList.contains(cls.WORK_CELLS_CLASS)) {\n      target = selectedElements[selectedElements.length - 1];\n    }\n    if (selectedEventElements.length > 0 && !moreEventWrapper.classList.contains(cls.POPUP_OPEN) && !quickPopupWrapper.classList.contains(cls.POPUP_OPEN) && ['Day', 'Week', 'WorkWeek', 'Month'].indexOf(this.parent.currentView) !== -1) {\n      target = this.getWorkCellFromAppointmentElement(selectedEventElements[selectedEventElements.length - 1]);\n      this.parent.eventBase.removeSelectedAppointmentClass();\n    }\n    if (!target) {\n      return;\n    }\n    if (target.classList.contains(cls.WORK_CELLS_CLASS) && !this.parent.element.querySelector('.' + cls.POPUP_OPEN)) {\n      var tableRows = this.parent.getTableRows();\n      var curRowIndex = tableRows.indexOf(target.parentElement);\n      var targetCell = void 0;\n      if (isTimelineYear && isMultiple && this.parent.activeViewOptions.group.resources.length === 0) {\n        targetCell = this.isInverseTableSelect() ? this.getVerticalUpDownCell(tableRows, target, curRowIndex, true) : this.getHorizontalUpDownCell(tableRows, target, curRowIndex, true);\n      }\n      if ((curRowIndex > 0 || targetCell) && curRowIndex < tableRows.length) {\n        targetCell = targetCell ? targetCell : tableRows[curRowIndex - 1].cells[target.cellIndex];\n        if (this.parent.currentView === 'Year' && targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n          if (this.parent.activeView.getStartDate().getTime() < +targetCell.getAttribute('data-date')) {\n            targetCell = this.getYearUpDownCell(tableRows, curRowIndex - 1, target.cellIndex, true);\n          } else {\n            return;\n          }\n        }\n        e.preventDefault();\n        this.selectCells(isMultiple, targetCell);\n      }\n    } else if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      this.selectAppointment(true, target);\n    }\n  };\n  KeyboardInteraction.prototype.processDown = function (e, isMultiple) {\n    var isTimelineYear = this.parent.currentView === 'TimelineYear';\n    if (isMultiple && this.cancelUpDownAction(isTimelineYear) || this.isCalendarTarget(e)) {\n      return;\n    }\n    var target = e.target;\n    var selectedCells = this.parent.getSelectedCells();\n    var selectedElements = this.parent.eventBase.getSelectedAppointments();\n    var moreEventWrapper = this.parent.element.querySelector('.' + cls.MORE_POPUP_WRAPPER_CLASS);\n    var quickPopupWrapper = this.getQuickPopupElement();\n    if (selectedCells.length > 0 && !e.target.classList.contains(cls.WORK_CELLS_CLASS)) {\n      target = selectedCells[selectedCells.length - 1];\n    }\n    if (selectedElements.length > 0 && !moreEventWrapper.classList.contains(cls.POPUP_OPEN) && !quickPopupWrapper.classList.contains(cls.POPUP_OPEN) && ['Day', 'Week', 'WorkWeek', 'Month'].indexOf(this.parent.currentView) !== -1) {\n      target = this.getWorkCellFromAppointmentElement(selectedElements[selectedElements.length - 1]);\n      this.parent.eventBase.removeSelectedAppointmentClass();\n    }\n    var tableRows = this.parent.getTableRows();\n    if (!target) {\n      return;\n    }\n    if (target.classList.contains(cls.WORK_CELLS_CLASS) && !this.parent.element.querySelector('.' + cls.POPUP_OPEN)) {\n      var curRowIndex = tableRows.indexOf(target.parentElement);\n      var targetCell = void 0;\n      if (isTimelineYear && isMultiple && this.parent.activeViewOptions.group.resources.length === 0) {\n        targetCell = this.isInverseTableSelect() ? this.getVerticalUpDownCell(tableRows, target, curRowIndex, false) : this.getHorizontalUpDownCell(tableRows, target, curRowIndex, false);\n      }\n      if (curRowIndex >= 0 && (curRowIndex < tableRows.length - 1 || targetCell)) {\n        targetCell = targetCell ? targetCell : tableRows[curRowIndex + 1].cells[target.cellIndex];\n        if (this.parent.currentView === 'Year' && targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n          if (this.parent.activeView.getEndDate().getTime() > +targetCell.getAttribute('data-date')) {\n            targetCell = this.getYearUpDownCell(tableRows, curRowIndex + 1, target.cellIndex, false);\n          } else {\n            return;\n          }\n        }\n        e.preventDefault();\n        this.selectCells(isMultiple, targetCell);\n      }\n    } else if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      this.selectAppointment(false, target);\n    }\n  };\n  KeyboardInteraction.prototype.getYearUpDownCell = function (tableRows, rowIndex, cellIndex, isUp) {\n    while (tableRows[parseInt(rowIndex.toString(), 10)] && tableRows[parseInt(rowIndex.toString(), 10)].cells[parseInt(cellIndex.toString(), 10)].classList.contains(cls.OTHERMONTH_CLASS)) {\n      rowIndex = rowIndex + (isUp ? -1 : 1);\n    }\n    return tableRows[parseInt(rowIndex.toString(), 10)].cells[parseInt(cellIndex.toString(), 10)];\n  };\n  // eslint-disable-next-line max-len\n  KeyboardInteraction.prototype.getHorizontalUpDownCell = function (tableRows, target, curRowIndex, isUp) {\n    var row = tableRows[curRowIndex + (isUp ? -1 : 1)];\n    var cell = row ? row.cells[target.cellIndex] : target;\n    if (cell.classList.contains(cls.OTHERMONTH_CLASS)) {\n      var workCell = row.querySelector('.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')');\n      var date = new Date(+workCell.getAttribute('data-date'));\n      var query = '[data-date=\"' + new Date(date.getFullYear(), date.getMonth() + 1, 0).getTime() + '\"]';\n      cell = cell.cellIndex < workCell.cellIndex ? workCell : row.querySelector(query);\n    }\n    return cell;\n  };\n  // eslint-disable-next-line max-len\n  KeyboardInteraction.prototype.getVerticalUpDownCell = function (tableRows, target, curRowIndex, isUp) {\n    var hasRow = isUp && curRowIndex > 0 || !isUp && curRowIndex < tableRows.length - 1;\n    var targetCell = hasRow ? tableRows[curRowIndex + (isUp ? -1 : 1)].cells[target.cellIndex] : undefined;\n    if (!targetCell || targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n      var column = tableRows[parseInt(curRowIndex.toString(), 10)].cells[target.cellIndex - (isUp ? 1 : -1)];\n      if (column) {\n        var dateAttr = +target.getAttribute('data-date') - (isUp ? util.MS_PER_DAY : -util.MS_PER_DAY);\n        return this.parent.getContentTable().querySelector('.' + cls.WORK_CELLS_CLASS + '[data-date=\"' + dateAttr + '\"]');\n      }\n      targetCell = target;\n    }\n    return targetCell;\n  };\n  KeyboardInteraction.prototype.processLeftRight = function (target) {\n    var tableEle = this.parent.currentView === 'Year' ? target.closest('tbody') : this.parent.getContentTable();\n    var curRowIndex = target.parentNode.sectionRowIndex;\n    var key = {\n      element: tableEle,\n      rowIndex: curRowIndex,\n      columnIndex: target.cellIndex,\n      maxIndex: tableEle.rows[parseInt(curRowIndex.toString(), 10)].cells.length\n    };\n    return key;\n  };\n  KeyboardInteraction.prototype.getQuickPopupElement = function () {\n    return (this.parent.isAdaptive ? document.body : this.parent.element).querySelector('.' + cls.POPUP_WRAPPER_CLASS);\n  };\n  KeyboardInteraction.prototype.isCancelLeftRightAction = function (e, isMultiple, isTimelineYear) {\n    var prevent = this.parent.currentView === 'MonthAgenda' || isTimelineYear && this.initialTarget.classList.contains(cls.OTHERMONTH_CLASS);\n    if (this.parent.currentView === 'Agenda' || isMultiple && prevent) {\n      return true;\n    }\n    if (this.isPreventAction(e) && isMultiple) {\n      return true;\n    }\n    var moreEventWrapper = this.parent.element.querySelector('.' + cls.MORE_POPUP_WRAPPER_CLASS);\n    var quickPopupWrapper = this.getQuickPopupElement();\n    if (moreEventWrapper.classList.contains(cls.POPUP_OPEN) || quickPopupWrapper.classList.contains(cls.POPUP_OPEN)) {\n      return true;\n    }\n    return false;\n  };\n  KeyboardInteraction.prototype.processRight = function (e, isMultiple) {\n    var isTimelineYear = this.parent.currentView === 'TimelineYear';\n    if (this.isCancelLeftRightAction(e, isMultiple, isTimelineYear) || this.isCalendarTarget(e)) {\n      return;\n    }\n    var selectedCells = this.parent.getSelectedCells();\n    var targetCell;\n    var selectedAppointments = this.parent.eventBase.getSelectedAppointments();\n    var target = e.target;\n    if (selectedCells.length > 0 && !target.classList.contains(cls.WORK_CELLS_CLASS) && !target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      target = selectedCells[selectedCells.length - 1];\n    }\n    if (selectedAppointments.length > 0) {\n      target = this.getWorkCellFromAppointmentElement(selectedAppointments[selectedAppointments.length - 1]);\n      this.parent.eventBase.removeSelectedAppointmentClass();\n      if (!target) {\n        return;\n      }\n    }\n    if (target.classList.contains(cls.WORK_CELLS_CLASS) && e.target.classList.contains(cls.WORK_CELLS_CLASS)) {\n      var key = this.processLeftRight(target);\n      var targetDate = new Date(+target.getAttribute('data-date'));\n      var isMonthEnd = this.parent.currentView === 'Year' && targetDate.getTime() === util.lastDateOfMonth(targetDate).getTime();\n      if (key.columnIndex >= 0 && key.columnIndex < key.maxIndex - 1 && !isMonthEnd) {\n        targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex].cells[target.cellIndex + 1], 'right');\n        if (isTimelineYear && isMultiple && targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n          targetCell = this.getTimelineYearTargetCell(key, target, true);\n        }\n        if (!isNullOrUndefined(targetCell)) {\n          this.selectCells(isMultiple, targetCell);\n        }\n      } else if (key.columnIndex === key.maxIndex - 1 || isMonthEnd) {\n        if (!this.isInverseTableSelect() && key.rowIndex < key.element.rows.length - 1 && !isMonthEnd) {\n          targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex + 1].cells[0], 'right');\n          var changeTargetCell = isTimelineYear && isMultiple && targetCell.classList.contains(cls.OTHERMONTH_CLASS);\n          targetCell = changeTargetCell ? this.getHorizontalLeftRightCell(key, target, true) : targetCell;\n          if (!isNullOrUndefined(targetCell)) {\n            this.selectCells(isMultiple, targetCell);\n          }\n        } else if (!isMultiple) {\n          if (isMonthEnd && targetDate.getTime() !== this.parent.activeView.getEndDate().getTime()) {\n            this.selectCells(isMultiple, this.parent.element.querySelector(':not(.' + cls.OTHERMONTH_CLASS + ')[data-date=\"' + (targetDate.getTime() + util.MS_PER_DAY) + '\"]'));\n            return;\n          }\n          var rowIndex = this.isInverseTableSelect() ? key.rowIndex : 0;\n          this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Next'), e);\n          var tableEle = this.parent.getContentTable();\n          var cell = isMonthEnd ? tableEle.rows[parseInt(rowIndex.toString(), 10)].querySelector('.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')') : tableEle.rows[parseInt(rowIndex.toString(), 10)].cells[0];\n          this.selectCells(false, cell);\n        }\n      }\n    } else if (target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      var curColIndex = target.cellIndex;\n      var allDayRow = this.parent.getAllDayRow();\n      var maxColIndex = allDayRow.cells.length;\n      if (curColIndex >= 0 && curColIndex < maxColIndex - 1) {\n        this.selectCells(isMultiple, allDayRow.cells[curColIndex + 1]);\n      } else if (curColIndex === maxColIndex - 1 && !isMultiple) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Next'), e);\n        var allDayRow_1 = this.parent.getAllDayRow();\n        this.selectCells(false, allDayRow_1.cells[0]);\n      }\n    }\n  };\n  KeyboardInteraction.prototype.processLeft = function (e, isMultiple) {\n    var isTimelineYear = this.parent.currentView === 'TimelineYear';\n    if (this.isCancelLeftRightAction(e, isMultiple, isTimelineYear) || this.isCalendarTarget(e)) {\n      return;\n    }\n    var target = e.target;\n    var selectedCells = this.parent.getSelectedCells();\n    var targetCell;\n    if (selectedCells.length > 0 && !target.classList.contains(cls.WORK_CELLS_CLASS) && !target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      target = selectedCells[selectedCells.length - 1];\n    }\n    var selectedElements = this.parent.eventBase.getSelectedAppointments();\n    if (selectedElements.length > 0) {\n      target = this.getWorkCellFromAppointmentElement(selectedElements[selectedElements.length - 1]);\n      this.parent.eventBase.removeSelectedAppointmentClass();\n      if (!target) {\n        return;\n      }\n    }\n    if (e.target.classList.contains(cls.WORK_CELLS_CLASS) && target.classList.contains(cls.WORK_CELLS_CLASS)) {\n      var key = this.processLeftRight(target);\n      var targetDate = new Date(+target.getAttribute('data-date'));\n      var isMonthStart = this.parent.currentView === 'Year' && targetDate.getTime() === util.firstDateOfMonth(targetDate).getTime();\n      if (key.columnIndex > 0 && key.columnIndex < key.maxIndex && !isMonthStart) {\n        targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex].cells[target.cellIndex - 1], 'left');\n        if (isTimelineYear && isMultiple && targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n          targetCell = this.getTimelineYearTargetCell(key, target, false);\n        }\n        if (!isNullOrUndefined(targetCell)) {\n          this.selectCells(isMultiple, targetCell);\n        }\n      } else if (key.columnIndex === 0 || isMonthStart) {\n        if (!this.isInverseTableSelect() && key.rowIndex > 0) {\n          targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex - 1].cells[key.maxIndex - 1], 'left');\n          var otherMonthCell = isTimelineYear && isMultiple && targetCell.classList.contains(cls.OTHERMONTH_CLASS);\n          targetCell = otherMonthCell ? this.getHorizontalLeftRightCell(key, target, false) : targetCell;\n          if (!isNullOrUndefined(targetCell)) {\n            this.selectCells(isMultiple, targetCell);\n          }\n        } else if (!isMultiple) {\n          if (isMonthStart && targetDate.getTime() !== this.parent.activeView.getStartDate().getTime()) {\n            this.selectCells(isMultiple, this.parent.element.querySelector('[data-date=\"' + (targetDate.getTime() - util.MS_PER_DAY) + '\"]'));\n            return;\n          }\n          this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Previous'), e);\n          var tableEle = this.parent.getContentTable();\n          var rowIndex = this.isInverseTableSelect() ? key.rowIndex : tableEle.rows.length - 1;\n          var cell = tableEle.rows[parseInt(rowIndex.toString(), 10)].cells[key.maxIndex - 1];\n          if (isMonthStart) {\n            var tbody = this.parent.element.querySelectorAll('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n            cell = tbody.item(tbody.length - 1).querySelector(':not(.' + cls.OTHERMONTH_CLASS + ')[data-date=\"' + this.parent.activeView.getEndDate().getTime() + '\"]');\n          }\n          this.selectCells(false, cell);\n        }\n      }\n    } else if (target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      var curColIndex = target.cellIndex;\n      var allDayRow = this.parent.getAllDayRow();\n      var maxColIndex = allDayRow.cells.length;\n      if (curColIndex > 0 && curColIndex < maxColIndex) {\n        this.selectCells(isMultiple, allDayRow.cells[curColIndex - 1]);\n      } else if (curColIndex === 0 && !isMultiple) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Previous'), e);\n        var allDayRow_2 = this.parent.getAllDayRow();\n        this.selectCells(false, allDayRow_2.cells[maxColIndex - 1]);\n      }\n    }\n  };\n  KeyboardInteraction.prototype.getTimelineYearTargetCell = function (key, target, isRight) {\n    return this.isInverseTableSelect() ? this.getVerticalLeftRightCell(target, isRight) : this.getHorizontalLeftRightCell(key, target, isRight);\n  };\n  KeyboardInteraction.prototype.getHorizontalLeftRightCell = function (key, target, isRight) {\n    var row = key.element.rows[target.parentNode.sectionRowIndex + (isRight ? 1 : -1)];\n    if (row) {\n      var query = isRight ? '.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')' : '[data-date=\"' + (+target.getAttribute('data-date') - util.MS_PER_DAY) + '\"]';\n      return row.querySelector(query);\n    }\n    return target;\n  };\n  KeyboardInteraction.prototype.getVerticalLeftRightCell = function (target, isRight) {\n    var date = new Date(+target.getAttribute('data-date'));\n    var start = new Date(date.getFullYear(), date.getMonth() + (isRight ? 1 : -1), 1);\n    var tableEle = this.parent.getContentTable();\n    var targetCell = tableEle.querySelector('[data-date=\"' + start.getTime() + '\"]');\n    if (targetCell.parentNode.sectionRowIndex > target.parentNode.sectionRowIndex) {\n      return targetCell;\n    }\n    return tableEle.querySelector('[data-date=\"' + new Date(start.getFullYear(), start.getMonth() + 1, 0).getTime() + '\"]');\n  };\n  KeyboardInteraction.prototype.calculateNextPrevDate = function (currentCell, target, type) {\n    var initialId = this.initialTarget.getAttribute('data-group-index');\n    if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.currentView === 'Month') {\n      if (currentCell && target && target.getAttribute('data-group-index') !== initialId) {\n        var currentDate = this.parent.getDateFromElement(currentCell);\n        var nextPrevDate = type === 'right' ? new Date(currentDate.setDate(currentDate.getDate() + 1)) : new Date(currentDate.setDate(currentDate.getDate() - 1));\n        target = [].slice.call(this.parent.element.querySelectorAll('td[data-date=\"' + nextPrevDate.getTime().toString() + '\"]' + '[data-group-index=\"' + initialId + '\"]'))[0];\n      }\n    }\n    return target;\n  };\n  KeyboardInteraction.prototype.getFocusableElements = function (container) {\n    var queryString = 'a[href]:not([tabindex=\"-1\"]),input:not([disabled]):not([tabindex=\"-1\"]),' + 'textarea:not([disabled]):not([tabindex=\"-1\"]),button:not([disabled]):not([tabindex=\"-1\"]),' + 'select:not([disabled]):not([tabindex=\"-1\"]),[tabindex]:not([tabindex=\"-1\"]),[contentEditable=true]:not([tabindex=\"-1\"])';\n    return [].slice.call(container.querySelectorAll(queryString));\n  };\n  KeyboardInteraction.prototype.processTabOnPopup = function (e, popupElement) {\n    var _this = this;\n    var focusableElements = this.getFocusableElements(popupElement);\n    focusableElements = focusableElements.filter(function (element) {\n      var footerEle = _this.parent.element.querySelector('.' + cls.POPUP_FOOTER_CLASS);\n      if (footerEle && footerEle.offsetParent) {\n        return !(element.classList.contains(cls.EDIT_CLASS) || element.classList.contains(cls.DELETE_CLASS));\n      } else {\n        return !(element.classList.contains(cls.EDIT_EVENT_CLASS) || element.classList.contains(cls.DELETE_EVENT_CLASS));\n      }\n    });\n    var firstEle = focusableElements[0];\n    var lastEle = focusableElements[focusableElements.length - 1];\n    if (!isNullOrUndefined(lastEle) && document.activeElement === lastEle && !e.shiftKey) {\n      e.preventDefault();\n      firstEle.focus();\n    }\n    if (!isNullOrUndefined(firstEle) && document.activeElement === firstEle && e.shiftKey) {\n      e.preventDefault();\n      lastEle.focus();\n    }\n  };\n  KeyboardInteraction.prototype.processTab = function (e, isReverse) {\n    var target = e.target;\n    if (target.classList.contains(cls.INLINE_SUBJECT_CLASS) && this.parent.inlineModule) {\n      target = target.closest('.e-appointment');\n      this.parent.inlineModule.inlineCrudActions(e.target);\n    }\n    if (this.parent.currentView === 'TimelineYear' && target.classList.contains(cls.OTHERMONTH_CLASS)) {\n      if (target.classList.contains(cls.SELECTED_CELL_CLASS)) {\n        this.parent.removeSelectedClass();\n      }\n      return;\n    }\n    var popupWrapper = closest(target, '.' + cls.POPUP_WRAPPER_CLASS + ',.' + cls.MORE_POPUP_WRAPPER_CLASS);\n    if (popupWrapper && popupWrapper.classList.contains(cls.POPUP_OPEN)) {\n      if (popupWrapper.classList.contains(cls.MORE_POPUP_WRAPPER_CLASS)) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n      }\n      this.processTabOnPopup(e, popupWrapper);\n      return;\n    }\n    if (target.classList.contains(cls.ROOT)) {\n      this.parent.eventBase.removeSelectedAppointmentClass();\n      return;\n    }\n    if (target.classList.contains(cls.RESOURCE_CELLS_CLASS) && this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0) {\n      var index = parseInt(target.getAttribute('data-group-index'), 10);\n      var appSelector = \".\" + cls.APPOINTMENT_CLASS + \"[data-group-index=\\\"\" + (isReverse ? index - 1 : index) + \"\\\"]\";\n      var appElements = [].slice.call(this.parent.element.querySelectorAll(appSelector));\n      if (appElements.length > 0) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        var focusAppointment = isReverse ? appElements.slice(-1)[0] : appElements[0];\n        this.parent.eventBase.addSelectedAppointments([focusAppointment], true);\n        focusAppointment.focus();\n        e.preventDefault();\n      } else if (index + 1 === this.parent.resourceBase.lastResourceLevel.length) {\n        this.parent.element.focus();\n        e.preventDefault();\n      } else if (this.parent.virtualScrollModule) {\n        var virtual = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n        var averageRowHeight = Math.round(virtual.offsetHeight / this.parent.resourceBase.expandedResources.length);\n        this.parent.element.querySelector('.e-content-wrap').scrollTop = (isReverse ? index - 1 : index + 1) * averageRowHeight;\n        this.parent.virtualScrollModule.virtualScrolling();\n      } else {\n        this.setScrollPosition(index);\n      }\n      return;\n    }\n    if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n      var appElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n      var isTimelineYear = this.parent.currentView === 'TimelineYear';\n      var isTimeline = this.parent.activeView.isTimelineView() && !isTimelineYear;\n      if ((isTimeline || isTimelineYear && this.parent.activeViewOptions.orientation === 'Vertical') && this.parent.activeViewOptions.group.resources.length > 0) {\n        var index = parseInt(target.getAttribute('data-group-index'), 10);\n        appElements = [].slice.call(this.parent.element.querySelectorAll(\".\" + cls.APPOINTMENT_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\"));\n        var resCellSelector = \".\" + cls.RESOURCE_CELLS_CLASS + \"[data-group-index=\\\"\" + (isReverse ? index : index + 1) + \"\\\"]\";\n        var resourceCell = this.parent.element.querySelector(resCellSelector);\n        if (resourceCell && (isReverse && target.getAttribute('data-guid') === appElements[0].getAttribute('data-guid') || !isReverse && target.getAttribute('data-guid') === appElements.slice(-1)[0].getAttribute('data-guid'))) {\n          this.parent.eventBase.removeSelectedAppointmentClass();\n          if (this.parent.virtualScrollModule) {\n            resourceCell.focus({\n              preventScroll: true\n            });\n          } else {\n            resourceCell.focus();\n          }\n          if (this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0 && isNullOrUndefined(this.parent.virtualScrollModule)) {\n            this.setScrollPosition(index);\n          }\n          e.preventDefault();\n          return;\n        }\n      }\n      var selectedAppointments = this.parent.eventBase.getSelectedAppointments();\n      if (selectedAppointments.length > 0) {\n        target = selectedAppointments[selectedAppointments.length - 1];\n      }\n      this.parent.eventBase.removeSelectedAppointmentClass();\n      if (!isReverse && target.getAttribute('data-guid') === appElements[appElements.length - 1].getAttribute('data-guid') || isReverse && target.getAttribute('data-guid') === appElements[0].getAttribute('data-guid')) {\n        return;\n      }\n      if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n        this.selectAppointment(isReverse, target);\n        e.preventDefault();\n      }\n      return;\n    }\n    var selectedCells = this.parent.getSelectedCells();\n    if (selectedCells.length > 0 && !target.classList.contains(cls.APPOINTMENT_CLASS)) {\n      target = selectedCells[selectedCells.length - 1];\n      this.selectAppointmentElementFromWorkCell(isReverse, target);\n      e.preventDefault();\n      return;\n    }\n    if (target && !target.classList.contains(cls.RESOURCE_CELLS_CLASS) && this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0) {\n      this.processTabOnResourceCells(target, isReverse);\n    }\n  };\n  KeyboardInteraction.prototype.processDelete = function (e) {\n    var activeEle = document.activeElement;\n    if (this.parent.currentView === 'MonthAgenda') {\n      var selectedEle = this.parent.eventBase.getSelectedEvents().element;\n      activeEle = selectedEle && isNullOrUndefined(selectedEle.length) ? selectedEle : selectedEle[0];\n    }\n    if (activeEle && activeEle.classList.contains(cls.APPOINTMENT_CLASS)) {\n      addClass([activeEle], cls.APPOINTMENT_BORDER);\n      this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n      if (this.parent.activeViewOptions.readonly || activeEle.classList.contains(cls.READ_ONLY) || !this.parent.eventSettings.allowDeleting) {\n        return;\n      }\n      this.parent.quickPopup.deleteClick(e);\n    }\n  };\n  KeyboardInteraction.prototype.processCtrlShiftNavigationArrows = function (e) {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && document.activeElement.classList.contains(cls.APPOINTMENT_CLASS)) {\n      var groupIndex = parseInt(document.activeElement.getAttribute('data-group-index'), 10);\n      var index = e.action === 'ctrlShiftLeftArrow' || e.action === 'ctrlShiftUpArrow' ? groupIndex - 1 : groupIndex + 1;\n      index = index < 0 ? 0 : index > this.parent.resourceBase.lastResourceLevel.length ? this.parent.resourceBase.lastResourceLevel.length : index;\n      var eventEle = [];\n      while (eventEle.length === 0 && index >= 0 && index <= this.parent.resourceBase.lastResourceLevel.length) {\n        eventEle = [].slice.call(this.parent.element.querySelectorAll(\".\" + cls.APPOINTMENT_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\"));\n        index = e.action === 'ctrlShiftLeftArrow' || e.action === 'ctrlShiftUpArrow' ? index - 1 : index + 1;\n      }\n      var nextAppEle = eventEle[0];\n      if (nextAppEle) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        this.parent.eventBase.addSelectedAppointments([nextAppEle], true);\n        nextAppEle.focus();\n      }\n    } else if (this.parent.activeViewOptions.group.resources.length > 0 && !document.activeElement.classList.contains(cls.APPOINTMENT_CLASS)) {\n      var index = this.parent.resourceBase.renderedResources[0].groupIndex;\n      var appSelector = \".\" + cls.APPOINTMENT_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\";\n      var appElements = [].slice.call(this.parent.element.querySelectorAll(appSelector));\n      if (appElements.length > 0) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        var focusAppointment = appElements[0];\n        this.parent.eventBase.addSelectedAppointments([focusAppointment], true);\n        focusAppointment.focus();\n        e.preventDefault();\n      }\n    }\n  };\n  KeyboardInteraction.prototype.processEscape = function (event) {\n    this.parent.quickPopup.onClosePopup(event);\n    this.parent.quickPopup.morePopup.hide();\n    if (this.parent.headerModule) {\n      this.parent.headerModule.hideHeaderPopup();\n    }\n    if (this.parent.inlineModule) {\n      this.parent.inlineModule.removeInlineAppointmentElement();\n    }\n  };\n  KeyboardInteraction.prototype.isPreventAction = function (e) {\n    var target = closest(e.target, '.' + cls.RESOURCE_GROUP_CELLS_CLASS);\n    if (this.parent.activeView.isTimelineView() && !isNullOrUndefined(target)) {\n      return true;\n    }\n    return false;\n  };\n  KeyboardInteraction.prototype.processTabOnResourceCells = function (target, isReverse) {\n    var tabElements = [].slice.call(this.parent.element.querySelectorAll('[tabIndex=\"0\"]'));\n    var currentTabIndex = tabElements.indexOf(target);\n    var nextTabElement = !isReverse ? tabElements[currentTabIndex + 1] : tabElements[currentTabIndex - 1];\n    if (nextTabElement && nextTabElement.classList.contains(cls.RESOURCE_CELLS_CLASS)) {\n      var groupIndex = parseInt(nextTabElement.getAttribute('data-group-index'), 10);\n      if (this.parent.virtualScrollModule) {\n        var resColWrap_1 = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n        var resCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.RESOURCE_CELLS_CLASS));\n        resCells.forEach(function (element) {\n          if (element.getBoundingClientRect().top < resColWrap_1.getBoundingClientRect().top) {\n            element.setAttribute('tabindex', '-1');\n          }\n        });\n      } else {\n        this.setScrollPosition(groupIndex);\n      }\n    }\n  };\n  KeyboardInteraction.prototype.setScrollPosition = function (index) {\n    var workCell = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\");\n    if (workCell) {\n      this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS).scrollTop = workCell.offsetTop;\n    }\n  };\n  KeyboardInteraction.prototype.createClipboardElement = function () {\n    if (!this.parent.allowClipboard) {\n      return;\n    }\n    this.clipBoardTextArea = this.parent.createElement('textarea', {\n      className: cls.CLIPBOARD_CLASS,\n      attrs: {\n        tabindex: '-1'\n      }\n    });\n    this.parent.element.appendChild(this.clipBoardTextArea);\n  };\n  KeyboardInteraction.prototype.setCopy = function (copiedEventData, e) {\n    var _this = this;\n    if (window.getSelection().toString() !== '') {\n      return;\n    }\n    this.clipBoardTextArea.value = '';\n    var eventDetails = {\n      elements: [],\n      eventDatas: []\n    };\n    if (copiedEventData) {\n      var filteredContent = this.filterReadOnlyEvent(copiedEventData);\n      eventDetails.eventDatas = filteredContent;\n    } else {\n      if (!this.parent || !this.parent.eventBase) {\n        return;\n      }\n      var selectedEvents = this.parent.eventBase.getSelectedEvents();\n      selectedEvents.event = selectedEvents && selectedEvents.event ? Array.isArray(selectedEvents.event) ? this.filterReadOnlyEvent(selectedEvents.event) : this.filterReadOnlyEvent([selectedEvents.event]) : undefined;\n      if (selectedEvents.element && selectedEvents.event) {\n        eventDetails = {\n          elements: selectedEvents.element,\n          eventDatas: selectedEvents.event\n        };\n      } else {\n        eventDetails.element = [e.target];\n        eventDetails.eventDatas = [this.parent.getEventDetails(e.target)];\n      }\n    }\n    this.clipBoardTextArea.value = JSON.stringify(eventDetails.eventDatas, undefined, 2);\n    if (!/ipad|ipod|iphone/i.test(Browser.userAgent)) {\n      this.clipBoardTextArea.select();\n    } else {\n      this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n    }\n    if (!isNullOrUndefined(navigator.clipboard)) {\n      navigator.clipboard.writeText(this.clipBoardTextArea.value).then(function () {\n        _this.clipBoardTextArea.blur();\n        window.getSelection().removeAllRanges();\n        if (e) {\n          var closestAppointment = e.target.closest('.' + cls.APPOINTMENT_CLASS);\n          if (closestAppointment) {\n            closestAppointment.focus();\n          }\n        }\n      }).catch(function (err) {\n        throw err;\n      });\n    }\n  };\n  KeyboardInteraction.prototype.filterReadOnlyEvent = function (args) {\n    var _this = this;\n    return args.filter(function (event) {\n      return !event[_this.parent.eventFields.isReadonly];\n    });\n  };\n  KeyboardInteraction.prototype.processClipboardAction = function (isCut, copiedEventData, e) {\n    if (!this.parent.allowClipboard) {\n      return;\n    }\n    this.isCutAction = isCut;\n    this.isCutContentPasted = false;\n    this.parent.closeQuickInfoPopup();\n    this.setCopy(copiedEventData ? copiedEventData : undefined, e);\n  };\n  KeyboardInteraction.prototype.pasteHandler = function (clipboardEvent, targetElement) {\n    var _this = this;\n    if (!this.parent.allowClipboard || this.isCutContentPasted) {\n      return;\n    }\n    var target = this.parent.getSelectedCells().length > 0 ? this.parent.getSelectedCells() : targetElement ? [targetElement] : [];\n    if (target.length === 0 || this.parent.eventWindow.dialogObject.visible || this.parent.quickPopup.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n      return;\n    }\n    var clipboardData = clipboardEvent.clipboardData || clipboardEvent.event.clipboardData || window.clipboardData;\n    var pastedData = clipboardData.getData('text');\n    if (pastedData === '[]' || pastedData === '') {\n      return;\n    }\n    var parsedData;\n    try {\n      parsedData = JSON.parse(pastedData);\n    } catch (_a) {\n      parsedData = pastedData;\n    }\n    var args = {\n      cancel: false,\n      data: parsedData,\n      element: target\n    };\n    this.parent.trigger(event.beforePaste, args, function (pasteEventArgs) {\n      if (!pasteEventArgs.cancel) {\n        if (!Array.isArray(pasteEventArgs.data) || !pasteEventArgs.data.every(function (item) {\n          return typeof item === 'object';\n        })) {\n          _this.clipBoardTextArea.value = '';\n          return;\n        }\n        _this.processPaste(pasteEventArgs.data, targetElement);\n        if (_this.isCutAction) {\n          _this.isCutContentPasted = true;\n        }\n      } else {\n        _this.parent.closeQuickInfoPopup();\n        return;\n      }\n    });\n  };\n  KeyboardInteraction.prototype.processPaste = function (data, targetElement) {\n    if (!this.parent || !this.parent.eventWindow || !this.parent.eventBase || !data || !data.length) {\n      return;\n    }\n    var target = this.getTargetElements(targetElement);\n    var cellDetails = this.parent.getCellDetails(target);\n    var eventDetails = {};\n    this.parent.eventWindow.convertToEventData(cellDetails, eventDetails);\n    var isAllDay = this.isAllDayEvent(target);\n    var resources = this.parent.getResourcesByIndex(cellDetails.groupIndex);\n    var processedData = this.processEventData(data, isAllDay, cellDetails, resources);\n    var selectedEventData = this.parent.eventBase.sortByDateTime(processedData);\n    var saveData = this.prepareEventData(selectedEventData, eventDetails);\n    removeClass(target, cls.SELECTED_CELL_CLASS);\n    if (saveData.length > 0) {\n      if (this.isCutAction) {\n        this.parent.saveEvent(saveData);\n      } else {\n        this.parent.addEvent(saveData);\n      }\n    }\n  };\n  KeyboardInteraction.prototype.getTargetElements = function (targetElement) {\n    return this.parent.getSelectedCells().length > 0 ? this.parent.getSelectedCells() : targetElement ? [targetElement] : [];\n  };\n  KeyboardInteraction.prototype.isAllDayEvent = function (target) {\n    return !target.some(function (cell) {\n      return cell.classList.contains(cls.WORK_CELLS_CLASS);\n    });\n  };\n  KeyboardInteraction.prototype.processEventData = function (data, isAllDay, cellDetails, resources) {\n    var _this = this;\n    return data.map(function (item) {\n      var _a;\n      var processedItem = __assign({}, item, (_a = {}, _a[_this.parent.eventFields.startTime] = new Date(item[_this.parent.eventFields.startTime]), _a[_this.parent.eventFields.endTime] = new Date(item[_this.parent.eventFields.endTime]), _a[_this.parent.eventFields.recurrenceID] = null, _a[_this.parent.eventFields.isAllDay] = isAllDay, _a));\n      _this.adjustEventTime(processedItem, isAllDay, item.IsAllDay, cellDetails);\n      if (resources && resources.groupData) {\n        Object.assign(processedItem, resources.groupData);\n      }\n      return processedItem;\n    });\n  };\n  KeyboardInteraction.prototype.adjustEventTime = function (processedItem, isAllDay, itemIsAllDay, cellDetails) {\n    var isTimeScaleEnabled = this.parent.activeViewOptions.timeScale.enable;\n    if (['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) !== -1 && isTimeScaleEnabled) {\n      if (isAllDay) {\n        processedItem[this.parent.eventFields.endTime] = new Date(processedItem[this.parent.eventFields.startTime]);\n        processedItem[this.parent.eventFields.endTime].setDate(processedItem[this.parent.eventFields.startTime].getDate() + 1);\n      } else if (itemIsAllDay) {\n        processedItem[this.parent.eventFields.startTime] = new Date(processedItem[this.parent.eventFields.startTime].setHours(0, 0, 0, 0));\n        processedItem[this.parent.eventFields.endTime] = new Date(processedItem[this.parent.eventFields.startTime].getTime() + (cellDetails.endTime.getTime() - cellDetails.startTime.getTime()));\n      }\n    } else if (itemIsAllDay) {\n      processedItem[this.parent.eventFields.isAllDay] = true;\n      processedItem[this.parent.eventFields.startTime] = new Date(processedItem[this.parent.eventFields.startTime].setHours(0, 0, 0, 0));\n      processedItem[this.parent.eventFields.endTime] = new Date(processedItem[this.parent.eventFields.startTime].getTime() + (processedItem[this.parent.eventFields.endTime].getTime() - processedItem[this.parent.eventFields.startTime].getTime()));\n    }\n  };\n  KeyboardInteraction.prototype.prepareEventData = function (selectedEventData, eventDetails) {\n    var _this = this;\n    var initialEventTime = new Date(selectedEventData[0][this.parent.eventFields.startTime]);\n    var uniqueId = this.parent.getEventMaxID();\n    return selectedEventData.map(function (events) {\n      var totalDuration = _this.calculateTotalDuration(events, eventDetails, initialEventTime);\n      var cloneDetails = _this.isCutAction ? events : __assign({}, events);\n      if (!events[_this.parent.eventFields.recurrenceRule]) {\n        cloneDetails[_this.parent.eventFields.startTime] = new Date(new Date(cloneDetails[_this.parent.eventFields.startTime]).setMilliseconds(totalDuration));\n        cloneDetails[_this.parent.eventFields.endTime] = new Date(new Date(cloneDetails[_this.parent.eventFields.endTime]).setMilliseconds(totalDuration));\n      }\n      if (!_this.isCutAction) {\n        cloneDetails[_this.parent.eventFields.id] = uniqueId++;\n      }\n      return cloneDetails;\n    });\n  };\n  KeyboardInteraction.prototype.calculateTotalDuration = function (events, eventDetails, initialEventTime) {\n    if (['Month', 'TimelineMonth', 'TimelineYear'].indexOf(this.parent.currentView) !== -1 || !this.parent.activeViewOptions.timeScale.enable) {\n      var eventStartTime = new Date(events[this.parent.eventFields.startTime]);\n      return eventDetails[this.parent.eventFields.startTime].getTime() - initialEventTime.getTime() + (eventStartTime.getHours() * 3600000 + eventStartTime.getMinutes() * 60000 + eventStartTime.getSeconds() * 1000);\n    } else {\n      return eventDetails[this.parent.eventFields.startTime].getTime() - initialEventTime.getTime();\n    }\n  };\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name.\n   */\n  KeyboardInteraction.prototype.getModuleName = function () {\n    return 'keyboard';\n  };\n  /**\n   * To destroy the keyboard module.\n   *\n   * @returns {void}\n   * @private\n   */\n  KeyboardInteraction.prototype.destroy = function () {\n    this.removeEventListener();\n    this.selectedCells = [];\n    this.clipBoardTextArea = null;\n    this.keyboardModule.destroy();\n  };\n  return KeyboardInteraction;\n}();\nexport { KeyboardInteraction };","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","KeyboardEvents","closest","EventHandler","extend","Browser","isNullOrUndefined","addClass","removeClass","event","util","cls","cellSelect","KeyboardInteraction","parent","selectedCells","isCutContentPasted","isCutAction","keyConfigs","downArrow","upArrow","rightArrow","leftArrow","shiftDownArrow","shiftUpArrow","shiftRightArrow","shiftLeftArrow","ctrlLeftArrow","ctrlRightArrow","altOne","altTwo","altThree","altFour","altFive","altSix","altSeven","altEight","altNine","enter","escape","delete","backspace","home","pageUp","pageDown","tab","shiftTab","ctrlShiftUpArrow","ctrlShiftDownArrow","ctrlShiftLeftArrow","ctrlShiftRightArrow","shiftAltY","shiftAltN","cut","copy","cmdCut","cmdCopy","element","tabIndex","keyboardModule","keyAction","keyActionHandler","bind","eventName","addEventListener","createClipboardElement","e","action","processDown","shiftKey","processUp","processLeft","processRight","changeDate","activeView","getNextPreviousDate","headerModule","querySelector","focus","processViewNavigation","processEnter","focusFirstCell","processTab","processDelete","processCtrlShiftNavigationArrows","processEscape","allowInline","inlineModule","preventDefault","processFTwelve","Date","currentView","processShiftAltN","processClipboardAction","undefined","getSelectedCells","target","cellData","WORK_CELLS_CLASS","ALLDAY_CELLS_CLASS","HEADER_CELLS_CLASS","getSelectedElements","APPOINTMENT_CLASS","activeEventData","event_1","startTime","StartTime","endTime","EndTime","isAllDay","IsAllDay","workHour","getStartEndTime","workHours","start","slotInterval","activeViewOptions","timeScale","interval","slotCount","selectedDate","setHours","getHours","getMinutes","getTime","args","cancel","eventWindow","openEditor","classList","contains","activeCellsData","inlineArgs","groupIndex","type","notify","inlineClick","click","on","cellMouseDown","onCellMouseDown","allowClipboard","documentPaste","pasteHandler","removeEventListener","off","initialTarget","getClosestCell","readonly","which","removeSelectedClass","add","getContentTable","onMouseSelection","onMoveUp","allDayRow","getAllDayRow","appointments","slice","querySelectorAll","selectionEdges","boundaryValidation","pageY","pageX","bottom","top","left","right","parent_1","CONTENT_WRAP_CLASS","yInBounds","offsetHeight","scrollHeight","scrollTop","xInBounds","offsetWidth","scrollWidth","scrollLeft","selectCells","_this","remove","isPreventAction","queryStr","indexOf","OTHERMONTH_CLASS","convertToEventData","data","requestType","showQuickPopup","trigger","select","selectArgs","isPopupShow","quickInfoOnSelectionEnd","cellArgs","name","cellClick","POPUP_WRAPPER_CLASS","QUICK_POPUP_EVENT_DETAILS_CLASS","EVENT_CREATE_CLASS","EDIT_EVENT_CLASS","DELETE_EVENT_CLASS","CLOSE_CLASS","SUBJECT_CLASS","RESOURCE_CELLS_CLASS","RESOURCE_PARENT_CLASS","resourceIcon","RESOURCE_TREE_ICON_CLASS","INLINE_SUBJECT_CLASS","inlineCrudActions","MORE_EVENT_CLOSE_CLASS","ALLDAY_APPOINTMENT_SECTION_CLASS","MORE_INDICATOR_CLASS","MORE_EVENT_HEADER_DATE_CLASS","setProperties","getDateFromElement","changeView","getNavigateView","cellDetails","SELECTED_CELL_CLASS","getCellDetails","end","getCells","isInverseTable","tableEle","isTimelineYear","query","cells","maxRow","rows","maxColumn","startIndex","endIndex","inverseCells","j","cell","push","temp","sCells","focusCell","AGENDA_CELLS_CLASS","setAttribute","eventBase","removeSelectedAppointmentClass","isTimelineView","CONTENT_TABLE_CLASS","HIDDEN_CLASS","RESOURCE_GROUP_CELLS_CLASS","isVerticalYear","orientation","startDate","getWorkCellElements","isInverseTableSelect","isMultiple","targetCell","Array","initialId_1","views_1","allowMultipleRow","removeInlineAppointmentElement","allowMultiRowSelection","isGroupYear","group","resources","parentElement","children","cellIndex","getAttribute","resourceSelectedCells","_i","selectedCells_1","allowMultiCellSelection","allDayCells","getAllDayCells","resourceAllDayCells","_a","allDayCells_1","concat","addSelectedClass","selectAppointment","isReverse","getAppointmentElements","nextAppEle","targetIndex","addSelectedAppointments","AGENDA_SELECTED_CELL","selectAppointmentElementFromWorkCell","appointmentElements_1","getUniqueAppointmentElements","filteredElements_1","selectedDate_1","selectedSeriesEvents","eventsProcessed","filter","eventObject","eventFields","JSON","stringify","Guid","selectedElement","focusElements","getAppointmentElementsByGuid","startCell","endCell","MS_PER_DAY","guid","appointmentElements","map","value","index","self","parseInt","toString","getWorkCellFromAppointmentElement","selectedObject","getEventByGuid","selectWorkCellByTime","code","isNaN","views","view","viewCollections","option","isCalendarTarget","keyTarget","currentTarget","cancelUpDownAction","isGroup","selectedElements","selectedEventElements","getSelectedAppointments","moreEventWrapper","MORE_POPUP_WRAPPER_CLASS","quickPopupWrapper","getQuickPopupElement","POPUP_OPEN","tableRows","getTableRows","curRowIndex","getVerticalUpDownCell","getHorizontalUpDownCell","getStartDate","getYearUpDownCell","getEndDate","rowIndex","isUp","row","workCell","date","getFullYear","getMonth","hasRow","column","dateAttr","processLeftRight","parentNode","sectionRowIndex","key","columnIndex","maxIndex","isAdaptive","document","body","isCancelLeftRightAction","prevent","selectedAppointments","targetDate","isMonthEnd","lastDateOfMonth","calculateNextPrevDate","getTimelineYearTargetCell","changeTargetCell","getHorizontalLeftRightCell","curColIndex","maxColIndex","allDayRow_1","isMonthStart","firstDateOfMonth","otherMonthCell","tbody","item","allDayRow_2","isRight","getVerticalLeftRightCell","currentCell","initialId","currentDate","nextPrevDate","setDate","getDate","getFocusableElements","container","queryString","processTabOnPopup","popupElement","focusableElements","footerEle","POPUP_FOOTER_CLASS","offsetParent","EDIT_CLASS","DELETE_CLASS","firstEle","lastEle","activeElement","popupWrapper","ROOT","appSelector","appElements","focusAppointment","resourceBase","lastResourceLevel","virtualScrollModule","virtual","VIRTUAL_TRACK_CLASS","averageRowHeight","Math","round","expandedResources","virtualScrolling","setScrollPosition","isTimeline","resCellSelector","resourceCell","preventScroll","processTabOnResourceCells","activeEle","selectedEle","getSelectedEvents","APPOINTMENT_BORDER","READ_ONLY","eventSettings","allowDeleting","quickPopup","deleteClick","eventEle","renderedResources","onClosePopup","morePopup","hide","hideHeaderPopup","tabElements","currentTabIndex","nextTabElement","resColWrap_1","RESOURCE_COLUMN_WRAP_CLASS","resCells","forEach","getBoundingClientRect","offsetTop","clipBoardTextArea","createElement","className","CLIPBOARD_CLASS","attrs","tabindex","appendChild","setCopy","copiedEventData","window","getSelection","eventDetails","elements","eventDatas","filteredContent","filterReadOnlyEvent","selectedEvents","isArray","getEventDetails","test","userAgent","setSelectionRange","navigator","clipboard","writeText","then","blur","removeAllRanges","closestAppointment","catch","err","isReadonly","isCut","closeQuickInfoPopup","clipboardEvent","targetElement","dialogObject","visible","clipboardData","pastedData","getData","parsedData","parse","beforePaste","pasteEventArgs","every","processPaste","getTargetElements","isAllDayEvent","getResourcesByIndex","processedData","processEventData","selectedEventData","sortByDateTime","saveData","prepareEventData","saveEvent","addEvent","some","processedItem","recurrenceID","adjustEventTime","groupData","itemIsAllDay","isTimeScaleEnabled","enable","initialEventTime","uniqueId","getEventMaxID","events","totalDuration","calculateTotalDuration","cloneDetails","recurrenceRule","setMilliseconds","id","eventStartTime","getSeconds","getModuleName","destroy"],"sources":["C:/Users/Dell/OneDrive/Desktop/Programs/soc-portal/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/keyboard.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { KeyboardEvents, closest, EventHandler, extend, Browser } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, addClass, removeClass } from '@syncfusion/ej2-base';\nimport * as event from '../base/constant';\nimport * as util from '../base/util';\nimport * as cls from '../base/css-constant';\nimport { cellSelect } from '../base/constant';\n/**\n * Keyboard interaction\n */\nvar KeyboardInteraction = /** @class */ (function () {\n    function KeyboardInteraction(parent) {\n        this.selectedCells = [];\n        this.isCutContentPasted = false;\n        this.isCutAction = false;\n        this.keyConfigs = {\n            downArrow: 'downarrow',\n            upArrow: 'uparrow',\n            rightArrow: 'rightarrow',\n            leftArrow: 'leftarrow',\n            shiftDownArrow: 'shift+downarrow',\n            shiftUpArrow: 'shift+uparrow',\n            shiftRightArrow: 'shift+rightarrow',\n            shiftLeftArrow: 'shift+leftarrow',\n            ctrlLeftArrow: 'ctrl+leftarrow',\n            ctrlRightArrow: 'ctrl+rightarrow',\n            altOne: 'alt+1',\n            altTwo: 'alt+2',\n            altThree: 'alt+3',\n            altFour: 'alt+4',\n            altFive: 'alt+5',\n            altSix: 'alt+6',\n            altSeven: 'alt+7',\n            altEight: 'alt+8',\n            altNine: 'alt+9',\n            enter: 'enter',\n            escape: 'escape',\n            delete: 'delete',\n            backspace: 'backspace',\n            home: 'home',\n            pageUp: 'pageup',\n            pageDown: 'pagedown',\n            tab: 'tab',\n            shiftTab: 'shift+tab',\n            ctrlShiftUpArrow: 'ctrl+shift+uparrow',\n            ctrlShiftDownArrow: 'ctrl+shift+downarrow',\n            ctrlShiftLeftArrow: 'ctrl+shift+leftarrow',\n            ctrlShiftRightArrow: 'ctrl+shift+rightarrow',\n            shiftAltY: 'shift+alt+y',\n            shiftAltN: 'shift+alt+n',\n            cut: 'ctrl+x',\n            copy: 'ctrl+c',\n            cmdCut: 'cmd+x',\n            cmdCopy: 'cmd+c'\n        };\n        this.parent = parent;\n        this.parent.element.tabIndex = this.parent.element.tabIndex === -1 ? 0 : this.parent.element.tabIndex;\n        this.keyboardModule = new KeyboardEvents(this.parent.element, {\n            keyAction: this.keyActionHandler.bind(this),\n            keyConfigs: this.keyConfigs,\n            eventName: 'keydown'\n        });\n        this.addEventListener();\n        this.createClipboardElement();\n    }\n    KeyboardInteraction.prototype.keyActionHandler = function (e) {\n        switch (e.action) {\n            case 'downArrow':\n            case 'shiftDownArrow':\n                this.processDown(e, e.shiftKey);\n                break;\n            case 'upArrow':\n            case 'shiftUpArrow':\n                this.processUp(e, e.shiftKey);\n                break;\n            case 'leftArrow':\n            case 'shiftLeftArrow':\n                this.processLeft(e, e.shiftKey);\n                break;\n            case 'rightArrow':\n            case 'shiftRightArrow':\n                this.processRight(e, e.shiftKey);\n                break;\n            case 'ctrlLeftArrow':\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Previous'), e);\n                if (this.parent.headerModule) {\n                    this.parent.headerModule.element.querySelector('.e-prev button').focus();\n                }\n                break;\n            case 'ctrlRightArrow':\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Next'), e);\n                if (this.parent.headerModule) {\n                    this.parent.headerModule.element.querySelector('.e-next button').focus();\n                }\n                break;\n            case 'altOne':\n            case 'altTwo':\n            case 'altThree':\n            case 'altFour':\n            case 'altFive':\n            case 'altSix':\n            case 'altSeven':\n            case 'altEight':\n            case 'altNine':\n                this.processViewNavigation(e);\n                break;\n            case 'enter':\n                this.processEnter(e);\n                break;\n            case 'home':\n                this.focusFirstCell();\n                break;\n            case 'tab':\n            case 'shiftTab':\n                this.processTab(e, e.shiftKey);\n                break;\n            case 'delete':\n            case 'backspace':\n                this.processDelete(e);\n                break;\n            case 'ctrlShiftUpArrow':\n            case 'ctrlShiftDownArrow':\n            case 'ctrlShiftLeftArrow':\n            case 'ctrlShiftRightArrow':\n                this.processCtrlShiftNavigationArrows(e);\n                break;\n            case 'escape':\n                this.processEscape(e);\n                break;\n            case 'fTwelve':\n                if (this.parent.allowInline && this.parent.inlineModule) {\n                    e.preventDefault();\n                    this.processFTwelve(e);\n                }\n                break;\n            case 'shiftAltY':\n                this.parent.changeDate(new Date(), e);\n                break;\n            case 'shiftAltN':\n                if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda' ||\n                    this.parent.currentView === 'Year') {\n                    return;\n                }\n                this.processShiftAltN(e);\n                break;\n            case 'cut':\n            case 'cmdCut':\n                this.processClipboardAction(true, undefined, e);\n                break;\n            case 'copy':\n            case 'cmdCopy':\n                this.processClipboardAction(false, undefined, e);\n                break;\n        }\n    };\n    KeyboardInteraction.prototype.processShiftAltN = function (e) {\n        var selectedCells = this.parent.getSelectedCells();\n        var target = e.target;\n        var cellData = extend({}, null, true);\n        if (selectedCells.length > 0 && (closest(target, '.' + cls.WORK_CELLS_CLASS)\n            || closest(target, '.' + cls.ALLDAY_CELLS_CLASS) || closest(target, '.' + cls.HEADER_CELLS_CLASS))) {\n            cellData = this.getSelectedElements(target);\n        }\n        else if (closest(target, '.' + cls.APPOINTMENT_CLASS) && !isNullOrUndefined(this.parent.activeEventData.event)) {\n            var event_1 = this.parent.activeEventData.event;\n            cellData.startTime = event_1.StartTime;\n            cellData.endTime = event_1.EndTime;\n            cellData.isAllDay = event_1.IsAllDay;\n        }\n        else {\n            var workHour = this.parent.getStartEndTime(this.parent.workHours.start);\n            var slotInterval = this.parent.activeViewOptions.timeScale.interval /\n                this.parent.activeViewOptions.timeScale.slotCount;\n            cellData.startTime = new Date(this.parent.selectedDate);\n            cellData.startTime.setHours(workHour.getHours(), workHour.getMinutes(), 0, 0);\n            cellData.endTime = new Date(cellData.startTime.getTime() + slotInterval * 60000);\n        }\n        var args = extend(cellData, { cancel: false, event: e });\n        if (args != null) {\n            this.parent.eventWindow.openEditor(args, 'Add');\n        }\n    };\n    KeyboardInteraction.prototype.processFTwelve = function (e) {\n        var target = e.target;\n        if (target.classList.contains(cls.WORK_CELLS_CLASS) || target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            this.parent.activeCellsData = this.getSelectedElements(target);\n            var args = extend(this.parent.activeCellsData, { cancel: false, event: e });\n            var inlineArgs = {\n                element: args.element,\n                groupIndex: args.groupIndex, type: 'Cell'\n            };\n            this.parent.notify(event.inlineClick, inlineArgs);\n        }\n        if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n            target.click();\n            return;\n        }\n    };\n    KeyboardInteraction.prototype.addEventListener = function () {\n        this.parent.on(event.cellMouseDown, this.onCellMouseDown, this);\n        if (this.parent.allowClipboard) {\n            this.parent.on(event.documentPaste, this.pasteHandler, this);\n        }\n    };\n    KeyboardInteraction.prototype.removeEventListener = function () {\n        this.parent.off(event.cellMouseDown, this.onCellMouseDown);\n        this.parent.off(event.documentPaste, this.pasteHandler);\n    };\n    KeyboardInteraction.prototype.onCellMouseDown = function (e) {\n        if (e.event.shiftKey) {\n            return;\n        }\n        this.initialTarget = this.getClosestCell(e.event);\n        if (this.parent.activeViewOptions.readonly || this.parent.currentView === 'MonthAgenda' || !this.initialTarget) {\n            return;\n        }\n        if (e.event.target.classList.contains(cls.WORK_CELLS_CLASS) && e.event.which !== 3) {\n            this.parent.removeSelectedClass();\n            EventHandler.add(this.parent.getContentTable(), 'mousemove', this.onMouseSelection, this);\n            EventHandler.add(this.parent.getContentTable(), 'mouseup mouseleave', this.onMoveUp, this);\n        }\n        if (e.event.target.classList.contains(cls.ALLDAY_CELLS_CLASS) && e.event.which !== 3) {\n            this.parent.removeSelectedClass();\n            var allDayRow = this.parent.getAllDayRow();\n            EventHandler.add(allDayRow, 'mousemove', this.onMouseSelection, this);\n            EventHandler.add(allDayRow, 'mouseup mouseleave', this.onMoveUp, this);\n        }\n    };\n    KeyboardInteraction.prototype.onMouseSelection = function (e) {\n        var appointments = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n        addClass(appointments, 'e-allow-select');\n        var selectionEdges = this.parent.boundaryValidation(e.pageY, e.pageX);\n        if (selectionEdges.bottom || selectionEdges.top || selectionEdges.left || selectionEdges.right) {\n            var parent_1 = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            var yInBounds = parent_1.offsetHeight <= parent_1.scrollHeight && parent_1.scrollTop >= 0 &&\n                parent_1.scrollTop + parent_1.offsetHeight <= parent_1.scrollHeight;\n            var xInBounds = parent_1.offsetWidth <= parent_1.scrollWidth && parent_1.scrollLeft >= 0 &&\n                parent_1.scrollLeft + parent_1.offsetWidth <= parent_1.scrollWidth;\n            if (yInBounds && (selectionEdges.top || selectionEdges.bottom)) {\n                parent_1.scrollTop += selectionEdges.top ? -e.target.offsetHeight : e.target.offsetHeight;\n            }\n            if (xInBounds && (selectionEdges.left || selectionEdges.right)) {\n                parent_1.scrollLeft += selectionEdges.left ? -e.target.offsetWidth : e.target.offsetWidth;\n            }\n        }\n        var target = this.getClosestCell(e);\n        if (target) {\n            this.selectCells(true, target);\n        }\n    };\n    KeyboardInteraction.prototype.getClosestCell = function (e) {\n        return closest(e.target, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS);\n    };\n    KeyboardInteraction.prototype.onMoveUp = function (e) {\n        var _this = this;\n        var appointments = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n        removeClass(appointments, 'e-allow-select');\n        EventHandler.remove(this.parent.getContentTable(), 'mousemove', this.onMouseSelection);\n        EventHandler.remove(this.parent.getContentTable(), 'mouseup mouseleave', this.onMoveUp);\n        if (e.target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            var allDayRow = this.parent.getAllDayRow();\n            EventHandler.remove(allDayRow, 'mousemove', this.onMouseSelection);\n            EventHandler.remove(allDayRow, 'mouseup mouseleave', this.onMoveUp);\n        }\n        if (this.isPreventAction(e)) {\n            return;\n        }\n        var queryStr = '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS + ',.' + cls.HEADER_CELLS_CLASS;\n        var target = closest(e.target, queryStr);\n        var selectedCells = this.parent.getSelectedCells();\n        if (selectedCells.length > 0 && selectedCells.indexOf(target) === -1) {\n            target = selectedCells[selectedCells.length - 1];\n        }\n        if (this.parent.currentView === 'TimelineYear' && target.classList.contains(cls.OTHERMONTH_CLASS)) {\n            return;\n        }\n        this.parent.activeCellsData = this.getSelectedElements(target);\n        var cellData = {};\n        if (this.parent.eventWindow) {\n            this.parent.eventWindow.convertToEventData(this.parent.activeCellsData, cellData);\n        }\n        var args = {\n            data: cellData, element: this.parent.activeCellsData.element, event: e,\n            requestType: cellSelect, showQuickPopup: false\n        };\n        this.parent.trigger(event.select, args, function (selectArgs) {\n            var isPopupShow = selectArgs.showQuickPopup || _this.parent.quickInfoOnSelectionEnd;\n            if (isPopupShow && selectedCells.length > 1) {\n                var cellArgs = extend(_this.parent.activeCellsData, { cancel: false, event: e, name: 'cellClick' });\n                _this.parent.notify(event.cellClick, cellArgs);\n            }\n        });\n    };\n    KeyboardInteraction.prototype.processEnter = function (e) {\n        if ((this.parent.activeViewOptions.readonly && !e.target.classList.contains(cls.APPOINTMENT_CLASS))\n            || this.isPreventAction(e)) {\n            return;\n        }\n        if (this.parent.currentView === 'TimelineYear' && e.target.classList.contains(cls.OTHERMONTH_CLASS)) {\n            return;\n        }\n        var target = e.target;\n        if (closest(target, '.' + cls.POPUP_WRAPPER_CLASS)) {\n            if (target.classList.contains(cls.QUICK_POPUP_EVENT_DETAILS_CLASS) ||\n                target.classList.contains(cls.EVENT_CREATE_CLASS) ||\n                target.classList.contains(cls.EDIT_EVENT_CLASS) ||\n                target.classList.contains(cls.DELETE_EVENT_CLASS) ||\n                target.classList.contains(cls.CLOSE_CLASS)) {\n                target.click();\n                e.preventDefault();\n            }\n            else if (target.classList.contains(cls.SUBJECT_CLASS)) {\n                this.parent.element.querySelector('.' + cls.EVENT_CREATE_CLASS).click();\n                e.preventDefault();\n            }\n            return;\n        }\n        if (target.classList.contains(cls.RESOURCE_CELLS_CLASS) && target.classList.contains(cls.RESOURCE_PARENT_CLASS)) {\n            var resourceIcon = target.querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n            if (resourceIcon) {\n                resourceIcon.click();\n            }\n            return;\n        }\n        if (target.classList.contains(cls.WORK_CELLS_CLASS) || target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            this.parent.activeCellsData = this.getSelectedElements(target);\n            var args = extend(this.parent.activeCellsData, { cancel: false, event: e });\n            if (this.parent.allowInline) {\n                var inlineArgs = {\n                    element: args.element,\n                    groupIndex: args.groupIndex, type: 'Cell'\n                };\n                this.parent.notify(event.inlineClick, inlineArgs);\n            }\n            else {\n                if (this.parent.currentView === 'Year') {\n                    target.click();\n                }\n                else {\n                    this.parent.notify(event.cellClick, args);\n                }\n            }\n            return;\n        }\n        if (target.classList.contains(cls.INLINE_SUBJECT_CLASS) && this.parent.inlineModule) {\n            this.parent.inlineModule.inlineCrudActions(target);\n            return;\n        }\n        if (target.classList.contains(cls.APPOINTMENT_CLASS) || target.classList.contains(cls.MORE_EVENT_CLOSE_CLASS) ||\n            target.classList.contains(cls.ALLDAY_APPOINTMENT_SECTION_CLASS) || target.classList.contains(cls.MORE_INDICATOR_CLASS)) {\n            target.click();\n            return;\n        }\n        if (target.classList.contains(cls.MORE_EVENT_HEADER_DATE_CLASS)) {\n            this.parent.setProperties({ selectedDate: this.parent.getDateFromElement(target) }, true);\n            this.parent.changeView(this.parent.getNavigateView(), e);\n            this.processEscape(e);\n            return;\n        }\n    };\n    KeyboardInteraction.prototype.getSelectedElements = function (target) {\n        var cellDetails;\n        if (this.selectedCells.length > 1 && target.classList.contains(cls.SELECTED_CELL_CLASS)) {\n            var start = this.parent.getCellDetails(this.selectedCells[0]);\n            var end = this.parent.getCellDetails(this.selectedCells.slice(-1)[0]);\n            start.endTime = end.endTime;\n            start.element = target;\n            cellDetails = start;\n        }\n        else {\n            cellDetails = this.parent.getCellDetails(target);\n        }\n        return cellDetails;\n    };\n    KeyboardInteraction.prototype.getCells = function (isInverseTable, start, end) {\n        var tableEle = this.parent.getContentTable();\n        var isTimelineYear = this.parent.currentView === 'TimelineYear';\n        var query = isTimelineYear && !isInverseTable ? '.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')' : 'td';\n        var cells = [].slice.call(tableEle.querySelectorAll(query));\n        var maxRow = tableEle.rows.length;\n        var maxColumn = tableEle.rows[0].cells.length;\n        if (start && start.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            var allDayRow = this.parent.getAllDayRow();\n            cells = [].slice.call(allDayRow.cells);\n            maxRow = 1;\n            maxColumn = allDayRow.cells.length;\n        }\n        var startIndex = cells.indexOf(start);\n        var endIndex = cells.indexOf(end);\n        var inverseCells = [];\n        if (isInverseTable) {\n            for (var i = 0; i < maxColumn; i++) {\n                for (var j = 0; j < maxRow; j++) {\n                    var cell = cells[maxColumn * j + i];\n                    if (isTimelineYear && cell.classList.contains(cls.OTHERMONTH_CLASS)) {\n                        continue;\n                    }\n                    inverseCells.push(cell);\n                }\n            }\n            startIndex = inverseCells.indexOf(start);\n            endIndex = inverseCells.indexOf(end);\n        }\n        if (startIndex > endIndex) {\n            var temp = startIndex;\n            startIndex = endIndex;\n            endIndex = temp;\n        }\n        var sCells = isInverseTable ? inverseCells : cells;\n        return sCells.slice(startIndex, endIndex + 1);\n    };\n    KeyboardInteraction.prototype.focusFirstCell = function () {\n        if (this.parent.currentView === 'Agenda') {\n            var focusCell = this.parent.getContentTable().querySelector('.' + cls.AGENDA_CELLS_CLASS);\n            focusCell.setAttribute('tabindex', '0');\n            focusCell.focus();\n            return;\n        }\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            var cell = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS +\n                ' tr:not(.' + cls.HIDDEN_CLASS + ') .' + cls.WORK_CELLS_CLASS + ':not(.' + cls.RESOURCE_GROUP_CELLS_CLASS + ')');\n            this.selectCells(false, cell);\n        }\n        else if (this.parent.currentView.indexOf('Year') > -1) {\n            var query = '.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')' + ':not(.' + cls.RESOURCE_GROUP_CELLS_CLASS + ')';\n            var isVerticalYear = this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.orientation === 'Vertical';\n            query += isVerticalYear ? '[data-date=\"' + this.parent.activeView.startDate().getTime() + '\"]' : '';\n            this.selectCells(false, this.parent.element.querySelector(query));\n        }\n        else {\n            this.selectCells(false, this.parent.getWorkCellElements()[0]);\n        }\n    };\n    KeyboardInteraction.prototype.isInverseTableSelect = function () {\n        return this.parent.activeView.isInverseTableSelect;\n    };\n    /**\n     * Internal method to select cells\n     *\n     * @param {boolean} isMultiple Accepts to select multiple cells or not\n     * @param {HTMLTableCellElement} targetCell Accepts the target cells\n     * @returns {void}\n     * @private\n     */\n    KeyboardInteraction.prototype.selectCells = function (isMultiple, targetCell) {\n        var _this = this;\n        this.parent.removeSelectedClass();\n        var target = (targetCell instanceof Array) ? targetCell.slice(-1)[0] : targetCell;\n        if (isMultiple) {\n            var initialId_1;\n            var views_1 = ['Day', 'Week', 'WorkWeek', 'TimelineDay', 'TimelineWeek', 'TimelineWorkWeek', 'TimelineMonth', 'TimelineYear'];\n            var args = { element: targetCell, requestType: 'mousemove', allowMultipleRow: true };\n            this.parent.inlineModule.removeInlineAppointmentElement();\n            this.parent.trigger(event.select, args, function (selectArgs) {\n                var allowMultipleRow = (!selectArgs.allowMultipleRow) || (!_this.parent.allowMultiRowSelection);\n                if (allowMultipleRow) {\n                    var isTimelineYear = _this.parent.currentView === 'TimelineYear';\n                    if (isTimelineYear && _this.parent.activeViewOptions.orientation === 'Horizontal' || _this.parent.currentView === 'Month') {\n                        var isGroupYear = isTimelineYear && _this.parent.activeViewOptions.group.resources.length > 0;\n                        target = isGroupYear ? _this.initialTarget :\n                            _this.initialTarget.parentElement.children[target.cellIndex];\n                    }\n                    else if (views_1.indexOf(_this.parent.currentView) > -1) {\n                        target = target.parentElement.children[_this.initialTarget.cellIndex];\n                    }\n                }\n                var selectedCells = _this.getCells(_this.isInverseTableSelect(), _this.initialTarget, target);\n                if (_this.parent.activeViewOptions.group.resources.length > 0) {\n                    initialId_1 = _this.initialTarget.getAttribute('data-group-index');\n                    var resourceSelectedCells = [];\n                    for (var _i = 0, selectedCells_1 = selectedCells; _i < selectedCells_1.length; _i++) {\n                        var cell = selectedCells_1[_i];\n                        if (cell.getAttribute('data-group-index') === initialId_1) {\n                            resourceSelectedCells.push(cell);\n                        }\n                    }\n                    selectedCells = resourceSelectedCells;\n                }\n                if (!_this.parent.allowMultiCellSelection) {\n                    selectedCells = [_this.initialTarget];\n                }\n                _this.selectedCells = selectedCells;\n                if (selectedCells.length > 2 && !target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n                    var allDayCells = _this.getAllDayCells(selectedCells);\n                    if (_this.parent.activeViewOptions.group.resources.length > 0) {\n                        var resourceAllDayCells = [];\n                        for (var _a = 0, allDayCells_1 = allDayCells; _a < allDayCells_1.length; _a++) {\n                            var cell = allDayCells_1[_a];\n                            if (cell.getAttribute('data-group-index') === initialId_1) {\n                                resourceAllDayCells.push(cell);\n                            }\n                        }\n                        allDayCells = resourceAllDayCells;\n                    }\n                    selectedCells = selectedCells.concat(allDayCells);\n                }\n                if ((target.getAttribute('data-group-index') !== initialId_1) && _this.parent.activeViewOptions.group.resources.length > 0) {\n                    target = _this.selectedCells[_this.selectedCells.length - 1];\n                }\n                _this.parent.addSelectedClass(selectedCells, target);\n            });\n        }\n        else {\n            var args = {\n                element: target, requestType: cellSelect\n            };\n            // activeCellsData is not reset on schedule property changed(group properties)\n            // const cellData: Record<string, any> = {};\n            // const cellDetails: CellClickEventArgs = this.parent.getCellDetails(target);\n            // if (this.parent.eventWindow && cellDetails) {\n            //     if (this.parent.activeCellsData.element !== cellDetails.element) {\n            //         this.parent.activeCellsData = cellDetails;\n            //     }\n            //     this.parent.eventWindow.convertToEventData(this.parent.activeCellsData as unknown as Record<string, any>, cellData);\n            //     args.data = cellData;\n            // }\n            this.parent.trigger(event.select, args, function () {\n                _this.initialTarget = target;\n                _this.selectedCells = [target];\n                _this.parent.addSelectedClass([target], target);\n            });\n        }\n    };\n    KeyboardInteraction.prototype.selectAppointment = function (isReverse, target) {\n        var appointments = this.getAppointmentElements();\n        if (appointments.length < 0) {\n            return;\n        }\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        var nextAppEle;\n        if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n            var targetIndex = appointments.indexOf(target);\n            nextAppEle = appointments[(isReverse ? targetIndex - 1 : targetIndex + 1)];\n        }\n        else {\n            nextAppEle = isReverse ? appointments[appointments.length - 1] : appointments[0];\n        }\n        if (nextAppEle) {\n            this.parent.eventBase.addSelectedAppointments([nextAppEle], true);\n            nextAppEle.focus();\n            addClass([nextAppEle], cls.AGENDA_SELECTED_CELL);\n        }\n    };\n    KeyboardInteraction.prototype.selectAppointmentElementFromWorkCell = function (isReverse, target) {\n        var _this = this;\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        this.parent.removeSelectedClass();\n        if (target.classList.contains(cls.WORK_CELLS_CLASS) || target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            var appointmentElements_1 = this.getUniqueAppointmentElements();\n            var filteredElements_1 = [];\n            var selectedDate_1 = this.parent.getDateFromElement(target).getTime();\n            var selectedSeriesEvents = this.parent.eventsProcessed.filter(function (eventObject) {\n                return (!isReverse ? (eventObject[_this.parent.eventFields.startTime].getTime() >= selectedDate_1) :\n                    (eventObject[_this.parent.eventFields.startTime].getTime() <= selectedDate_1));\n            });\n            selectedSeriesEvents.filter(function (event) {\n                appointmentElements_1.filter(function (element) {\n                    if (JSON.stringify(event.Guid) === JSON.stringify(element.getAttribute('data-guid'))) {\n                        filteredElements_1.push(element);\n                    }\n                });\n            });\n            if (filteredElements_1.length > 0) {\n                var selectedElement = isReverse ? filteredElements_1[filteredElements_1.length - 1] : filteredElements_1[0];\n                var focusElements = this.getAppointmentElementsByGuid(selectedElement.getAttribute('data-guid'));\n                this.parent.eventBase.addSelectedAppointments(focusElements, true);\n                (focusElements[focusElements.length - 1]).focus();\n            }\n        }\n    };\n    KeyboardInteraction.prototype.getAllDayCells = function (cells) {\n        var allDayRow = this.parent.getAllDayRow();\n        if (!allDayRow) {\n            return [];\n        }\n        var startCell = cells[0];\n        var endCell = cells[cells.length - 1];\n        var start = this.parent.getCellDetails(startCell);\n        var end = this.parent.getCellDetails(endCell);\n        if (end.endTime.getTime() - start.startTime.getTime() >= util.MS_PER_DAY) {\n            var allDayCells = [].slice.call(allDayRow.cells);\n            return allDayCells.slice(startCell.cellIndex, endCell.cellIndex + 1);\n        }\n        return [];\n    };\n    KeyboardInteraction.prototype.getAppointmentElements = function () {\n        return [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n    };\n    KeyboardInteraction.prototype.getAppointmentElementsByGuid = function (guid) {\n        return [].slice.call(this.parent.element.querySelectorAll('div[data-guid=\"' + guid + '\"]'));\n    };\n    KeyboardInteraction.prototype.getUniqueAppointmentElements = function () {\n        var appointments = this.getAppointmentElements();\n        var appointmentElements = [];\n        appointments.map(function (value) { return value.getAttribute('data-guid'); }).filter(function (value, index, self) {\n            if (self.indexOf(value) === index) {\n                appointmentElements.push(appointments[parseInt(index.toString(), 10)]);\n            }\n        });\n        return appointmentElements;\n    };\n    KeyboardInteraction.prototype.getWorkCellFromAppointmentElement = function (target) {\n        var selectedObject = this.parent.eventBase.getEventByGuid(target.getAttribute('data-guid'));\n        return this.parent.eventBase.selectWorkCellByTime([selectedObject]);\n    };\n    KeyboardInteraction.prototype.processViewNavigation = function (e) {\n        if (isNullOrUndefined(e.code)) {\n            return;\n        }\n        var index = parseInt(e.code.slice(e.code.length - 1), 10) - 1;\n        if (!isNaN(index) && !isNullOrUndefined(this.parent.views) && index < this.parent.views.length) {\n            var view = this.parent.viewCollections[parseInt(index.toString(), 10)].option;\n            this.parent.changeView(view, e, undefined, index);\n            if (this.parent.headerModule) {\n                this.parent.headerModule.element.querySelector('.e-active-view button').focus();\n            }\n        }\n    };\n    KeyboardInteraction.prototype.isCalendarTarget = function (e) {\n        var keyTarget = e.currentTarget || e.target;\n        if (keyTarget && !isNullOrUndefined(keyTarget.querySelector('.e-header-popup.e-popup-open'))) {\n            return true;\n        }\n        return false;\n    };\n    KeyboardInteraction.prototype.cancelUpDownAction = function (isTimelineYear) {\n        var isVerticalYear = isTimelineYear && this.parent.activeViewOptions.orientation === 'Vertical';\n        var isGroup = this.parent.activeViewOptions.group.resources.length > 0;\n        if (isVerticalYear && isGroup || isTimelineYear && this.initialTarget.classList.contains(cls.OTHERMONTH_CLASS)) {\n            return true;\n        }\n        if (this.parent.activeView.isTimelineView() && !isTimelineYear || this.parent.currentView === 'MonthAgenda') {\n            return true;\n        }\n        return false;\n    };\n    KeyboardInteraction.prototype.processUp = function (e, isMultiple) {\n        var isTimelineYear = this.parent.currentView === 'TimelineYear';\n        if (isMultiple && this.cancelUpDownAction(isTimelineYear) || (this.isCalendarTarget(e))) {\n            return;\n        }\n        var target = (e.target);\n        var selectedElements = this.parent.getSelectedCells();\n        var selectedEventElements = this.parent.eventBase.getSelectedAppointments();\n        var moreEventWrapper = this.parent.element.querySelector('.' + cls.MORE_POPUP_WRAPPER_CLASS);\n        var quickPopupWrapper = this.getQuickPopupElement();\n        if (selectedElements.length > 0 && !e.target.classList.contains(cls.WORK_CELLS_CLASS)) {\n            target = selectedElements[selectedElements.length - 1];\n        }\n        if (selectedEventElements.length > 0 && !moreEventWrapper.classList.contains(cls.POPUP_OPEN) &&\n            !quickPopupWrapper.classList.contains(cls.POPUP_OPEN) &&\n            ['Day', 'Week', 'WorkWeek', 'Month'].indexOf(this.parent.currentView) !== -1) {\n            target = this.getWorkCellFromAppointmentElement(selectedEventElements[selectedEventElements.length - 1]);\n            this.parent.eventBase.removeSelectedAppointmentClass();\n        }\n        if (!target) {\n            return;\n        }\n        if (target.classList.contains(cls.WORK_CELLS_CLASS) && !this.parent.element.querySelector('.' + cls.POPUP_OPEN)) {\n            var tableRows = this.parent.getTableRows();\n            var curRowIndex = tableRows.indexOf(target.parentElement);\n            var targetCell = void 0;\n            if (isTimelineYear && isMultiple && this.parent.activeViewOptions.group.resources.length === 0) {\n                targetCell = this.isInverseTableSelect() ? this.getVerticalUpDownCell(tableRows, target, curRowIndex, true) :\n                    this.getHorizontalUpDownCell(tableRows, target, curRowIndex, true);\n            }\n            if ((curRowIndex > 0 || targetCell) && curRowIndex < tableRows.length) {\n                targetCell = targetCell ? targetCell : (tableRows[curRowIndex - 1]).cells[target.cellIndex];\n                if (this.parent.currentView === 'Year' && targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n                    if (this.parent.activeView.getStartDate().getTime() < +targetCell.getAttribute('data-date')) {\n                        targetCell = this.getYearUpDownCell(tableRows, curRowIndex - 1, target.cellIndex, true);\n                    }\n                    else {\n                        return;\n                    }\n                }\n                e.preventDefault();\n                this.selectCells(isMultiple, targetCell);\n            }\n        }\n        else if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            this.selectAppointment(true, target);\n        }\n    };\n    KeyboardInteraction.prototype.processDown = function (e, isMultiple) {\n        var isTimelineYear = this.parent.currentView === 'TimelineYear';\n        if (isMultiple && this.cancelUpDownAction(isTimelineYear) || (this.isCalendarTarget(e))) {\n            return;\n        }\n        var target = (e.target);\n        var selectedCells = this.parent.getSelectedCells();\n        var selectedElements = this.parent.eventBase.getSelectedAppointments();\n        var moreEventWrapper = this.parent.element.querySelector('.' + cls.MORE_POPUP_WRAPPER_CLASS);\n        var quickPopupWrapper = this.getQuickPopupElement();\n        if (selectedCells.length > 0 && !e.target.classList.contains(cls.WORK_CELLS_CLASS)) {\n            target = selectedCells[selectedCells.length - 1];\n        }\n        if (selectedElements.length > 0 && !moreEventWrapper.classList.contains(cls.POPUP_OPEN) &&\n            !quickPopupWrapper.classList.contains(cls.POPUP_OPEN) &&\n            ['Day', 'Week', 'WorkWeek', 'Month'].indexOf(this.parent.currentView) !== -1) {\n            target = this.getWorkCellFromAppointmentElement(selectedElements[selectedElements.length - 1]);\n            this.parent.eventBase.removeSelectedAppointmentClass();\n        }\n        var tableRows = this.parent.getTableRows();\n        if (!target) {\n            return;\n        }\n        if (target.classList.contains(cls.WORK_CELLS_CLASS) && !this.parent.element.querySelector('.' + cls.POPUP_OPEN)) {\n            var curRowIndex = tableRows.indexOf(target.parentElement);\n            var targetCell = void 0;\n            if (isTimelineYear && isMultiple && this.parent.activeViewOptions.group.resources.length === 0) {\n                targetCell = this.isInverseTableSelect() ? this.getVerticalUpDownCell(tableRows, target, curRowIndex, false)\n                    : this.getHorizontalUpDownCell(tableRows, target, curRowIndex, false);\n            }\n            if (curRowIndex >= 0 && ((curRowIndex < tableRows.length - 1) || targetCell)) {\n                targetCell = targetCell ? targetCell : (tableRows[curRowIndex + 1]).cells[target.cellIndex];\n                if (this.parent.currentView === 'Year' && targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n                    if (this.parent.activeView.getEndDate().getTime() > +targetCell.getAttribute('data-date')) {\n                        targetCell = this.getYearUpDownCell(tableRows, curRowIndex + 1, target.cellIndex, false);\n                    }\n                    else {\n                        return;\n                    }\n                }\n                e.preventDefault();\n                this.selectCells(isMultiple, targetCell);\n            }\n        }\n        else if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            this.selectAppointment(false, target);\n        }\n    };\n    KeyboardInteraction.prototype.getYearUpDownCell = function (tableRows, rowIndex, cellIndex, isUp) {\n        while (tableRows[parseInt(rowIndex.toString(), 10)] &&\n            tableRows[parseInt(rowIndex.toString(), 10)].cells[parseInt(cellIndex.toString(), 10)].classList.contains(cls.OTHERMONTH_CLASS)) {\n            rowIndex = rowIndex + (isUp ? -1 : 1);\n        }\n        return tableRows[parseInt(rowIndex.toString(), 10)].cells[parseInt(cellIndex.toString(), 10)];\n    };\n    // eslint-disable-next-line max-len\n    KeyboardInteraction.prototype.getHorizontalUpDownCell = function (tableRows, target, curRowIndex, isUp) {\n        var row = tableRows[curRowIndex + (isUp ? -1 : 1)];\n        var cell = row ? row.cells[target.cellIndex] : target;\n        if (cell.classList.contains(cls.OTHERMONTH_CLASS)) {\n            var workCell = row.querySelector('.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')');\n            var date = new Date(+workCell.getAttribute('data-date'));\n            var query = '[data-date=\"' + new Date(date.getFullYear(), date.getMonth() + 1, 0).getTime() + '\"]';\n            cell = cell.cellIndex < workCell.cellIndex ? workCell : row.querySelector(query);\n        }\n        return cell;\n    };\n    // eslint-disable-next-line max-len\n    KeyboardInteraction.prototype.getVerticalUpDownCell = function (tableRows, target, curRowIndex, isUp) {\n        var hasRow = isUp && curRowIndex > 0 || !isUp && curRowIndex < tableRows.length - 1;\n        var targetCell = hasRow ? tableRows[curRowIndex + (isUp ? -1 : 1)].cells[target.cellIndex] : undefined;\n        if (!targetCell || targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n            var column = tableRows[parseInt(curRowIndex.toString(), 10)].cells[target.cellIndex - (isUp ? 1 : -1)];\n            if (column) {\n                var dateAttr = +target.getAttribute('data-date') - (isUp ? util.MS_PER_DAY : -util.MS_PER_DAY);\n                return this.parent.getContentTable().querySelector('.' + cls.WORK_CELLS_CLASS + '[data-date=\"' + dateAttr + '\"]');\n            }\n            targetCell = target;\n        }\n        return targetCell;\n    };\n    KeyboardInteraction.prototype.processLeftRight = function (target) {\n        var tableEle = (this.parent.currentView === 'Year' ? target.closest('tbody') : this.parent.getContentTable());\n        var curRowIndex = target.parentNode.sectionRowIndex;\n        var key = {\n            element: tableEle,\n            rowIndex: curRowIndex,\n            columnIndex: target.cellIndex,\n            maxIndex: tableEle.rows[parseInt(curRowIndex.toString(), 10)].cells.length\n        };\n        return key;\n    };\n    KeyboardInteraction.prototype.getQuickPopupElement = function () {\n        return (this.parent.isAdaptive ? document.body : this.parent.element).querySelector('.' + cls.POPUP_WRAPPER_CLASS);\n    };\n    KeyboardInteraction.prototype.isCancelLeftRightAction = function (e, isMultiple, isTimelineYear) {\n        var prevent = this.parent.currentView === 'MonthAgenda' || isTimelineYear && this.initialTarget.classList.contains(cls.OTHERMONTH_CLASS);\n        if (this.parent.currentView === 'Agenda' || (isMultiple && prevent)) {\n            return true;\n        }\n        if (this.isPreventAction(e) && isMultiple) {\n            return true;\n        }\n        var moreEventWrapper = this.parent.element.querySelector('.' + cls.MORE_POPUP_WRAPPER_CLASS);\n        var quickPopupWrapper = this.getQuickPopupElement();\n        if (moreEventWrapper.classList.contains(cls.POPUP_OPEN) || quickPopupWrapper.classList.contains(cls.POPUP_OPEN)) {\n            return true;\n        }\n        return false;\n    };\n    KeyboardInteraction.prototype.processRight = function (e, isMultiple) {\n        var isTimelineYear = this.parent.currentView === 'TimelineYear';\n        if (this.isCancelLeftRightAction(e, isMultiple, isTimelineYear) || (this.isCalendarTarget(e))) {\n            return;\n        }\n        var selectedCells = this.parent.getSelectedCells();\n        var targetCell;\n        var selectedAppointments = this.parent.eventBase.getSelectedAppointments();\n        var target = (e.target);\n        if (selectedCells.length > 0 && !target.classList.contains(cls.WORK_CELLS_CLASS) &&\n            !target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            target = selectedCells[selectedCells.length - 1];\n        }\n        if (selectedAppointments.length > 0) {\n            target = this.getWorkCellFromAppointmentElement(selectedAppointments[selectedAppointments.length - 1]);\n            this.parent.eventBase.removeSelectedAppointmentClass();\n            if (!target) {\n                return;\n            }\n        }\n        if (target.classList.contains(cls.WORK_CELLS_CLASS) &&\n            (e.target).classList.contains(cls.WORK_CELLS_CLASS)) {\n            var key = this.processLeftRight(target);\n            var targetDate = new Date(+target.getAttribute('data-date'));\n            var isMonthEnd = this.parent.currentView === 'Year' && targetDate.getTime() === util.lastDateOfMonth(targetDate).getTime();\n            if (key.columnIndex >= 0 && key.columnIndex < key.maxIndex - 1 && !isMonthEnd) {\n                targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex].cells[target.cellIndex + 1], 'right');\n                if (isTimelineYear && isMultiple && targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n                    targetCell = this.getTimelineYearTargetCell(key, target, true);\n                }\n                if (!isNullOrUndefined(targetCell)) {\n                    this.selectCells(isMultiple, targetCell);\n                }\n            }\n            else if (key.columnIndex === key.maxIndex - 1 || isMonthEnd) {\n                if (!this.isInverseTableSelect() && key.rowIndex < key.element.rows.length - 1 && !isMonthEnd) {\n                    targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex + 1].cells[0], 'right');\n                    var changeTargetCell = isTimelineYear && isMultiple && targetCell.classList.contains(cls.OTHERMONTH_CLASS);\n                    targetCell = changeTargetCell ? this.getHorizontalLeftRightCell(key, target, true) : targetCell;\n                    if (!isNullOrUndefined(targetCell)) {\n                        this.selectCells(isMultiple, targetCell);\n                    }\n                }\n                else if (!isMultiple) {\n                    if (isMonthEnd && targetDate.getTime() !== this.parent.activeView.getEndDate().getTime()) {\n                        this.selectCells(isMultiple, this.parent.element.querySelector(':not(.' + cls.OTHERMONTH_CLASS + ')[data-date=\"' + (targetDate.getTime() + util.MS_PER_DAY) + '\"]'));\n                        return;\n                    }\n                    var rowIndex = this.isInverseTableSelect() ? key.rowIndex : 0;\n                    this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Next'), e);\n                    var tableEle = this.parent.getContentTable();\n                    var cell = isMonthEnd ? tableEle.rows[parseInt(rowIndex.toString(), 10)].querySelector('.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')')\n                        : tableEle.rows[parseInt(rowIndex.toString(), 10)].cells[0];\n                    this.selectCells(false, cell);\n                }\n            }\n        }\n        else if (target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            var curColIndex = target.cellIndex;\n            var allDayRow = this.parent.getAllDayRow();\n            var maxColIndex = allDayRow.cells.length;\n            if (curColIndex >= 0 && curColIndex < maxColIndex - 1) {\n                this.selectCells(isMultiple, allDayRow.cells[curColIndex + 1]);\n            }\n            else if (curColIndex === maxColIndex - 1 && !isMultiple) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Next'), e);\n                var allDayRow_1 = this.parent.getAllDayRow();\n                this.selectCells(false, allDayRow_1.cells[0]);\n            }\n        }\n    };\n    KeyboardInteraction.prototype.processLeft = function (e, isMultiple) {\n        var isTimelineYear = this.parent.currentView === 'TimelineYear';\n        if (this.isCancelLeftRightAction(e, isMultiple, isTimelineYear) || (this.isCalendarTarget(e))) {\n            return;\n        }\n        var target = (e.target);\n        var selectedCells = this.parent.getSelectedCells();\n        var targetCell;\n        if (selectedCells.length > 0 && !target.classList.contains(cls.WORK_CELLS_CLASS) &&\n            !target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            target = selectedCells[selectedCells.length - 1];\n        }\n        var selectedElements = this.parent.eventBase.getSelectedAppointments();\n        if (selectedElements.length > 0) {\n            target = this.getWorkCellFromAppointmentElement(selectedElements[selectedElements.length - 1]);\n            this.parent.eventBase.removeSelectedAppointmentClass();\n            if (!target) {\n                return;\n            }\n        }\n        if ((e.target).classList.contains(cls.WORK_CELLS_CLASS) &&\n            target.classList.contains(cls.WORK_CELLS_CLASS)) {\n            var key = this.processLeftRight(target);\n            var targetDate = new Date(+target.getAttribute('data-date'));\n            var isMonthStart = this.parent.currentView === 'Year' && targetDate.getTime() === util.firstDateOfMonth(targetDate).getTime();\n            if (key.columnIndex > 0 && key.columnIndex < key.maxIndex && !isMonthStart) {\n                targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex].cells[target.cellIndex - 1], 'left');\n                if (isTimelineYear && isMultiple && targetCell.classList.contains(cls.OTHERMONTH_CLASS)) {\n                    targetCell = this.getTimelineYearTargetCell(key, target, false);\n                }\n                if (!isNullOrUndefined(targetCell)) {\n                    this.selectCells(isMultiple, targetCell);\n                }\n            }\n            else if (key.columnIndex === 0 || isMonthStart) {\n                if (!this.isInverseTableSelect() && key.rowIndex > 0) {\n                    targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex - 1].cells[key.maxIndex - 1], 'left');\n                    var otherMonthCell = isTimelineYear && isMultiple && targetCell.classList.contains(cls.OTHERMONTH_CLASS);\n                    targetCell = otherMonthCell ? this.getHorizontalLeftRightCell(key, target, false) : targetCell;\n                    if (!isNullOrUndefined(targetCell)) {\n                        this.selectCells(isMultiple, targetCell);\n                    }\n                }\n                else if (!isMultiple) {\n                    if (isMonthStart && targetDate.getTime() !== this.parent.activeView.getStartDate().getTime()) {\n                        this.selectCells(isMultiple, this.parent.element.querySelector('[data-date=\"' + (targetDate.getTime() - util.MS_PER_DAY) + '\"]'));\n                        return;\n                    }\n                    this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Previous'), e);\n                    var tableEle = this.parent.getContentTable();\n                    var rowIndex = this.isInverseTableSelect() ? key.rowIndex : tableEle.rows.length - 1;\n                    var cell = tableEle.rows[parseInt(rowIndex.toString(), 10)].cells[key.maxIndex - 1];\n                    if (isMonthStart) {\n                        var tbody = this.parent.element.querySelectorAll('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n                        cell = tbody.item(tbody.length - 1).querySelector(':not(.' + cls.OTHERMONTH_CLASS + ')[data-date=\"' + this.parent.activeView.getEndDate().getTime() + '\"]');\n                    }\n                    this.selectCells(false, cell);\n                }\n            }\n        }\n        else if (target.classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            var curColIndex = target.cellIndex;\n            var allDayRow = this.parent.getAllDayRow();\n            var maxColIndex = allDayRow.cells.length;\n            if (curColIndex > 0 && curColIndex < maxColIndex) {\n                this.selectCells(isMultiple, allDayRow.cells[curColIndex - 1]);\n            }\n            else if (curColIndex === 0 && !isMultiple) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('Previous'), e);\n                var allDayRow_2 = this.parent.getAllDayRow();\n                this.selectCells(false, allDayRow_2.cells[maxColIndex - 1]);\n            }\n        }\n    };\n    KeyboardInteraction.prototype.getTimelineYearTargetCell = function (key, target, isRight) {\n        return this.isInverseTableSelect() ? this.getVerticalLeftRightCell(target, isRight) :\n            this.getHorizontalLeftRightCell(key, target, isRight);\n    };\n    KeyboardInteraction.prototype.getHorizontalLeftRightCell = function (key, target, isRight) {\n        var row = key.element.rows[target.parentNode.sectionRowIndex + (isRight ? 1 : -1)];\n        if (row) {\n            var query = isRight ? '.' + cls.WORK_CELLS_CLASS + ':not(.' + cls.OTHERMONTH_CLASS + ')'\n                : '[data-date=\"' + ((+target.getAttribute('data-date')) - util.MS_PER_DAY) + '\"]';\n            return row.querySelector(query);\n        }\n        return target;\n    };\n    KeyboardInteraction.prototype.getVerticalLeftRightCell = function (target, isRight) {\n        var date = new Date(+target.getAttribute('data-date'));\n        var start = new Date(date.getFullYear(), date.getMonth() + (isRight ? 1 : -1), 1);\n        var tableEle = this.parent.getContentTable();\n        var targetCell = tableEle.querySelector('[data-date=\"' + start.getTime() + '\"]');\n        if (targetCell.parentNode.sectionRowIndex > target.parentNode.sectionRowIndex) {\n            return targetCell;\n        }\n        return tableEle.querySelector('[data-date=\"' + new Date(start.getFullYear(), start.getMonth() + 1, 0).getTime() + '\"]');\n    };\n    KeyboardInteraction.prototype.calculateNextPrevDate = function (currentCell, target, type) {\n        var initialId = this.initialTarget.getAttribute('data-group-index');\n        if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.currentView === 'Month') {\n            if (currentCell && target && target.getAttribute('data-group-index') !== initialId) {\n                var currentDate = this.parent.getDateFromElement(currentCell);\n                var nextPrevDate = (type === 'right') ? new Date(currentDate.setDate(currentDate.getDate() + 1))\n                    : new Date(currentDate.setDate(currentDate.getDate() - 1));\n                target = [].slice.call(this.parent.element.querySelectorAll('td[data-date=\"'\n                    + nextPrevDate.getTime().toString() + '\"]' + '[data-group-index=\"' + initialId + '\"]'))[0];\n            }\n        }\n        return target;\n    };\n    KeyboardInteraction.prototype.getFocusableElements = function (container) {\n        var queryString = 'a[href]:not([tabindex=\"-1\"]),input:not([disabled]):not([tabindex=\"-1\"]),' +\n            'textarea:not([disabled]):not([tabindex=\"-1\"]),button:not([disabled]):not([tabindex=\"-1\"]),' +\n            'select:not([disabled]):not([tabindex=\"-1\"]),[tabindex]:not([tabindex=\"-1\"]),[contentEditable=true]:not([tabindex=\"-1\"])';\n        return [].slice.call(container.querySelectorAll(queryString));\n    };\n    KeyboardInteraction.prototype.processTabOnPopup = function (e, popupElement) {\n        var _this = this;\n        var focusableElements = this.getFocusableElements(popupElement);\n        focusableElements = focusableElements.filter(function (element) {\n            var footerEle = _this.parent.element.querySelector('.' + cls.POPUP_FOOTER_CLASS);\n            if (footerEle && footerEle.offsetParent) {\n                return !(element.classList.contains(cls.EDIT_CLASS) || element.classList.contains(cls.DELETE_CLASS));\n            }\n            else {\n                return !(element.classList.contains(cls.EDIT_EVENT_CLASS) || element.classList.contains(cls.DELETE_EVENT_CLASS));\n            }\n        });\n        var firstEle = focusableElements[0];\n        var lastEle = focusableElements[focusableElements.length - 1];\n        if (!isNullOrUndefined(lastEle) && document.activeElement === lastEle && !e.shiftKey) {\n            e.preventDefault();\n            firstEle.focus();\n        }\n        if (!isNullOrUndefined(firstEle) && document.activeElement === firstEle && e.shiftKey) {\n            e.preventDefault();\n            lastEle.focus();\n        }\n    };\n    KeyboardInteraction.prototype.processTab = function (e, isReverse) {\n        var target = e.target;\n        if (target.classList.contains(cls.INLINE_SUBJECT_CLASS) && this.parent.inlineModule) {\n            target = target.closest('.e-appointment');\n            this.parent.inlineModule.inlineCrudActions(e.target);\n        }\n        if (this.parent.currentView === 'TimelineYear' && target.classList.contains(cls.OTHERMONTH_CLASS)) {\n            if (target.classList.contains(cls.SELECTED_CELL_CLASS)) {\n                this.parent.removeSelectedClass();\n            }\n            return;\n        }\n        var popupWrapper = closest(target, '.' + cls.POPUP_WRAPPER_CLASS + ',.' + cls.MORE_POPUP_WRAPPER_CLASS);\n        if (popupWrapper && popupWrapper.classList.contains(cls.POPUP_OPEN)) {\n            if (popupWrapper.classList.contains(cls.MORE_POPUP_WRAPPER_CLASS)) {\n                this.parent.eventBase.removeSelectedAppointmentClass();\n            }\n            this.processTabOnPopup(e, popupWrapper);\n            return;\n        }\n        if (target.classList.contains(cls.ROOT)) {\n            this.parent.eventBase.removeSelectedAppointmentClass();\n            return;\n        }\n        if (target.classList.contains(cls.RESOURCE_CELLS_CLASS) && this.parent.activeView.isTimelineView()\n            && this.parent.activeViewOptions.group.resources.length > 0) {\n            var index = parseInt(target.getAttribute('data-group-index'), 10);\n            var appSelector = \".\" + cls.APPOINTMENT_CLASS + \"[data-group-index=\\\"\" + (isReverse ? index - 1 : index) + \"\\\"]\";\n            var appElements = [].slice.call(this.parent.element.querySelectorAll(appSelector));\n            if (appElements.length > 0) {\n                this.parent.eventBase.removeSelectedAppointmentClass();\n                var focusAppointment = isReverse ? appElements.slice(-1)[0] : appElements[0];\n                this.parent.eventBase.addSelectedAppointments([focusAppointment], true);\n                focusAppointment.focus();\n                e.preventDefault();\n            }\n            else if (index + 1 === this.parent.resourceBase.lastResourceLevel.length) {\n                this.parent.element.focus();\n                e.preventDefault();\n            }\n            else if (this.parent.virtualScrollModule) {\n                var virtual = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n                var averageRowHeight = Math.round(virtual.offsetHeight / this.parent.resourceBase.expandedResources.length);\n                this.parent.element.querySelector('.e-content-wrap').scrollTop = ((isReverse ? index - 1 : index + 1) * averageRowHeight);\n                this.parent.virtualScrollModule.virtualScrolling();\n            }\n            else {\n                this.setScrollPosition(index);\n            }\n            return;\n        }\n        if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n            var appElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n            var isTimelineYear = this.parent.currentView === 'TimelineYear';\n            var isTimeline = this.parent.activeView.isTimelineView() && !isTimelineYear;\n            if ((isTimeline || isTimelineYear && this.parent.activeViewOptions.orientation === 'Vertical') && this.parent.activeViewOptions.group.resources.length > 0) {\n                var index = parseInt(target.getAttribute('data-group-index'), 10);\n                appElements = [].slice.call(this.parent.element.querySelectorAll(\".\" + cls.APPOINTMENT_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\"));\n                var resCellSelector = \".\" + cls.RESOURCE_CELLS_CLASS + \"[data-group-index=\\\"\" + (isReverse ? index : index + 1) + \"\\\"]\";\n                var resourceCell = this.parent.element.querySelector(resCellSelector);\n                if (resourceCell && (isReverse && target.getAttribute('data-guid') === appElements[0].getAttribute('data-guid') ||\n                    !isReverse && target.getAttribute('data-guid') === appElements.slice(-1)[0].getAttribute('data-guid'))) {\n                    this.parent.eventBase.removeSelectedAppointmentClass();\n                    if (this.parent.virtualScrollModule) {\n                        resourceCell.focus({ preventScroll: true });\n                    }\n                    else {\n                        resourceCell.focus();\n                    }\n                    if (this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0 &&\n                        isNullOrUndefined(this.parent.virtualScrollModule)) {\n                        this.setScrollPosition(index);\n                    }\n                    e.preventDefault();\n                    return;\n                }\n            }\n            var selectedAppointments = this.parent.eventBase.getSelectedAppointments();\n            if (selectedAppointments.length > 0) {\n                target = selectedAppointments[selectedAppointments.length - 1];\n            }\n            this.parent.eventBase.removeSelectedAppointmentClass();\n            if (!isReverse && target.getAttribute('data-guid') === appElements[appElements.length - 1].getAttribute('data-guid') ||\n                isReverse && target.getAttribute('data-guid') === appElements[0].getAttribute('data-guid')) {\n                return;\n            }\n            if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n                this.selectAppointment(isReverse, target);\n                e.preventDefault();\n            }\n            return;\n        }\n        var selectedCells = this.parent.getSelectedCells();\n        if (selectedCells.length > 0 && !target.classList.contains(cls.APPOINTMENT_CLASS)) {\n            target = selectedCells[selectedCells.length - 1];\n            this.selectAppointmentElementFromWorkCell(isReverse, target);\n            e.preventDefault();\n            return;\n        }\n        if (target && !target.classList.contains(cls.RESOURCE_CELLS_CLASS) && this.parent.activeView.isTimelineView()\n            && this.parent.activeViewOptions.group.resources.length > 0) {\n            this.processTabOnResourceCells(target, isReverse);\n        }\n    };\n    KeyboardInteraction.prototype.processDelete = function (e) {\n        var activeEle = document.activeElement;\n        if (this.parent.currentView === 'MonthAgenda') {\n            var selectedEle = this.parent.eventBase.getSelectedEvents().element;\n            activeEle = ((selectedEle && isNullOrUndefined(selectedEle.length)) ? selectedEle : selectedEle[0]);\n        }\n        if (activeEle && activeEle.classList.contains(cls.APPOINTMENT_CLASS)) {\n            addClass([activeEle], cls.APPOINTMENT_BORDER);\n            this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n            if (this.parent.activeViewOptions.readonly || activeEle.classList.contains(cls.READ_ONLY) ||\n                !this.parent.eventSettings.allowDeleting) {\n                return;\n            }\n            this.parent.quickPopup.deleteClick(e);\n        }\n    };\n    KeyboardInteraction.prototype.processCtrlShiftNavigationArrows = function (e) {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && document.activeElement.classList.contains(cls.APPOINTMENT_CLASS)) {\n            var groupIndex = parseInt(document.activeElement.getAttribute('data-group-index'), 10);\n            var index = (e.action === 'ctrlShiftLeftArrow' || e.action === 'ctrlShiftUpArrow') ? groupIndex - 1 : groupIndex + 1;\n            index = index < 0 ? 0 : index > this.parent.resourceBase.lastResourceLevel.length ?\n                this.parent.resourceBase.lastResourceLevel.length : index;\n            var eventEle = [];\n            while (eventEle.length === 0 && index >= 0 && index <= this.parent.resourceBase.lastResourceLevel.length) {\n                eventEle = [].slice.call(this.parent.element.querySelectorAll(\".\" + cls.APPOINTMENT_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\"));\n                index = (e.action === 'ctrlShiftLeftArrow' || e.action === 'ctrlShiftUpArrow') ? index - 1 : index + 1;\n            }\n            var nextAppEle = eventEle[0];\n            if (nextAppEle) {\n                this.parent.eventBase.removeSelectedAppointmentClass();\n                this.parent.eventBase.addSelectedAppointments([nextAppEle], true);\n                nextAppEle.focus();\n            }\n        }\n        else if (this.parent.activeViewOptions.group.resources.length > 0 &&\n            !document.activeElement.classList.contains(cls.APPOINTMENT_CLASS)) {\n            var index = this.parent.resourceBase.renderedResources[0].groupIndex;\n            var appSelector = \".\" + cls.APPOINTMENT_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\";\n            var appElements = [].slice.call(this.parent.element.querySelectorAll(appSelector));\n            if (appElements.length > 0) {\n                this.parent.eventBase.removeSelectedAppointmentClass();\n                var focusAppointment = appElements[0];\n                this.parent.eventBase.addSelectedAppointments([focusAppointment], true);\n                focusAppointment.focus();\n                e.preventDefault();\n            }\n        }\n    };\n    KeyboardInteraction.prototype.processEscape = function (event) {\n        this.parent.quickPopup.onClosePopup(event);\n        this.parent.quickPopup.morePopup.hide();\n        if (this.parent.headerModule) {\n            this.parent.headerModule.hideHeaderPopup();\n        }\n        if (this.parent.inlineModule) {\n            this.parent.inlineModule.removeInlineAppointmentElement();\n        }\n    };\n    KeyboardInteraction.prototype.isPreventAction = function (e) {\n        var target = closest(e.target, '.' + cls.RESOURCE_GROUP_CELLS_CLASS);\n        if (this.parent.activeView.isTimelineView() && !isNullOrUndefined(target)) {\n            return true;\n        }\n        return false;\n    };\n    KeyboardInteraction.prototype.processTabOnResourceCells = function (target, isReverse) {\n        var tabElements = [].slice.call(this.parent.element.querySelectorAll('[tabIndex=\"0\"]'));\n        var currentTabIndex = tabElements.indexOf(target);\n        var nextTabElement = !isReverse ? tabElements[currentTabIndex + 1] : tabElements[currentTabIndex - 1];\n        if (nextTabElement && nextTabElement.classList.contains(cls.RESOURCE_CELLS_CLASS)) {\n            var groupIndex = parseInt(nextTabElement.getAttribute('data-group-index'), 10);\n            if (this.parent.virtualScrollModule) {\n                var resColWrap_1 = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS);\n                var resCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.RESOURCE_CELLS_CLASS));\n                resCells.forEach(function (element) {\n                    if (element.getBoundingClientRect().top < resColWrap_1.getBoundingClientRect().top) {\n                        element.setAttribute('tabindex', '-1');\n                    }\n                });\n            }\n            else {\n                this.setScrollPosition(groupIndex);\n            }\n        }\n    };\n    KeyboardInteraction.prototype.setScrollPosition = function (index) {\n        var workCell = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\");\n        if (workCell) {\n            this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS).scrollTop = workCell.offsetTop;\n        }\n    };\n    KeyboardInteraction.prototype.createClipboardElement = function () {\n        if (!this.parent.allowClipboard) {\n            return;\n        }\n        this.clipBoardTextArea = this.parent.createElement('textarea', {\n            className: cls.CLIPBOARD_CLASS,\n            attrs: {\n                tabindex: '-1'\n            }\n        });\n        this.parent.element.appendChild(this.clipBoardTextArea);\n    };\n    KeyboardInteraction.prototype.setCopy = function (copiedEventData, e) {\n        var _this = this;\n        if (window.getSelection().toString() !== '') {\n            return;\n        }\n        this.clipBoardTextArea.value = '';\n        var eventDetails = { elements: [], eventDatas: [] };\n        if (copiedEventData) {\n            var filteredContent = this.filterReadOnlyEvent(copiedEventData);\n            eventDetails.eventDatas = filteredContent;\n        }\n        else {\n            if (!this.parent || !this.parent.eventBase) {\n                return;\n            }\n            var selectedEvents = this.parent.eventBase.getSelectedEvents();\n            selectedEvents.event = selectedEvents && selectedEvents.event ? Array.isArray(selectedEvents.event)\n                ? this.filterReadOnlyEvent(selectedEvents.event) :\n                this.filterReadOnlyEvent([selectedEvents.event]) : undefined;\n            if (selectedEvents.element && selectedEvents.event) {\n                eventDetails = {\n                    elements: selectedEvents.element,\n                    eventDatas: selectedEvents.event\n                };\n            }\n            else {\n                eventDetails.element = [e.target];\n                eventDetails.eventDatas = [this.parent.getEventDetails(e.target)];\n            }\n        }\n        this.clipBoardTextArea.value = JSON.stringify(eventDetails.eventDatas, undefined, 2);\n        if (!/ipad|ipod|iphone/i.test(Browser.userAgent)) {\n            this.clipBoardTextArea.select();\n        }\n        else {\n            this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n        }\n        if (!isNullOrUndefined(navigator.clipboard)) {\n            navigator.clipboard.writeText(this.clipBoardTextArea.value)\n                .then(function () {\n                _this.clipBoardTextArea.blur();\n                window.getSelection().removeAllRanges();\n                if (e) {\n                    var closestAppointment = e.target.closest('.' + cls.APPOINTMENT_CLASS);\n                    if (closestAppointment) {\n                        closestAppointment.focus();\n                    }\n                }\n            })\n                .catch(function (err) {\n                throw err;\n            });\n        }\n    };\n    KeyboardInteraction.prototype.filterReadOnlyEvent = function (args) {\n        var _this = this;\n        return args.filter(function (event) { return !event[_this.parent.eventFields.isReadonly]; });\n    };\n    KeyboardInteraction.prototype.processClipboardAction = function (isCut, copiedEventData, e) {\n        if (!this.parent.allowClipboard) {\n            return;\n        }\n        this.isCutAction = isCut;\n        this.isCutContentPasted = false;\n        this.parent.closeQuickInfoPopup();\n        this.setCopy(copiedEventData ? copiedEventData : undefined, e);\n    };\n    KeyboardInteraction.prototype.pasteHandler = function (clipboardEvent, targetElement) {\n        var _this = this;\n        if (!this.parent.allowClipboard || this.isCutContentPasted) {\n            return;\n        }\n        var target = this.parent.getSelectedCells().length > 0\n            ? this.parent.getSelectedCells()\n            : (targetElement ? [targetElement] : []);\n        if (target.length === 0 || this.parent.eventWindow.dialogObject.visible ||\n            this.parent.quickPopup.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n            return;\n        }\n        var clipboardData = clipboardEvent.clipboardData || clipboardEvent.event.clipboardData\n            || window.clipboardData;\n        var pastedData = clipboardData.getData('text');\n        if (pastedData === '[]' || pastedData === '') {\n            return;\n        }\n        var parsedData;\n        try {\n            parsedData = JSON.parse(pastedData);\n        }\n        catch (_a) {\n            parsedData = pastedData;\n        }\n        var args = { cancel: false, data: parsedData, element: target };\n        this.parent.trigger(event.beforePaste, args, function (pasteEventArgs) {\n            if (!pasteEventArgs.cancel) {\n                if (!Array.isArray(pasteEventArgs.data) || !pasteEventArgs.data.every(function (item) { return typeof item === 'object'; })) {\n                    _this.clipBoardTextArea.value = '';\n                    return;\n                }\n                _this.processPaste(pasteEventArgs.data, targetElement);\n                if (_this.isCutAction) {\n                    _this.isCutContentPasted = true;\n                }\n            }\n            else {\n                _this.parent.closeQuickInfoPopup();\n                return;\n            }\n        });\n    };\n    KeyboardInteraction.prototype.processPaste = function (data, targetElement) {\n        if (!this.parent || !this.parent.eventWindow || !this.parent.eventBase || !data || !data.length) {\n            return;\n        }\n        var target = this.getTargetElements(targetElement);\n        var cellDetails = this.parent.getCellDetails(target);\n        var eventDetails = {};\n        this.parent.eventWindow.convertToEventData(cellDetails, eventDetails);\n        var isAllDay = this.isAllDayEvent(target);\n        var resources = this.parent.getResourcesByIndex(cellDetails.groupIndex);\n        var processedData = this.processEventData(data, isAllDay, cellDetails, resources);\n        var selectedEventData = this.parent.eventBase.sortByDateTime(processedData);\n        var saveData = this.prepareEventData(selectedEventData, eventDetails);\n        removeClass(target, cls.SELECTED_CELL_CLASS);\n        if (saveData.length > 0) {\n            if (this.isCutAction) {\n                this.parent.saveEvent(saveData);\n            }\n            else {\n                this.parent.addEvent(saveData);\n            }\n        }\n    };\n    KeyboardInteraction.prototype.getTargetElements = function (targetElement) {\n        return this.parent.getSelectedCells().length > 0\n            ? this.parent.getSelectedCells()\n            : (targetElement ? [targetElement] : []);\n    };\n    KeyboardInteraction.prototype.isAllDayEvent = function (target) {\n        return !target.some(function (cell) { return cell.classList.contains(cls.WORK_CELLS_CLASS); });\n    };\n    KeyboardInteraction.prototype.processEventData = function (data, isAllDay, cellDetails, resources) {\n        var _this = this;\n        return data.map(function (item) {\n            var _a;\n            var processedItem = __assign({}, item, (_a = {}, _a[_this.parent.eventFields.startTime] = new Date(item[_this.parent.eventFields.startTime]), _a[_this.parent.eventFields.endTime] = new Date(item[_this.parent.eventFields.endTime]), _a[_this.parent.eventFields.recurrenceID] = null, _a[_this.parent.eventFields.isAllDay] = isAllDay, _a));\n            _this.adjustEventTime(processedItem, isAllDay, item.IsAllDay, cellDetails);\n            if (resources && resources.groupData) {\n                Object.assign(processedItem, resources.groupData);\n            }\n            return processedItem;\n        });\n    };\n    KeyboardInteraction.prototype.adjustEventTime = function (processedItem, isAllDay, itemIsAllDay, cellDetails) {\n        var isTimeScaleEnabled = this.parent.activeViewOptions.timeScale.enable;\n        if ((['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) !== -1) && isTimeScaleEnabled) {\n            if (isAllDay) {\n                processedItem[this.parent.eventFields.endTime] = new Date(processedItem[this.parent.eventFields.startTime]);\n                processedItem[this.parent.eventFields.endTime].setDate(processedItem[this.parent.eventFields.startTime].getDate() + 1);\n            }\n            else if (itemIsAllDay) {\n                processedItem[this.parent.eventFields.startTime] = new Date(processedItem[this.parent.eventFields.startTime]\n                    .setHours(0, 0, 0, 0));\n                processedItem[this.parent.eventFields.endTime] = new Date(processedItem[this.parent.eventFields.startTime].getTime() + (cellDetails.endTime.getTime() - cellDetails.startTime.getTime()));\n            }\n        }\n        else if (itemIsAllDay) {\n            processedItem[this.parent.eventFields.isAllDay] = true;\n            processedItem[this.parent.eventFields.startTime] = new Date(processedItem[this.parent.eventFields.startTime]\n                .setHours(0, 0, 0, 0));\n            processedItem[this.parent.eventFields.endTime] = new Date(processedItem[this.parent.eventFields.startTime].getTime() +\n                (processedItem[this.parent.eventFields.endTime].getTime() - processedItem[this.parent.eventFields.startTime].getTime()));\n        }\n    };\n    KeyboardInteraction.prototype.prepareEventData = function (selectedEventData, eventDetails) {\n        var _this = this;\n        var initialEventTime = new Date(selectedEventData[0][this.parent.eventFields.startTime]);\n        var uniqueId = this.parent.getEventMaxID();\n        return selectedEventData.map(function (events) {\n            var totalDuration = _this.calculateTotalDuration(events, eventDetails, initialEventTime);\n            var cloneDetails = _this.isCutAction ? events : __assign({}, events);\n            if (!events[_this.parent.eventFields.recurrenceRule]) {\n                cloneDetails[_this.parent.eventFields.startTime] =\n                    new Date(new Date(cloneDetails[_this.parent.eventFields.startTime]).setMilliseconds(totalDuration));\n                cloneDetails[_this.parent.eventFields.endTime] =\n                    new Date(new Date(cloneDetails[_this.parent.eventFields.endTime]).setMilliseconds(totalDuration));\n            }\n            if (!_this.isCutAction) {\n                cloneDetails[_this.parent.eventFields.id] = uniqueId++;\n            }\n            return cloneDetails;\n        });\n    };\n    KeyboardInteraction.prototype.calculateTotalDuration = function (events, eventDetails, initialEventTime) {\n        if ((['Month', 'TimelineMonth', 'TimelineYear'].indexOf(this.parent.currentView) !== -1) || !this.parent.activeViewOptions.timeScale.enable) {\n            var eventStartTime = new Date(events[this.parent.eventFields.startTime]);\n            return eventDetails[this.parent.eventFields.startTime].getTime() - initialEventTime.getTime() +\n                (eventStartTime.getHours() * 3600000 + eventStartTime.getMinutes() * 60000 + eventStartTime.getSeconds() * 1000);\n        }\n        else {\n            return eventDetails[this.parent.eventFields.startTime].getTime() - initialEventTime.getTime();\n        }\n    };\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name.\n     */\n    KeyboardInteraction.prototype.getModuleName = function () {\n        return 'keyboard';\n    };\n    /**\n     * To destroy the keyboard module.\n     *\n     * @returns {void}\n     * @private\n     */\n    KeyboardInteraction.prototype.destroy = function () {\n        this.removeEventListener();\n        this.selectedCells = [];\n        this.clipBoardTextArea = null;\n        this.keyboardModule.destroy();\n    };\n    return KeyboardInteraction;\n}());\nexport { KeyboardInteraction };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}