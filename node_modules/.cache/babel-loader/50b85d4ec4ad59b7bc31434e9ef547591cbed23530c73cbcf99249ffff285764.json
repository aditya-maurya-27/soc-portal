{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nvar DragAndDrop = /** @class */function (_super) {\n  __extends(DragAndDrop, _super);\n  function DragAndDrop() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.widthUptoCursorPoint = 0;\n    _this.heightUptoCursorPoint = 0;\n    _this.cursorPointIndex = 0;\n    _this.isHeaderRows = false;\n    _this.isTimelineDayProcess = false;\n    _this.widthPerMinute = 0;\n    _this.heightPerMinute = 0;\n    _this.minDiff = 0;\n    _this.isStepDragging = false;\n    _this.isMorePopupOpened = false;\n    _this.isAllDayDrag = false;\n    _this.isMultiSelect = false;\n    _this.multiData = [];\n    _this.updatedData = [];\n    _this.swagData = [];\n    _this.startTime = 0;\n    _this.isAllDayTarget = false;\n    _this.targetTd = null;\n    _this.isCursorAhead = false;\n    _this.enableCurrentViewDrag = false;\n    _this.isPreventMultiDrag = false;\n    _this.slotsUptoCursor = -1;\n    _this.eleTop = 0;\n    _this.distanceUptoCursor = 0;\n    return _this;\n  }\n  DragAndDrop.prototype.wireDragEvent = function (element) {\n    new Draggable(element, {\n      abort: '.' + cls.EVENT_RESIZE_CLASS,\n      clone: true,\n      isDragScroll: true,\n      enableTailMode: this.parent.eventDragArea ? true : false,\n      cursorAt: this.parent.eventDragArea ? {\n        left: -20,\n        top: -20\n      } : {\n        left: 0,\n        top: 0\n      },\n      dragArea: this.dragArea,\n      dragStart: this.dragStart.bind(this),\n      drag: this.drag.bind(this),\n      dragStop: this.dragStop.bind(this),\n      enableAutoScroll: false,\n      helper: this.dragHelper.bind(this),\n      queryPositionInfo: this.dragPosition.bind(this)\n    });\n  };\n  DragAndDrop.prototype.setDragArea = function () {\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n    this.dragArea = this.parent.eventDragArea && dragElement ? dragElement : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n  };\n  DragAndDrop.prototype.dragHelper = function (e) {\n    var _this = this;\n    if (e.sender && e.sender.type === 'touchmove' && (!this.parent.uiStateValues.isTapHold || !e.element.classList.contains(cls.APPOINTMENT_BORDER))) {\n      return null;\n    }\n    this.setDragActionDefaultValues();\n    this.actionObj.element = e.element;\n    if (e.sender && ['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) > -1) {\n      var eventArgs = this.parent.eventBase.getPageCoordinates(e.sender);\n      this.distanceUptoCursor = eventArgs.clientY - this.actionObj.element.getBoundingClientRect().top;\n      this.eleTop = parseFloat(this.actionObj.element.style.top);\n      this.slotsUptoCursor = -1;\n    }\n    this.actionObj.action = 'drag';\n    var elements = [];\n    if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 || this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1) {\n      elements = [e.element];\n    } else {\n      elements = this.parent.selectedElements;\n      this.isMultiSelect = true;\n    }\n    elements.forEach(function (ele) {\n      var cloneElement = _this.createCloneElement(ele);\n      if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n        _this.actionObj.clone = cloneElement;\n        if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' && _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() && !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n          setStyleAttribute(_this.actionObj.clone, {\n            cursor: 'move',\n            left: '0%',\n            right: '0%',\n            width: '100%'\n          });\n        }\n        _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n      }\n      _this.actionObj.cloneElement.push(cloneElement);\n      _this.actionObj.originalElement.push(ele);\n    });\n    return this.actionObj.clone;\n  };\n  DragAndDrop.prototype.dragPosition = function (e) {\n    if (this.parent.eventDragArea) {\n      return {\n        left: e.left,\n        top: e.top\n      };\n    }\n    var cellHeight = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    var leftValue = formatUnit(0);\n    if (this.parent.currentView === 'Month') {\n      leftValue = e.left;\n    }\n    var cloneRight;\n    if (this.isStepDragging) {\n      cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n    } else {\n      cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n    }\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl && this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n      this.isCursorAhead = true;\n    }\n    if (this.parent.activeView.isTimelineView()) {\n      leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n    }\n    var topValue;\n    if (this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable || !isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      topValue = formatUnit(this.actionObj.clone.offsetTop);\n    } else if (this.parent.currentView === 'Month') {\n      topValue = formatUnit(0);\n    } else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n      topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n        right: this.parent.enableRtl && formatUnit(0)\n      });\n    } else {\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        setStyleAttribute(this.actionObj.clone, {\n          height: formatUnit(this.actionObj.cellHeight),\n          width: formatUnit(this.actionObj.cellWidth - 1),\n          pointerEvents: 'none'\n        });\n      }\n      var top_1 = parseInt(e.top, 10);\n      top_1 = top_1 < 0 ? 0 : top_1;\n      if (this.slotsUptoCursor < 0) {\n        var cellsCountUptoCursor = Math.floor((this.eleTop + this.distanceUptoCursor) / cellHeight);\n        var cellsCountUptoEleTop = Math.floor(this.eleTop / cellHeight);\n        this.slotsUptoCursor = cellsCountUptoCursor - cellsCountUptoEleTop;\n      }\n      top_1 = (Math.floor((top_1 + this.distanceUptoCursor + 1) / cellHeight) - this.slotsUptoCursor) * cellHeight;\n      topValue = formatUnit(top_1 < 0 ? 0 : top_1);\n      var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n      var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n      if (cloneBottom > scrollHeight) {\n        topValue = parseInt(topValue, 10) - (cloneBottom - scrollHeight) + 'px';\n      }\n      if (this.isPreventMultiDrag) {\n        topValue = formatUnit(this.actionObj.clone.offsetTop);\n      }\n    }\n    return {\n      left: leftValue,\n      top: topValue\n    };\n  };\n  DragAndDrop.prototype.setDragActionDefaultValues = function () {\n    this.actionObj.action = 'drag';\n    this.actionObj.isAllDay = null;\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n    this.actionObj.cellWidth = workCell.offsetWidth;\n    this.actionObj.cellHeight = workCell.offsetHeight;\n  };\n  DragAndDrop.prototype.dragStart = function (e) {\n    var _this = this;\n    var eventGuid = this.actionObj.element.getAttribute('data-guid');\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    if (!isNullOrUndefined(eventObj)) {\n      this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n    }\n    if (!this.parent.allowMultiDrag) {\n      this.parent.eventBase.removeSelectedAppointmentClass();\n    }\n    var dragArgs = {\n      cancel: false,\n      data: eventObj,\n      selectedData: this.getSelectedData(),\n      event: e,\n      excludeSelectors: null,\n      element: this.actionObj.element,\n      interval: this.actionObj.interval,\n      navigation: {\n        enable: false,\n        timeDelay: 2000\n      },\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel || !isNullOrUndefined(_this.actionObj.element) && isNullOrUndefined(_this.actionObj.element.parentElement)) {\n        var dragObj = _this.actionObj.element.ej2_instances[0];\n        if (!isNullOrUndefined(dragObj)) {\n          dragObj.intDestroy(e.event);\n        }\n        _this.actionObj.action = '';\n        _this.removeCloneElementClasses();\n        _this.removeCloneElement();\n        return;\n      }\n      _this.actionClass('addClass');\n      _this.parent.uiStateValues.action = true;\n      _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n      _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n      _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      _this.actionObj.interval = dragEventArgs.interval;\n      _this.actionObj.navigation = dragEventArgs.navigation;\n      _this.actionObj.scroll = dragEventArgs.scroll;\n      _this.enableCurrentViewDrag = dragArgs.dragWithinRange && !dragArgs.navigation.enable && _this.parent.allowMultiDrag;\n      _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n      var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      _this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      _this.widthPerMinute = _this.actionObj.cellWidth / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.heightPerMinute = _this.actionObj.cellHeight / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.widthUptoCursorPoint = 0;\n      _this.heightUptoCursorPoint = 0;\n      _this.cursorPointIndex = -1;\n      _this.isHeaderRows = false;\n      _this.isTimelineDayProcess = false;\n      _this.minDiff = 0;\n      _this.isMorePopupOpened = false;\n      _this.daysVariation = -1;\n      _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n      if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n        if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) && _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n          _this.isMorePopupOpened = true;\n        }\n        _this.actionObj.pageX = e.event.pageX;\n        var rows = _this.parent.activeViewOptions.headerRows;\n        _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' && rows[rows.length - 1].option !== 'Date';\n        _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows || _this.parent.currentView === 'TimelineMonth' || rows.length > 0 && rows[rows.length - 1].option === 'Date';\n        _this.isAllDayDrag = !_this.isTimelineDayProcess && eventObj[_this.parent.eventFields.isAllDay];\n        _this.isStepDragging = !_this.isTimelineDayProcess && !_this.isAllDayDrag && _this.actionObj.slotInterval !== _this.actionObj.interval;\n        if (_this.isTimelineDayProcess) {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n        } else {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n        }\n      }\n      if (_this.parent.currentView === 'TimelineYear') {\n        _this.yearEvent = new YearEvent(_this.parent);\n      }\n      if (_this.parent.currentView === 'Month') {\n        _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n        _this.updateOriginalElement(_this.actionObj.clone);\n        _this.monthEvent = new MonthEvent(_this.parent);\n      }\n      if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n        _this.verticalEvent = new VerticalEvent(_this.parent);\n        _this.verticalEvent.initializeValues();\n        var splitEvents = _this.splitEvent(_this.actionObj.event);\n        splitEvents.forEach(function (event) {\n          var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n          if (_this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n          }\n          var appWrap = _this.parent.element.querySelector(query);\n          if (appWrap) {\n            var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n            if (appEle) {\n              addClass([appEle], cls.EVENT_ACTION_CLASS);\n            }\n          }\n        });\n      }\n    });\n  };\n  DragAndDrop.prototype.getSelectedData = function () {\n    if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n      for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n        var element = _a[_i];\n        var eventGuid = element.getAttribute('data-guid');\n        var data = this.parent.eventBase.getEventByGuid(eventGuid);\n        this.multiData.push(extend({}, data, null, true));\n      }\n    }\n    return this.multiData;\n  };\n  DragAndDrop.prototype.drag = function (e) {\n    if (e.event && e.event.type === 'touchmove') {\n      e.event.preventDefault();\n    }\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n    if (!isNullOrUndefined(e.target) && e.target.classList && e.target.classList.contains(cls.DISABLE_DATES)) {\n      return;\n    }\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventArgs = this.parent.eventBase.getPageCoordinates(e);\n    this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n    this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n    this.actionObj.target = e.target;\n    this.widthUptoCursorPoint = this.widthUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute) * this.widthPerMinute : this.widthUptoCursorPoint;\n    this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n    this.heightUptoCursorPoint = this.heightUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute) * this.heightPerMinute : this.heightUptoCursorPoint;\n    if (['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) > -1) {\n      this.isAllDayDrag = this.parent.activeViewOptions.timeScale.enable ? this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) : this.actionObj.event[this.parent.eventFields.isAllDay];\n    }\n    if (this.isStepDragging && this.minDiff === 0) {\n      this.calculateMinutesDiff(eventObj);\n    }\n    if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n      var date = this.parent.getDateFromElement(this.actionObj.target);\n      if (!isNullOrUndefined(date)) {\n        var currentDate = util.resetTime(date);\n        var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n        this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n      } else {\n        this.daysVariation = 0;\n      }\n    } else {\n      this.daysVariation = 0;\n    }\n    if (this.parent.eventDragArea) {\n      var targetElement = eventArgs.target;\n      this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n      this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n      var currentTarget = closest(targetElement, '.' + cls.ROOT);\n      if (!currentTarget) {\n        this.actionObj.clone.style.height = '';\n        this.actionObj.clone.style.width = '';\n      } else {\n        if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n          this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n        }\n      }\n    }\n    this.updateScrollPosition(e);\n    this.updateNavigatingPosition(e);\n    this.updateDraggingDateTime(e);\n    var dragArgs = {\n      data: eventObj,\n      event: e,\n      element: this.actionObj.element,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end,\n      selectedData: this.updatedData\n    };\n    if (this.parent.group.resources.length > 0) {\n      dragArgs.groupIndex = this.actionObj.groupIndex;\n    }\n    this.parent.trigger(events.drag, dragArgs);\n  };\n  DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n    if (this.parent.enableRtl) {\n      this.minDiff = (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute * this.actionObj.interval;\n    } else {\n      this.minDiff = this.widthUptoCursorPoint / this.widthPerMinute * this.actionObj.interval;\n    }\n    var startDate = eventObj[this.parent.eventFields.startTime];\n    var startTime = this.parent.activeView.renderDates[0];\n    var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n    if (startEndHours.startHour.getTime() > startDate.getTime()) {\n      this.minDiff = this.minDiff + (startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE;\n    }\n  };\n  DragAndDrop.prototype.dragStop = function (e) {\n    var _this = this;\n    this.isCursorAhead = false;\n    this.isPreventMultiDrag = false;\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    clearInterval(this.actionObj.navigationInterval);\n    this.actionObj.navigationInterval = null;\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = this.parent.uiStateValues.isTapHold = false;\n    if (this.isAllowDrop(e)) {\n      return;\n    }\n    var target = e.target.classList && !e.target.classList.contains('e-work-cells') && this.parent.cellTemplate ? closest(e.target, '.e-work-cells') : e.target;\n    var dragArgs = {\n      cancel: false,\n      data: this.getChangedData(this.updatedData),\n      selectedData: this.updatedData,\n      event: e,\n      element: this.actionObj.element,\n      target: target\n    };\n    this.actionObj.action = null;\n    this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel) {\n        return;\n      }\n      if (_this.parent.eventBase.checkOverlap(dragEventArgs.data)) {\n        return;\n      }\n      if (_this.parent.isSpecificResourceEvents()) {\n        _this.parent.crudModule.crudObj.isCrudAction = true;\n        _this.parent.crudModule.crudObj.sourceEvent = [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n        var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n        _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[parseInt(currentGroupIndex.toString(), 10)]];\n      }\n      _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n    });\n    this.updatedData = [];\n    this.multiData = [];\n    this.isMultiSelect = false;\n    this.parent.selectedElements = [];\n  };\n  DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n    var _this = this;\n    if (this.actionObj.navigation.enable) {\n      var currentDate_1 = this.parent.getCurrentTime();\n      if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n        this.actionObj.navigationInterval = window.setInterval(function () {\n          if (currentDate_1) {\n            var crtDate = _this.parent.getCurrentTime();\n            var end = crtDate.getSeconds();\n            var start = currentDate_1.getSeconds() + _this.actionObj.navigation.timeDelay / 1000;\n            start = start >= 60 ? start - 60 : start;\n            if (start === end) {\n              currentDate_1 = _this.parent.getCurrentTime();\n              _this.viewNavigation(e);\n              _this.updateDraggingDateTime(e);\n            }\n          }\n        }, this.actionObj.navigation.timeDelay);\n      }\n    }\n  };\n  DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n    if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      this.morePopupEventDragging(e);\n    } else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n      this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n      this.timelineEventModule.getSlotDates();\n      this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.parent.getElementWidth(this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS));\n      this.calculateTimelineTime(e);\n    } else {\n      if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n        this.calculateVerticalDate(e);\n      } else {\n        this.calculateVerticalTime(e);\n      }\n    }\n  };\n  DragAndDrop.prototype.navigationWrapper = function () {\n    if (!this.parent.activeView.isTimelineView()) {\n      if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n        var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        this.actionObj.index = this.parent.activeView.renderDates.length < this.actionObj.index ? this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n        var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!targetWrapper) {\n          targetWrapper = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n        }\n        targetWrapper.appendChild(this.actionObj.clone);\n      } else {\n        var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n        this.parent.element.querySelectorAll(wrapperClass).item(this.actionObj.index).appendChild(this.actionObj.clone);\n        if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n          var elementHeight = this.getAllDayEventHeight();\n          var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n          if (event_2[0].offsetHeight < elementHeight) {\n            for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n              var e = event_1[_i];\n              e.style.height = (elementHeight + 2) / 12 + 'em';\n            }\n          }\n          this.actionObj.clone.style.height = formatUnit(elementHeight);\n        }\n        this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n      }\n    } else {\n      var outWrapper = void 0;\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n      } else {\n        outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n      }\n      if (!isNullOrUndefined(outWrapper)) {\n        var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!tarWrapper_1) {\n          tarWrapper_1 = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outWrapper.appendChild(tarWrapper_1);\n        }\n        this.actionObj.cloneElement.forEach(function (ele) {\n          tarWrapper_1.appendChild(ele);\n        });\n      }\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  DragAndDrop.prototype.viewNavigation = function (e) {\n    var navigationType;\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    if (dragArea && (!this.scrollEdges.top && !this.scrollEdges.bottom || closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n      if (dragArea.scrollLeft === 0 && Math.round(this.actionObj.X) <= Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'Next' : 'Previous';\n      } else if (Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth && Math.round(this.actionObj.X) >= Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'Previous' : 'Next';\n      }\n      if (navigationType) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n      }\n    }\n  };\n  DragAndDrop.prototype.morePopupEventDragging = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'td'))) {\n      return;\n    }\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(e.target, 'td');\n    if (this.parent.currentView === 'TimelineYear' && (!td.classList.contains(cls.WORK_CELLS_CLASS) || td.classList.contains(cls.OTHERMONTH_CLASS))) {\n      return;\n    }\n    var dragStart = this.parent.getDateFromElement(td);\n    var dragEnd = new Date(dragStart.getTime());\n    dragEnd.setMilliseconds(eventDuration);\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n    this.actionObj.start = new Date(dragStart.getTime());\n    this.actionObj.end = new Date(dragEnd.getTime());\n    this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n    this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n    this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n    var eventContainer = td;\n    var eventWrapper;\n    if (this.parent.activeView.isTimelineView()) {\n      var rowIndex = closest(td, 'tr').rowIndex;\n      eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n    }\n    eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n    this.appendCloneElement(eventWrapper);\n  };\n  DragAndDrop.prototype.calculateVerticalTime = function (e) {\n    var _this = this;\n    if (isNullOrUndefined(this.actionObj.target) || this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr')) || !isNullOrUndefined(closest(this.actionObj.target, 'td')) && !closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) && !closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      return;\n    }\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.swapDragging(e);\n    }\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventStart = eventObj[this.parent.eventFields.startTime];\n    var eventEnd = eventObj[this.parent.eventFields.endTime];\n    var eventDuration = util.getUniversalTime(eventEnd) - util.getUniversalTime(eventStart);\n    var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n    offsetTop = offsetTop < 0 ? 0 : offsetTop;\n    if (this.scrollEdges.top || this.scrollEdges.bottom) {\n      offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint + this.actionObj.cellHeight + window.pageYOffset : dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset + (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n      offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n      if (dragArea.scrollTop > 0 && offsetTop < dragArea.scrollHeight) {\n        this.actionObj.clone.style.top = formatUnit(offsetTop);\n      }\n    }\n    var rowIndex = this.parent.activeViewOptions.timeScale.enable ? offsetTop / this.actionObj.cellHeight : 0;\n    var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n    var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n    var tr;\n    if (this.isAllDayDrag) {\n      tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n    } else {\n      var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      tr = trCollections[parseInt(rowIndex.toString(), 10)];\n    }\n    var index;\n    if (!isNullOrUndefined(closest(this.actionObj.target, 'td')) && (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) || closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS))) {\n      index = closest(this.actionObj.target, 'td').cellIndex;\n    }\n    var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n    this.actionObj.index = colIndex;\n    if (isNullOrUndefined(tr)) {\n      return;\n    }\n    var td = tr.children[parseInt(colIndex.toString(), 10)];\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n    var dragStart;\n    var dragEnd;\n    if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n      if (!this.enableCurrentViewDrag || this.multiData.length === 0) {\n        this.appendCloneElement(this.getEventWrapper(colIndex));\n      }\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setMinutes(dragStart.getMinutes() + diffInMinutes / heightPerMinute);\n      dragEnd = new Date(dragStart.getTime());\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n      } else {\n        dragEnd.setMilliseconds(eventDuration);\n      }\n    } else {\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setDate(dragStart.getDate() - this.daysVariation);\n      dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      dragEnd = new Date(dragStart.getTime());\n      dragEnd.setMilliseconds(eventDuration);\n      if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n      }\n      var index_1 = this.parent.activeViewOptions.group.byDate || this.parent.virtualScrollModule && !this.parent.activeViewOptions.timeScale.enable ? colIndex : undefined;\n      this.updateAllDayEvents(dragStart, dragEnd, index_1);\n    }\n    this.actionObj.start = new Date(+dragStart);\n    this.actionObj.end = new Date(+dragEnd);\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n    for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n      var wrapper = dynamicWrappers_1[_i];\n      remove(wrapper);\n    }\n    if (this.multiData.length > 0) {\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n        var targetCellTime_1 = parseInt(closest(this.actionObj.target, 'td').getAttribute('data-date'), 10);\n        this.multiData.forEach(function (data) {\n          _this.swagData.push(extend({}, data, null, true));\n          if (data[_this.parent.eventFields.isAllDay]) {\n            data[_this.parent.eventFields.startTime] = new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n            var startTime = new Date(data[_this.parent.eventFields.startTime]);\n            var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n            data[_this.parent.eventFields.endTime] = endTime;\n            data[_this.parent.eventFields.isAllDay] = false;\n          }\n        });\n        this.startTime = targetCellTime_1;\n      }\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n        this.multiData = this.swagData;\n        this.swagData = [];\n        var eventObj_1 = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n      }\n      var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n      if (this.enableCurrentViewDrag) {\n        var renderDates = this.getRenderedDates();\n        for (var i = 0; i < this.multiData.length; i++) {\n          var eventObj_2 = extend({}, this.multiData[parseInt(i.toString(), 10)], null, true);\n          var startTime = new Date(eventObj_2[this.parent.eventFields.startTime].getTime() + startTimeDiff);\n          var dayIndex = this.parent.getIndexOfDate(renderDates, util.resetTime(startTime));\n          if (dayIndex < 0) {\n            this.isPreventMultiDrag = true;\n            break;\n          }\n          this.isPreventMultiDrag = false;\n        }\n      }\n      if (!this.isPreventMultiDrag) {\n        for (var index_2 = 0; index_2 < this.multiData.length; index_2++) {\n          this.updatedData[parseInt(index_2.toString(), 10)] = this.updateMultipleData(this.multiData[parseInt(index_2.toString(), 10)], startTimeDiff);\n          var dayIndex = this.getDayIndex(this.updatedData[parseInt(index_2.toString(), 10)]);\n          if (dayIndex >= 0) {\n            var isAllDay = this.updatedData[parseInt(index_2.toString(), 10)][this.parent.eventFields.isAllDay];\n            var wrapper = this.getEventWrapper(dayIndex, isAllDay);\n            this.appendCloneElement(wrapper, this.actionObj.cloneElement[parseInt(index_2.toString(), 10)]);\n            this.updateEventHeight(this.updatedData[parseInt(index_2.toString(), 10)], index_2, dayIndex);\n          } else {\n            if (!isNullOrUndefined(this.actionObj.cloneElement[parseInt(index_2.toString(), 10)].parentNode)) {\n              remove(this.actionObj.cloneElement[parseInt(index_2.toString(), 10)]);\n            }\n          }\n        }\n      }\n    } else {\n      this.updateEventHeight(event);\n    }\n    this.updateTimePosition(this.actionObj.start, this.updatedData);\n  };\n  DragAndDrop.prototype.splitEvent = function (event) {\n    var eventFields = this.parent.eventFields;\n    var eventData = [];\n    var startTime = event[eventFields.startTime];\n    var endTime = event[eventFields.endTime];\n    if (util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()))) {\n      var startReferenceDate = util.resetTime(new Date(startTime.getTime()));\n      var endReferenceDate = new Date(startReferenceDate.getTime());\n      for (var i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n        endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        var eventObj = extend({}, event, null, true);\n        eventObj[eventFields.startTime] = new Date(startReferenceDate);\n        eventObj[eventFields.endTime] = new Date(endReferenceDate);\n        startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        eventData.push(eventObj);\n      }\n      var index = eventData.length - 1;\n      eventData[0][eventFields.startTime] = startTime;\n      eventData[parseInt(index.toString(), 10)][eventFields.endTime] = endTime;\n    } else {\n      eventData.push(event);\n    }\n    return eventData;\n  };\n  DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable && (this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay] || !this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay])) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n    var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    if (eventObj[this.parent.eventFields.isAllDay]) {\n      var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n      var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n      var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n      eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n      eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n    } else {\n      eventObj[this.parent.eventFields.startTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n      eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n    }\n    return eventObj;\n  };\n  DragAndDrop.prototype.getDayIndex = function (event) {\n    var eventObj = extend({}, event, null, true);\n    var startDate = util.resetTime(eventObj[this.parent.eventFields.startTime]);\n    if (this.parent.activeViewOptions.timeScale.enable && !eventObj[this.parent.eventFields.isAllDay]) {\n      var startHour = this.parent.activeView.getStartHour();\n      startDate.setMilliseconds(startHour.getTime() - util.resetTime(startHour).getTime());\n    }\n    var startTime = startDate.getTime();\n    var query = '';\n    var wrapper = cls.DAY_WRAPPER_CLASS;\n    if (this.parent.activeViewOptions.timeScale.enable && eventObj[this.parent.eventFields.isAllDay]) {\n      wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n    } else {\n      wrapper = cls.WORK_CELLS_CLASS;\n    }\n    query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n    this.targetTd = this.parent.element.querySelector(query);\n    if (isNullOrUndefined(this.targetTd)) {\n      return -1;\n    }\n    return this.targetTd.cellIndex;\n  };\n  DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n    this.verticalEvent.initializeValues();\n    var datesCount = this.verticalEvent.getStartCount();\n    if (!this.parent.uiStateValues.isGroupAdaptive) {\n      for (var i = 0; i < this.actionObj.groupIndex; i++) {\n        if (this.verticalEvent.dateRender[parseInt(i.toString(), 10)]) {\n          datesCount = datesCount + this.verticalEvent.dateRender[parseInt(i.toString(), 10)].length;\n        }\n      }\n    }\n    var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n    var target = this.parent.activeViewOptions.group.byDate && !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)) ? true : false;\n    if (target || !this.parent.activeViewOptions.group.byDate) {\n      var dynamicIndex = -1;\n      var dayIndex = !this.parent.activeViewOptions.group.byDate ? isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount : this.parent.getIndexOfDate(this.verticalEvent.dateRender[parseInt(indexGroup.toString(), 10)], util.resetTime(\n      // eslint-disable-next-line max-len\n      this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n      var splitEvents = this.splitEvent(event);\n      var events_1 = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 || this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n      for (var i = 0; i < events_1.length; i++) {\n        if (i > 0) {\n          var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[parseInt(i.toString(), 10)][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n          if (this.parent.activeViewOptions.group.resources.length > 0) {\n            filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n          }\n          var appWrap = this.parent.element.querySelector(filterQuery);\n          if (appWrap) {\n            dayIndex = dayIndex + 1;\n            dynamicIndex = appWrap.cellIndex;\n          } else {\n            dayIndex = -1;\n          }\n        }\n        if (dayIndex >= 0) {\n          var record = this.verticalEvent.isSpannedEvent(events_1[parseInt(i.toString(), 10)], dayIndex, indexGroup);\n          var eStart = record[this.verticalEvent.fields.startTime];\n          var eEnd = record[this.verticalEvent.fields.endTime];\n          var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) : this.actionObj.element.offsetHeight;\n          var topValue = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getTopValue(eStart) : this.actionObj.element.offsetTop;\n          if (isNullOrUndefined(index)) {\n            if (i === 0) {\n              this.actionObj.clone.style.top = formatUnit(topValue);\n              this.actionObj.clone.style.height = formatUnit(appHeight);\n            } else {\n              this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n            }\n          } else {\n            var appWidth = this.actionObj.cellWidth;\n            if (event[this.parent.eventFields.isAllDay]) {\n              topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n              appHeight = this.getAllDayEventHeight();\n              var timeDiff = event[this.parent.eventFields.endTime].getTime() - event[this.parent.eventFields.startTime].getTime();\n              var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n              if (allDayDifference >= 0) {\n                appWidth = allDayDifference * this.actionObj.cellWidth;\n              }\n            }\n            if (this.actionObj.cloneElement[parseInt(index.toString(), 10)]) {\n              if (i === 0) {\n                this.actionObj.cloneElement[parseInt(index.toString(), 10)].style.top = formatUnit(topValue);\n                this.actionObj.cloneElement[parseInt(index.toString(), 10)].style.height = formatUnit(appHeight);\n                this.actionObj.cloneElement[parseInt(index.toString(), 10)].style.width = formatUnit(appWidth);\n                this.actionObj.cloneElement[parseInt(index.toString(), 10)].style.left = formatUnit(0);\n              } else {\n                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n  DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n    var startTime = record[this.parent.eventFields.startTime].getTime();\n    var endTime = record[this.parent.eventFields.endTime].getTime();\n    if (startTime !== endTime) {\n      var appointmentElement = this.verticalEvent.createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n      addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n      setStyleAttribute(appointmentElement, {\n        'width': '100%',\n        'height': height + 'px',\n        'top': top + 'px',\n        'border': '0px'\n      });\n      var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n      appointmentWrap[parseInt(index.toString(), 10)].appendChild(appointmentElement);\n    }\n  };\n  DragAndDrop.prototype.getRenderedDates = function () {\n    var _this = this;\n    var _a, _b;\n    var renderDates = this.parent.activeView.renderDates;\n    (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) {\n      return +date;\n    }));\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.eventBase.slots = [];\n      var resources = this.parent.resourceBase.lastResourceLevel.filter(function (res) {\n        return res.groupIndex === _this.actionObj.groupIndex;\n      });\n      renderDates = resources[0].renderDates;\n      (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) {\n        return +date;\n      }));\n    }\n    return renderDates;\n  };\n  DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n    this.parent.eventBase.slots = [];\n    var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n    var renderDates = this.getRenderedDates();\n    var events = this.parent.eventBase.splitEvent(event, renderDates);\n    var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n    }\n    var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n    if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n      var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n      this.appendCloneElement(this.getEventWrapper(cellIndex));\n      // eslint-disable-next-line max-len\n      this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  DragAndDrop.prototype.swapDragging = function (e) {\n    if (this.isPreventMultiDrag) {\n      return;\n    }\n    var colIndex = !isNullOrUndefined(closest(this.actionObj.target, 'td')) && closest(this.actionObj.target, 'td').cellIndex;\n    if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) && !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n      addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = true;\n      var eventHeight = this.getAllDayEventHeight();\n      var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n      if (allDayElement[0].offsetHeight < eventHeight) {\n        for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n          var element = allDayElement_1[_i];\n          element.style.height = (eventHeight + 2) / 12 + 'em';\n        }\n      }\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(this.actionObj.cellWidth),\n        height: formatUnit(eventHeight),\n        top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n      });\n    }\n    if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) && !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n      removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = false;\n      // eslint-disable-next-line max-len\n      var height = this.actionObj.element.offsetHeight === 0 ? this.actionObj.height : this.actionObj.element.offsetHeight;\n      setStyleAttribute(this.actionObj.clone, {\n        left: formatUnit(0),\n        height: formatUnit(height),\n        width: formatUnit(this.actionObj.cellWidth)\n      });\n    }\n  };\n  DragAndDrop.prototype.calculateVerticalDate = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'tr')) || e.target && e.target.tagName === 'DIV') {\n      return;\n    }\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    if (isNullOrUndefined(this.parent.eventDragArea)) {\n      this.removeCloneElement();\n    }\n    var eventDuration = util.getUniversalTime(eventObj[this.parent.eventFields.endTime]) - util.getUniversalTime(eventObj[this.parent.eventFields.startTime]);\n    var td = closest(this.actionObj.target, 'td');\n    if (!isNullOrUndefined(td)) {\n      var tr = td.parentElement;\n      this.actionObj.index = tr.rowIndex * tr.children.length + td.cellIndex;\n      var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n      td = workCells[this.actionObj.index];\n      var currentDate = this.parent.getDateFromElement(td);\n      if (!isNullOrUndefined(currentDate)) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n        var dragStart = new Date(timeString.getTime());\n        var startTimeDiff = util.getUniversalTime(eventObj[this.parent.eventFields.startTime]) - util.getUniversalTime(util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime])));\n        dragStart.setMilliseconds(startTimeDiff);\n        var dragEnd = new Date(dragStart.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n      }\n    }\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    if (isNullOrUndefined(this.parent.eventDragArea)) {\n      var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n      for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n        var wrapper = eventWrappers_1[_i];\n        remove(wrapper);\n      }\n    }\n    if (this.multiData && this.multiData.length > 0) {\n      var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n      var startTimeDiff = startTime.getTime() - this.startTime;\n      if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n        startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n        startTimeDiff -= new Date(this.startTime).getMonth();\n        startTimeDiff += startTime.getMonth();\n      }\n      for (var index = 0; index < this.multiData.length; index++) {\n        this.updatedData[parseInt(index.toString(), 10)] = this.updateMultipleVerticalDate(this.multiData[parseInt(index.toString(), 10)], startTimeDiff);\n        if (this.parent.currentView === 'TimelineYear') {\n          this.dynamicYearlyEventsRendering(this.updatedData[parseInt(index.toString(), 10)]);\n        } else {\n          this.dynamicEventsRendering(this.updatedData[parseInt(index.toString(), 10)]);\n        }\n      }\n    } else {\n      if (this.parent.currentView === 'TimelineYear') {\n        this.dynamicYearlyEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n    }\n  };\n  DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n    if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n    } else {\n      var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n    }\n    eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n    return eventObj;\n  };\n  DragAndDrop.prototype.calculateTimelineTime = function (e) {\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = util.getUniversalTime(eventObj[this.parent.eventFields.endTime]) - util.getUniversalTime(eventObj[this.parent.eventFields.startTime]);\n    var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth : parseInt(this.actionObj.clone.style.left, 10);\n    offsetLeft = Math.round(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    var rightOffset;\n    if (this.parent.enableRtl) {\n      rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n      this.actionObj.clone.style.right = formatUnit(rightOffset);\n    }\n    offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n    var colIndex = this.getColumnIndex(offsetLeft);\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n    var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl && this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n    var leftVal = this.parent.eventDragArea ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n    if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n      this.isCursorAhead = true;\n    }\n    var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n    if (this.parent.enableRtl) {\n      cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) / this.actionObj.cellWidth)) - 1;\n    }\n    if (this.cursorPointIndex < 0) {\n      this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n    }\n    var tr = this.parent.getContentTable().querySelector('tr');\n    var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n    index = index < 0 ? 0 : index;\n    var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[parseInt(index.toString(), 10)].getTime()) : this.parent.getDateFromElement(tr.children[parseInt(index.toString(), 10)]);\n    eventStart = this.isAllDayDrag ? util.resetTime(eventStart) : eventStart;\n    if (this.isStepDragging) {\n      var widthDiff = this.getWidthDiff(tr, index);\n      if (widthDiff !== 0) {\n        var timeDiff = Math.ceil(widthDiff / this.widthPerMinute);\n        eventStart.setMinutes(eventStart.getMinutes() + timeDiff * this.actionObj.interval);\n        if (this.isCursorAhead || cursorDrag) {\n          eventStart.setMilliseconds(-eventDuration);\n        } else {\n          eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n          var intervalInMS = this.actionObj.interval * util.MS_PER_MINUTE;\n          timeDiff = Math.abs(eventStart.getTime() - this.actionObj.start.getTime()) / intervalInMS;\n          var roundTimeDiff = Math.trunc(timeDiff);\n          if (roundTimeDiff !== timeDiff) {\n            timeDiff = roundTimeDiff * intervalInMS * (eventStart > this.actionObj.start ? 1 : -1);\n            eventStart = new Date(this.actionObj.start.getTime() + timeDiff);\n          }\n        }\n      } else {\n        eventStart = this.actionObj.start;\n      }\n    } else {\n      if ((this.isCursorAhead || cursorDrag) && !this.isAllDayDrag) {\n        var minutes = this.isTimelineDayProcess || this.isAllDayDrag ? MINUTES_PER_DAY : this.actionObj.slotInterval;\n        eventStart.setMinutes(eventStart.getMinutes() + minutes);\n        eventStart.setMilliseconds(-eventDuration);\n        if (eventStart.getTime() === util.resetTime(eventStart).getTime() && eventStart.getMinutes() === 0 && eventDuration === 0) {\n          eventStart.setMinutes(-minutes);\n        }\n      } else {\n        eventStart.setMinutes(eventStart.getMinutes() - this.cursorPointIndex * (this.isTimelineDayProcess || this.isAllDayDrag ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n      }\n    }\n    if (!this.isStepDragging) {\n      eventStart = this.calculateIntervalTime(eventStart);\n    }\n    if (this.isTimelineDayProcess || this.isAllDayDrag) {\n      var eventSrt = eventObj[this.parent.eventFields.startTime];\n      eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n    }\n    if (this.parent.eventDragArea) {\n      var targetDate = this.parent.getDateFromElement(e.target);\n      if (!isNullOrUndefined(targetDate)) {\n        if (!this.parent.activeViewOptions.timeScale.enable || this.parent.currentView === 'TimelineMonth') {\n          var eventSrt = eventObj[this.parent.eventFields.startTime];\n          eventStart = new Date(targetDate.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n        } else {\n          eventStart = targetDate;\n        }\n      }\n    }\n    var eventEnd = new Date(eventStart.getTime());\n    eventEnd.setMilliseconds(eventDuration);\n    var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n    if (this.multiData.length > 0) {\n      var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n      for (var i = 0; i < this.multiData.length; i++) {\n        this.updatedData[parseInt(i.toString(), 10)] = this.updateMultipleData(this.multiData[parseInt(i.toString(), 10)], startTimeDiff);\n      }\n      eventsData = this.updatedData;\n    }\n    for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n      var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[parseInt(dataIndex.toString(), 10)] : this.actionObj.clone;\n      if (isNullOrUndefined(this.parent.eventDragArea)) {\n        var events_2 = this.timelineEventModule.splitEvent(eventsData[parseInt(dataIndex.toString(), 10)], this.timelineEventModule.dateRender);\n        var eventData = events_2[0].data;\n        var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n        var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData);\n        // eslint-disable-next-line max-len\n        var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n        // eslint-disable-next-line max-len\n        var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n        day = day < 0 ? 0 : day;\n        var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n        if (this.parent.enableRtl) {\n          cloneElement.style.right = formatUnit(left);\n        } else {\n          cloneElement.style.left = formatUnit(left);\n        }\n        if (!this.isMorePopupOpened) {\n          cloneElement.style.width = formatUnit(width);\n        }\n      }\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.calculateResourceGroupingPosition(e, cloneElement);\n      }\n      this.actionObj.start = new Date(eventStart.getTime());\n      this.actionObj.end = new Date(eventEnd.getTime());\n      this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n  };\n  DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n    if (this.scrollEdges.left || this.scrollEdges.right) {\n      var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      if (this.parent.enableRtl) {\n        rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n        if (this.scrollEdges.right) {\n          rightOffset = rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth - (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        } else {\n          rightOffset = rightOffset + this.widthUptoCursorPoint;\n          if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n            this.actionObj.clone.style.width = formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n            rightOffset = viewEle.scrollLeft - viewEle.scrollWidth;\n          }\n        }\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n          this.actionObj.clone.style.left = formatUnit(rightOffset);\n        }\n      } else {\n        if (this.scrollEdges.left) {\n          offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n          if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n            viewEle.scrollLeft = viewEle.scrollLeft - 1;\n          } else if (this.actionObj.clone.offsetLeft === 0) {\n            offsetLeft = viewEle.scrollLeft;\n          }\n        } else {\n          offsetLeft = viewEle.scrollLeft + viewEle.offsetWidth - this.actionObj.clone.offsetWidth + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        }\n        offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n          this.actionObj.clone.style.left = formatUnit(offsetLeft);\n        }\n      }\n    }\n    return offsetLeft;\n  };\n  DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n    var pages = this.scrollArgs.element.getBoundingClientRect();\n    if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n      var targetLeft = tr.children[parseInt(index.toString(), 10)].offsetLeft;\n      var pageX = this.actionObj.pageX - pages.left;\n      if (this.parent.enableRtl) {\n        return targetLeft + this.actionObj.cellWidth - (this.scrollArgs.element.scrollLeft + pageX);\n      } else {\n        return this.scrollArgs.element.scrollLeft + pageX - targetLeft;\n      }\n    }\n    return 0;\n  };\n  DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n    var index = Math.round(offsetLeft / this.actionObj.cellWidth);\n    if (this.isHeaderRows) {\n      return index;\n    }\n    return this.getIndex(index);\n  };\n  DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n    var index = colIndex + cloneIndex;\n    if (this.isHeaderRows) {\n      var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n      return index > dateLength - 1 ? dateLength - 1 : index;\n    }\n    return index > tr.children.length - 1 ? tr.children.length - 1 : index;\n  };\n  DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n    var td = closest(e.target, '.e-work-cells');\n    if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n      var targetDate = this.parent.getDateFromElement(td);\n      targetDate = this.isAllDayDrag ? util.resetTime(targetDate) : targetDate;\n      if (this.isHeaderRows) {\n        var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n        targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n      }\n      var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n      if (this.isTimelineDayProcess || this.isAllDayDrag) {\n        this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / util.MS_PER_DAY));\n      } else {\n        var widthDiff = Math.floor(timeDiff / util.MS_PER_MINUTE / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n        this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n        this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n      }\n    } else {\n      this.cursorPointIndex = 0;\n    }\n  };\n  DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n    var translateY = util.getTranslateY(dragArea.querySelector('table'));\n    translateY = isNullOrUndefined(translateY) ? 0 : translateY;\n    var rowHeight = this.parent.rowAutoHeight ? ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n    var rowIndex = Math.floor(Math.floor(this.actionObj.Y + (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset)) - util.getElementTop(dragArea, this.parent.uiStateValues.isTransformed)) / rowHeight);\n    rowIndex = rowIndex < 0 ? 0 : rowIndex > trCollection.length - 1 ? trCollection.length - 1 : rowIndex;\n    this.actionObj.index = rowIndex;\n    var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n    var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n    this.appendCloneElement(eventWrapper, cloneElement);\n    var td = closest(this.actionObj.target, 'td');\n    this.actionObj.groupIndex = td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)) ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n    if (!isNullOrUndefined(this.parent.eventDragArea)) {\n      return;\n    }\n    var top = this.parent.getElementHeight(trCollection[parseInt(rowIndex.toString(), 10)]) * rowIndex;\n    if (this.parent.rowAutoHeight) {\n      var cursorElement = this.getCursorElement(e);\n      if (cursorElement) {\n        top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop : cursorElement.offsetParent && cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ? cursorElement.offsetParent.offsetTop : top;\n      }\n    }\n    cloneElement.style.top = formatUnit(top);\n  };\n  DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n    if (cloneElement === void 0) {\n      cloneElement = null;\n    }\n    cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n    if (this.parent.eventDragArea && dragElement) {\n      dragElement.appendChild(cloneElement);\n    } else {\n      element.appendChild(cloneElement);\n    }\n  };\n  DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n    var eventWrapper;\n    if (isNullOrUndefined(isAllDayDrag)) {\n      isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n    }\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n      eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n    } else {\n      var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n      eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n      if (!eventWrapper) {\n        eventWrapper = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        targetWrapper.appendChild(eventWrapper);\n      }\n    }\n    return eventWrapper;\n  };\n  DragAndDrop.prototype.getAllDayEventHeight = function () {\n    var eventWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS\n    });\n    this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n    var eventHeight = eventWrapper.offsetHeight;\n    remove(eventWrapper);\n    return eventHeight;\n  };\n  DragAndDrop.prototype.isAllowDrop = function (e) {\n    if (!this.actionObj.excludeSelectors) {\n      return false;\n    }\n    var dropSelectors = this.actionObj.excludeSelectors.split(',');\n    var isAllowDrop = false;\n    for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n      var selector = dropSelectors_1[_i];\n      if (e.target.classList.contains(selector)) {\n        isAllowDrop = true;\n        break;\n      }\n    }\n    return isAllowDrop;\n  };\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name\n   */\n  DragAndDrop.prototype.getModuleName = function () {\n    return 'dragAndDrop';\n  };\n  return DragAndDrop;\n}(ActionBase);\nexport { DragAndDrop };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createElement","closest","Draggable","extend","formatUnit","isNullOrUndefined","addClass","remove","removeClass","setStyleAttribute","ActionBase","MonthEvent","TimelineEvent","YearEvent","VerticalEvent","cls","events","util","MINUTES_PER_DAY","DragAndDrop","_super","_this","apply","arguments","widthUptoCursorPoint","heightUptoCursorPoint","cursorPointIndex","isHeaderRows","isTimelineDayProcess","widthPerMinute","heightPerMinute","minDiff","isStepDragging","isMorePopupOpened","isAllDayDrag","isMultiSelect","multiData","updatedData","swagData","startTime","isAllDayTarget","targetTd","isCursorAhead","enableCurrentViewDrag","isPreventMultiDrag","slotsUptoCursor","eleTop","distanceUptoCursor","wireDragEvent","element","abort","EVENT_RESIZE_CLASS","clone","isDragScroll","enableTailMode","parent","eventDragArea","cursorAt","left","top","dragArea","dragStart","bind","drag","dragStop","enableAutoScroll","helper","dragHelper","queryPositionInfo","dragPosition","setDragArea","dragElement","document","querySelector","CONTENT_TABLE_CLASS","e","sender","type","uiStateValues","isTapHold","classList","contains","APPOINTMENT_BORDER","setDragActionDefaultValues","actionObj","indexOf","currentView","eventArgs","eventBase","getPageCoordinates","clientY","getBoundingClientRect","parseFloat","style","action","elements","allowMultiDrag","selectedElements","length","forEach","ele","cloneElement","createCloneElement","getAttribute","activeViewOptions","timeScale","enable","activeView","isTimelineView","ALLDAY_APPOINTMENT_CLASS","cursor","right","width","offsetTop","push","originalElement","cellHeight","slotInterval","interval","leftValue","cloneRight","Math","ceil","CONTENT_WRAP_CLASS","contentWrapRight","enableRtl","pageX","offsetLeft","topValue","offsetParent","MORE_EVENT_POPUP_CLASS","ALLDAY_ROW_CLASS","offsetWidth","cellWidth","height","pointerEvents","top_1","parseInt","cellsCountUptoCursor","floor","cellsCountUptoEleTop","scrollHeight","cloneBottom","offsetHeight","isAllDay","slotCount","workCell","WORK_CELLS_CLASS","eventGuid","event","getEventByGuid","eventObj","eventFields","getTime","removeSelectedAppointmentClass","dragArgs","cancel","data","selectedData","getSelectedData","excludeSelectors","navigation","timeDelay","scroll","scrollBy","trigger","dragEventArgs","parentElement","dragObj","ej2_instances","intDestroy","removeCloneElementClasses","removeCloneElement","actionClass","start","end","endTime","groupIndex","dragWithinRange","viewElement","scrollArgs","scrollWidth","daysVariation","rows","headerRows","option","timelineEventModule","yearEvent","resetTime","Date","updateOriginalElement","monthEvent","verticalEvent","initializeValues","splitEvents","splitEvent","query","group","resources","concat","appWrap","appEle","EVENT_ACTION_CLASS","_i","_a","preventDefault","quickPopup","quickPopupHide","target","DISABLE_DATES","Y","pageY","X","abs","calculateMinutesDiff","date","getDateFromElement","currentDate","startDate","MS_PER_DAY","targetElement","currentTarget","ROOT","updateScrollPosition","updateNavigatingPosition","updateDraggingDateTime","renderDates","startEndHours","getStartEndHours","getStartHour","getEndHour","startHour","MS_PER_MINUTE","clearInterval","navigationInterval","scrollInterval","isAllowDrop","cellTemplate","getChangedData","checkOverlap","isSpecificResourceEvents","crudModule","crudObj","isCrudAction","sourceEvent","resourceBase","lastResourceLevel","currentGroupIndex","targetEvent","toString","saveChangedData","currentDate_1","getCurrentTime","window","setInterval","crtDate","getSeconds","viewNavigation","morePopupEventDragging","dateRender","getSlotDates","getElementWidth","calculateTimelineTime","calculateVerticalDate","calculateVerticalTime","navigationWrapper","outerWrapperCls","slice","call","querySelectorAll","index","targetWrapper","APPOINTMENT_WRAPPER_CLASS","className","appendChild","wrapperClass","ALLDAY_APPOINTMENT_WRAPPER_CLASS","item","elementHeight","getAllDayEventHeight","event_2","ALLDAY_CELLS_CLASS","event_1","outWrapper","APPOINTMENT_CONTAINER_CLASS","tarWrapper_1","navigationType","scrollEdges","bottom","scrollLeft","round","pageXOffset","clientWidth","changeDate","getNextPreviousDate","eventDuration","td","OTHERMONTH_CLASS","dragEnd","setMilliseconds","eventContainer","eventWrapper","rowIndex","appendCloneElement","swapDragging","eventStart","eventEnd","getUniversalTime","scrollTop","pageYOffset","diffInMinutes","tr","trCollections","getContentTable","cellIndex","colIndex","children","isGroupAdaptive","getEventWrapper","setMinutes","getMinutes","setDate","getDate","setHours","getHours","addDays","index_1","byDate","virtualScrollModule","undefined","updateAllDayEvents","getUpdatedEvent","dynamicWrappers","dynamicWrappers_1","wrapper","targetCellTime_1","eventObj_1","startTimeDiff","getRenderedDates","i","eventObj_2","dayIndex","getIndexOfDate","index_2","updateMultipleData","getDayIndex","updateEventHeight","parentNode","updateTimePosition","eventData","startReferenceDate","endReferenceDate","timeDifference","endTimeDiff","differInDays","day","DAY_WRAPPER_CLASS","datesCount","getStartCount","indexGroup","dynamicIndex","events_1","isAllDayAppointment","eventSettings","spannedEventPlacement","filterQuery","record","isSpannedEvent","eStart","fields","eEnd","appHeight","getHeight","getTopValue","renderSpannedEvents","appWidth","timeDiff","allDayDifference","appointmentElement","createAppointmentElement","isSpanned","CLONE_ELEMENT_CLASS","appointmentWrap","_b","slots","map","filter","res","endDate","cell","count","DATE_HEADER_WRAP_CLASS","eventHeight","allDayElement","allDayElement_1","tagName","workCells","timeString","eventWrappers","eventWrappers_1","getFullYear","getMonth","updateMultipleVerticalDate","dynamicYearlyEventsRendering","dynamicEventsRendering","setMonth","rightOffset","getOffsetValue","getColumnIndex","cursorDrag","leftVal","cloneIndex","cursorIndex","getCursorCurrentIndex","widthDiff","getWidthDiff","intervalInMS","roundTimeDiff","trunc","minutes","calculateIntervalTime","eventSrt","targetDate","eventsData","dataIndex","events_2","getStartTime","getEndTime","getEventWidth","getPosition","calculateResourceGroupingPosition","viewEle","pages","targetLeft","getIndex","dateLength","currentIndex","trCollection","translateY","getTranslateY","rowHeight","rowAutoHeight","scrollY","getElementTop","isTransformed","isNaN","getElementHeight","cursorElement","getCursorElement","APPOINTMENT_CLASS","dropSelectors","split","dropSelectors_1","selector","getModuleName"],"sources":["C:/Users/Dell/OneDrive/Desktop/Programs/soc-portal/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/drag.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nvar DragAndDrop = /** @class */ (function (_super) {\n    __extends(DragAndDrop, _super);\n    function DragAndDrop() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.widthUptoCursorPoint = 0;\n        _this.heightUptoCursorPoint = 0;\n        _this.cursorPointIndex = 0;\n        _this.isHeaderRows = false;\n        _this.isTimelineDayProcess = false;\n        _this.widthPerMinute = 0;\n        _this.heightPerMinute = 0;\n        _this.minDiff = 0;\n        _this.isStepDragging = false;\n        _this.isMorePopupOpened = false;\n        _this.isAllDayDrag = false;\n        _this.isMultiSelect = false;\n        _this.multiData = [];\n        _this.updatedData = [];\n        _this.swagData = [];\n        _this.startTime = 0;\n        _this.isAllDayTarget = false;\n        _this.targetTd = null;\n        _this.isCursorAhead = false;\n        _this.enableCurrentViewDrag = false;\n        _this.isPreventMultiDrag = false;\n        _this.slotsUptoCursor = -1;\n        _this.eleTop = 0;\n        _this.distanceUptoCursor = 0;\n        return _this;\n    }\n    DragAndDrop.prototype.wireDragEvent = function (element) {\n        new Draggable(element, {\n            abort: '.' + cls.EVENT_RESIZE_CLASS,\n            clone: true,\n            isDragScroll: true,\n            enableTailMode: this.parent.eventDragArea ? true : false,\n            cursorAt: (this.parent.eventDragArea) ? { left: -20, top: -20 } : { left: 0, top: 0 },\n            dragArea: this.dragArea,\n            dragStart: this.dragStart.bind(this),\n            drag: this.drag.bind(this),\n            dragStop: this.dragStop.bind(this),\n            enableAutoScroll: false,\n            helper: this.dragHelper.bind(this),\n            queryPositionInfo: this.dragPosition.bind(this)\n        });\n    };\n    DragAndDrop.prototype.setDragArea = function () {\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        this.dragArea = this.parent.eventDragArea && dragElement ? dragElement :\n            this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n    };\n    DragAndDrop.prototype.dragHelper = function (e) {\n        var _this = this;\n        if (e.sender && e.sender.type === 'touchmove' && (!this.parent.uiStateValues.isTapHold ||\n            !e.element.classList.contains(cls.APPOINTMENT_BORDER))) {\n            return null;\n        }\n        this.setDragActionDefaultValues();\n        this.actionObj.element = e.element;\n        if (e.sender && ['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) > -1) {\n            var eventArgs = this.parent.eventBase.getPageCoordinates(e.sender);\n            this.distanceUptoCursor = eventArgs.clientY - this.actionObj.element.getBoundingClientRect().top;\n            this.eleTop = parseFloat(this.actionObj.element.style.top);\n            this.slotsUptoCursor = -1;\n        }\n        this.actionObj.action = 'drag';\n        var elements = [];\n        if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 ||\n            (this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1)) {\n            elements = [e.element];\n        }\n        else {\n            elements = this.parent.selectedElements;\n            this.isMultiSelect = true;\n        }\n        elements.forEach(function (ele) {\n            var cloneElement = _this.createCloneElement(ele);\n            if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n                _this.actionObj.clone = cloneElement;\n                if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' &&\n                    _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() &&\n                    !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                    setStyleAttribute(_this.actionObj.clone, { cursor: 'move', left: '0%', right: '0%', width: '100%' });\n                }\n                _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n            }\n            _this.actionObj.cloneElement.push(cloneElement);\n            _this.actionObj.originalElement.push(ele);\n        });\n        return this.actionObj.clone;\n    };\n    DragAndDrop.prototype.dragPosition = function (e) {\n        if (this.parent.eventDragArea) {\n            return { left: e.left, top: e.top };\n        }\n        var cellHeight = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n        var leftValue = formatUnit(0);\n        if (this.parent.currentView === 'Month') {\n            leftValue = e.left;\n        }\n        var cloneRight;\n        if (this.isStepDragging) {\n            cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n        }\n        else {\n            cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl &&\n            this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n            this.isCursorAhead = true;\n        }\n        if (this.parent.activeView.isTimelineView()) {\n            leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n        }\n        var topValue;\n        if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable ||\n            (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n                this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)))) {\n            topValue = formatUnit(this.actionObj.clone.offsetTop);\n        }\n        else if (this.parent.currentView === 'Month') {\n            topValue = formatUnit(0);\n        }\n        else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n            topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n                right: this.parent.enableRtl && formatUnit(0)\n            });\n        }\n        else {\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                setStyleAttribute(this.actionObj.clone, {\n                    height: formatUnit(this.actionObj.cellHeight),\n                    width: formatUnit(this.actionObj.cellWidth - 1),\n                    pointerEvents: 'none'\n                });\n            }\n            var top_1 = parseInt(e.top, 10);\n            top_1 = top_1 < 0 ? 0 : top_1;\n            if (this.slotsUptoCursor < 0) {\n                var cellsCountUptoCursor = Math.floor((this.eleTop + this.distanceUptoCursor) / cellHeight);\n                var cellsCountUptoEleTop = Math.floor(this.eleTop / cellHeight);\n                this.slotsUptoCursor = cellsCountUptoCursor - cellsCountUptoEleTop;\n            }\n            top_1 = (Math.floor((top_1 + this.distanceUptoCursor + 1) / cellHeight) - this.slotsUptoCursor) * cellHeight;\n            topValue = formatUnit(top_1 < 0 ? 0 : top_1);\n            var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n            var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n            if (cloneBottom > scrollHeight) {\n                topValue = (parseInt(topValue, 10) - (cloneBottom - scrollHeight)) + 'px';\n            }\n            if (this.isPreventMultiDrag) {\n                topValue = formatUnit(this.actionObj.clone.offsetTop);\n            }\n        }\n        return { left: leftValue, top: topValue };\n    };\n    DragAndDrop.prototype.setDragActionDefaultValues = function () {\n        this.actionObj.action = 'drag';\n        this.actionObj.isAllDay = null;\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n        this.actionObj.interval = this.actionObj.slotInterval;\n        var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n        this.actionObj.cellWidth = workCell.offsetWidth;\n        this.actionObj.cellHeight = workCell.offsetHeight;\n    };\n    DragAndDrop.prototype.dragStart = function (e) {\n        var _this = this;\n        var eventGuid = this.actionObj.element.getAttribute('data-guid');\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        if (!isNullOrUndefined(eventObj)) {\n            this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n        }\n        if (!this.parent.allowMultiDrag) {\n            this.parent.eventBase.removeSelectedAppointmentClass();\n        }\n        var dragArgs = {\n            cancel: false,\n            data: eventObj,\n            selectedData: this.getSelectedData(),\n            event: e,\n            excludeSelectors: null,\n            element: this.actionObj.element,\n            interval: this.actionObj.interval,\n            navigation: { enable: false, timeDelay: 2000 },\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\n        };\n        this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel || (!isNullOrUndefined(_this.actionObj.element) &&\n                isNullOrUndefined(_this.actionObj.element.parentElement))) {\n                var dragObj = _this.actionObj.element.ej2_instances[0];\n                if (!isNullOrUndefined(dragObj)) {\n                    dragObj.intDestroy(e.event);\n                }\n                _this.actionObj.action = '';\n                _this.removeCloneElementClasses();\n                _this.removeCloneElement();\n                return;\n            }\n            _this.actionClass('addClass');\n            _this.parent.uiStateValues.action = true;\n            _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n            _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n            _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n            _this.actionObj.interval = dragEventArgs.interval;\n            _this.actionObj.navigation = dragEventArgs.navigation;\n            _this.actionObj.scroll = dragEventArgs.scroll;\n            _this.enableCurrentViewDrag = dragArgs.dragWithinRange && !dragArgs.navigation.enable && _this.parent.allowMultiDrag;\n            _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n            var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            _this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\n            _this.widthPerMinute = (_this.actionObj.cellWidth / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.heightPerMinute = (_this.actionObj.cellHeight / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.widthUptoCursorPoint = 0;\n            _this.heightUptoCursorPoint = 0;\n            _this.cursorPointIndex = -1;\n            _this.isHeaderRows = false;\n            _this.isTimelineDayProcess = false;\n            _this.minDiff = 0;\n            _this.isMorePopupOpened = false;\n            _this.daysVariation = -1;\n            _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n            if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n                if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) &&\n                    _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n                    _this.isMorePopupOpened = true;\n                }\n                _this.actionObj.pageX = e.event.pageX;\n                var rows = _this.parent.activeViewOptions.headerRows;\n                _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' &&\n                    rows[rows.length - 1].option !== 'Date';\n                _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows ||\n                    _this.parent.currentView === 'TimelineMonth' || (rows.length > 0 && rows[rows.length - 1].option === 'Date');\n                _this.isAllDayDrag = !_this.isTimelineDayProcess && eventObj[_this.parent.eventFields.isAllDay];\n                _this.isStepDragging = !_this.isTimelineDayProcess && !_this.isAllDayDrag &&\n                    (_this.actionObj.slotInterval !== _this.actionObj.interval);\n                if (_this.isTimelineDayProcess) {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n                }\n                else {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n                }\n            }\n            if (_this.parent.currentView === 'TimelineYear') {\n                _this.yearEvent = new YearEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Month') {\n                _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n                _this.updateOriginalElement(_this.actionObj.clone);\n                _this.monthEvent = new MonthEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n                _this.verticalEvent = new VerticalEvent(_this.parent);\n                _this.verticalEvent.initializeValues();\n                var splitEvents = _this.splitEvent(_this.actionObj.event);\n                splitEvents.forEach(function (event) {\n                    var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n                    if (_this.parent.activeViewOptions.group.resources.length > 0) {\n                        query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n                    }\n                    var appWrap = _this.parent.element.querySelector(query);\n                    if (appWrap) {\n                        var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n                        if (appEle) {\n                            addClass([appEle], cls.EVENT_ACTION_CLASS);\n                        }\n                    }\n                });\n            }\n        });\n    };\n    DragAndDrop.prototype.getSelectedData = function () {\n        if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n            for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n                var element = _a[_i];\n                var eventGuid = element.getAttribute('data-guid');\n                var data = this.parent.eventBase.getEventByGuid(eventGuid);\n                this.multiData.push(extend({}, data, null, true));\n            }\n        }\n        return this.multiData;\n    };\n    DragAndDrop.prototype.drag = function (e) {\n        if (e.event && e.event.type === 'touchmove') {\n            e.event.preventDefault();\n        }\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if ((!isNullOrUndefined(e.target)) && e.target.classList &&\n            e.target.classList.contains(cls.DISABLE_DATES)) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventArgs = this.parent.eventBase.getPageCoordinates(e);\n        this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n        this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n        this.actionObj.target = e.target;\n        this.widthUptoCursorPoint = (this.widthUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute)) *\n                this.widthPerMinute : this.widthUptoCursorPoint;\n        this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n        this.heightUptoCursorPoint = (this.heightUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute)) *\n                this.heightPerMinute : this.heightUptoCursorPoint;\n        if (['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) > -1) {\n            this.isAllDayDrag = (this.parent.activeViewOptions.timeScale.enable) ?\n                this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) :\n                this.actionObj.event[this.parent.eventFields.isAllDay];\n        }\n        if (this.isStepDragging && this.minDiff === 0) {\n            this.calculateMinutesDiff(eventObj);\n        }\n        if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n            var date = this.parent.getDateFromElement(this.actionObj.target);\n            if (!isNullOrUndefined(date)) {\n                var currentDate = util.resetTime(date);\n                var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n                this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n            }\n            else {\n                this.daysVariation = 0;\n            }\n        }\n        else {\n            this.daysVariation = 0;\n        }\n        if (this.parent.eventDragArea) {\n            var targetElement = eventArgs.target;\n            this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n            this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n            var currentTarget = closest(targetElement, '.' + cls.ROOT);\n            if (!currentTarget) {\n                this.actionObj.clone.style.height = '';\n                this.actionObj.clone.style.width = '';\n            }\n            else {\n                if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n                    this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n                }\n            }\n        }\n        this.updateScrollPosition(e);\n        this.updateNavigatingPosition(e);\n        this.updateDraggingDateTime(e);\n        var dragArgs = {\n            data: eventObj, event: e, element: this.actionObj.element, startTime: this.actionObj.start,\n            endTime: this.actionObj.end, selectedData: this.updatedData\n        };\n        if (this.parent.group.resources.length > 0) {\n            dragArgs.groupIndex = this.actionObj.groupIndex;\n        }\n        this.parent.trigger(events.drag, dragArgs);\n    };\n    DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n        if (this.parent.enableRtl) {\n            this.minDiff =\n                ((this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute) * this.actionObj.interval;\n        }\n        else {\n            this.minDiff = (this.widthUptoCursorPoint / this.widthPerMinute) * this.actionObj.interval;\n        }\n        var startDate = eventObj[this.parent.eventFields.startTime];\n        var startTime = this.parent.activeView.renderDates[0];\n        var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        if (startEndHours.startHour.getTime() > startDate.getTime()) {\n            this.minDiff = this.minDiff + ((startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE);\n        }\n    };\n    DragAndDrop.prototype.dragStop = function (e) {\n        var _this = this;\n        this.isCursorAhead = false;\n        this.isPreventMultiDrag = false;\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        clearInterval(this.actionObj.navigationInterval);\n        this.actionObj.navigationInterval = null;\n        clearInterval(this.actionObj.scrollInterval);\n        this.actionObj.scrollInterval = null;\n        this.actionClass('removeClass');\n        this.parent.uiStateValues.action = this.parent.uiStateValues.isTapHold = false;\n        if (this.isAllowDrop(e)) {\n            return;\n        }\n        var target = (e.target.classList && (!e.target.classList.contains('e-work-cells') && this.parent.cellTemplate) ?\n            closest(e.target, '.e-work-cells') : e.target);\n        var dragArgs = {\n            cancel: false, data: this.getChangedData(this.updatedData), selectedData: this.updatedData,\n            event: e, element: this.actionObj.element, target: target\n        };\n        this.actionObj.action = null;\n        this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel) {\n                return;\n            }\n            if (_this.parent.eventBase.checkOverlap(dragEventArgs.data)) {\n                return;\n            }\n            if (_this.parent.isSpecificResourceEvents()) {\n                _this.parent.crudModule.crudObj.isCrudAction = true;\n                _this.parent.crudModule.crudObj.sourceEvent =\n                    [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n                var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n                _this.parent.crudModule.crudObj.targetEvent =\n                    [_this.parent.resourceBase.lastResourceLevel[parseInt(currentGroupIndex.toString(), 10)]];\n            }\n            _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n        });\n        this.updatedData = [];\n        this.multiData = [];\n        this.isMultiSelect = false;\n        this.parent.selectedElements = [];\n    };\n    DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n        var _this = this;\n        if (this.actionObj.navigation.enable) {\n            var currentDate_1 = this.parent.getCurrentTime();\n            if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n                this.actionObj.navigationInterval = window.setInterval(function () {\n                    if (currentDate_1) {\n                        var crtDate = _this.parent.getCurrentTime();\n                        var end = crtDate.getSeconds();\n                        var start = currentDate_1.getSeconds() + (_this.actionObj.navigation.timeDelay / 1000);\n                        start = (start >= 60) ? start - 60 : start;\n                        if (start === end) {\n                            currentDate_1 = _this.parent.getCurrentTime();\n                            _this.viewNavigation(e);\n                            _this.updateDraggingDateTime(e);\n                        }\n                    }\n                }, this.actionObj.navigation.timeDelay);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n            this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n            this.morePopupEventDragging(e);\n        }\n        else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n            this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n            this.timelineEventModule.getSlotDates();\n            this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth :\n                this.parent.getElementWidth(this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS));\n            this.calculateTimelineTime(e);\n        }\n        else {\n            if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n                this.calculateVerticalDate(e);\n            }\n            else {\n                this.calculateVerticalTime(e);\n            }\n        }\n    };\n    DragAndDrop.prototype.navigationWrapper = function () {\n        if (!this.parent.activeView.isTimelineView()) {\n            if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n                var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n                this.actionObj.index = (this.parent.activeView.renderDates.length < this.actionObj.index) ?\n                    this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n                var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!targetWrapper) {\n                    targetWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n                }\n                targetWrapper.appendChild(this.actionObj.clone);\n            }\n            else {\n                var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ?\n                    '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n                this.parent.element.querySelectorAll(wrapperClass)\n                    .item(this.actionObj.index).appendChild(this.actionObj.clone);\n                if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n                    var elementHeight = this.getAllDayEventHeight();\n                    var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n                    if (event_2[0].offsetHeight < elementHeight) {\n                        for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n                            var e = event_1[_i];\n                            e.style.height = ((elementHeight + 2) / 12) + 'em';\n                        }\n                    }\n                    this.actionObj.clone.style.height = formatUnit(elementHeight);\n                }\n                this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n            }\n        }\n        else {\n            var outWrapper = void 0;\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n            }\n            else {\n                outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n            }\n            if (!isNullOrUndefined(outWrapper)) {\n                var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!tarWrapper_1) {\n                    tarWrapper_1 = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outWrapper.appendChild(tarWrapper_1);\n                }\n                this.actionObj.cloneElement.forEach(function (ele) {\n                    tarWrapper_1.appendChild(ele);\n                });\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.viewNavigation = function (e) {\n        var navigationType;\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (dragArea && ((!this.scrollEdges.top && !this.scrollEdges.bottom) ||\n            closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n            if ((dragArea.scrollLeft === 0) &&\n                (Math.round(this.actionObj.X) <=\n                    Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'Next' : 'Previous';\n            }\n            else if ((Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth) &&\n                (Math.round(this.actionObj.X) >=\n                    Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'Previous' : 'Next';\n            }\n            if (navigationType) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n            }\n        }\n    };\n    DragAndDrop.prototype.morePopupEventDragging = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'td')))) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(e.target, 'td');\n        if (this.parent.currentView === 'TimelineYear' && (!td.classList.contains(cls.WORK_CELLS_CLASS) || td.classList.contains(cls.OTHERMONTH_CLASS))) {\n            return;\n        }\n        var dragStart = this.parent.getDateFromElement(td);\n        var dragEnd = new Date(dragStart.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n        this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n        this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n        this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n        var eventContainer = td;\n        var eventWrapper;\n        if (this.parent.activeView.isTimelineView()) {\n            var rowIndex = closest(td, 'tr').rowIndex;\n            eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n        }\n        eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper);\n    };\n    DragAndDrop.prototype.calculateVerticalTime = function (e) {\n        var _this = this;\n        if (isNullOrUndefined(this.actionObj.target) ||\n            (this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr'))) ||\n            (!isNullOrUndefined(closest(this.actionObj.target, 'td')) && !(closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS)) &&\n                !(closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)))) {\n            return;\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            this.swapDragging(e);\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventStart = eventObj[this.parent.eventFields.startTime];\n        var eventEnd = eventObj[this.parent.eventFields.endTime];\n        var eventDuration = util.getUniversalTime(eventEnd) - util.getUniversalTime(eventStart);\n        var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight)\n            * this.actionObj.cellHeight;\n        offsetTop = offsetTop < 0 ? 0 : offsetTop;\n        if (this.scrollEdges.top || this.scrollEdges.bottom) {\n            offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint +\n                this.actionObj.cellHeight + window.pageYOffset :\n                (dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset) +\n                    (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n            offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n            if (dragArea.scrollTop > 0 && offsetTop < dragArea.scrollHeight) {\n                this.actionObj.clone.style.top = formatUnit(offsetTop);\n            }\n        }\n        var rowIndex = (this.parent.activeViewOptions.timeScale.enable) ? (offsetTop / this.actionObj.cellHeight) : 0;\n        var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n        var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n        var tr;\n        if (this.isAllDayDrag) {\n            tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n        }\n        else {\n            var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n            tr = trCollections[parseInt(rowIndex.toString(), 10)];\n        }\n        var index;\n        if (!isNullOrUndefined(closest(this.actionObj.target, 'td')) && (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) ||\n            closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS))) {\n            index = closest(this.actionObj.target, 'td').cellIndex;\n        }\n        var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n        this.actionObj.index = colIndex;\n        if (isNullOrUndefined(tr)) {\n            return;\n        }\n        var td = tr.children[parseInt(colIndex.toString(), 10)];\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        var dragStart;\n        var dragEnd;\n        if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n            if (!this.enableCurrentViewDrag || this.multiData.length === 0) {\n                this.appendCloneElement(this.getEventWrapper(colIndex));\n            }\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setMinutes(dragStart.getMinutes() + (diffInMinutes / heightPerMinute));\n            dragEnd = new Date(dragStart.getTime());\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n            }\n            else {\n                dragEnd.setMilliseconds(eventDuration);\n            }\n        }\n        else {\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setDate(dragStart.getDate() - this.daysVariation);\n            dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n            dragEnd = new Date(dragStart.getTime());\n            dragEnd.setMilliseconds(eventDuration);\n            if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n            }\n            var index_1 = this.parent.activeViewOptions.group.byDate || (this.parent.virtualScrollModule &&\n                !this.parent.activeViewOptions.timeScale.enable) ? colIndex : undefined;\n            this.updateAllDayEvents(dragStart, dragEnd, index_1);\n        }\n        this.actionObj.start = new Date(+dragStart);\n        this.actionObj.end = new Date(+dragEnd);\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n        for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n            var wrapper = dynamicWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData.length > 0) {\n            if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n                var targetCellTime_1 = parseInt((closest(this.actionObj.target, 'td')).getAttribute('data-date'), 10);\n                this.multiData.forEach(function (data) {\n                    _this.swagData.push(extend({}, data, null, true));\n                    if (data[_this.parent.eventFields.isAllDay]) {\n                        data[_this.parent.eventFields.startTime] =\n                            new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n                        var startTime = new Date(data[_this.parent.eventFields.startTime]);\n                        var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n                        data[_this.parent.eventFields.endTime] = endTime;\n                        data[_this.parent.eventFields.isAllDay] = false;\n                    }\n                });\n                this.startTime = targetCellTime_1;\n            }\n            if (this.isAllDayTarget && this.isAllDayDrag &&\n                !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n                this.multiData = this.swagData;\n                this.swagData = [];\n                var eventObj_1 = extend({}, this.actionObj.event, null, true);\n                this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n            }\n            var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n            if (this.enableCurrentViewDrag) {\n                var renderDates = this.getRenderedDates();\n                for (var i = 0; i < this.multiData.length; i++) {\n                    var eventObj_2 = extend({}, this.multiData[parseInt(i.toString(), 10)], null, true);\n                    var startTime = new Date(eventObj_2[this.parent.eventFields.startTime].getTime() + startTimeDiff);\n                    var dayIndex = this.parent.getIndexOfDate(renderDates, util.resetTime(startTime));\n                    if (dayIndex < 0) {\n                        this.isPreventMultiDrag = true;\n                        break;\n                    }\n                    this.isPreventMultiDrag = false;\n                }\n            }\n            if (!this.isPreventMultiDrag) {\n                for (var index_2 = 0; index_2 < this.multiData.length; index_2++) {\n                    this.updatedData[parseInt(index_2.toString(), 10)] =\n                        this.updateMultipleData(this.multiData[parseInt(index_2.toString(), 10)], startTimeDiff);\n                    var dayIndex = this.getDayIndex(this.updatedData[parseInt(index_2.toString(), 10)]);\n                    if (dayIndex >= 0) {\n                        var isAllDay = this.updatedData[parseInt(index_2.toString(), 10)][this.parent.eventFields.isAllDay];\n                        var wrapper = this.getEventWrapper(dayIndex, isAllDay);\n                        this.appendCloneElement(wrapper, this.actionObj.cloneElement[parseInt(index_2.toString(), 10)]);\n                        this.updateEventHeight(this.updatedData[parseInt(index_2.toString(), 10)], index_2, dayIndex);\n                    }\n                    else {\n                        if (!isNullOrUndefined(this.actionObj.cloneElement[parseInt(index_2.toString(), 10)].parentNode)) {\n                            remove(this.actionObj.cloneElement[parseInt(index_2.toString(), 10)]);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            this.updateEventHeight(event);\n        }\n        this.updateTimePosition(this.actionObj.start, this.updatedData);\n    };\n    DragAndDrop.prototype.splitEvent = function (event) {\n        var eventFields = this.parent.eventFields;\n        var eventData = [];\n        var startTime = event[eventFields.startTime];\n        var endTime = event[eventFields.endTime];\n        if (util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()))) {\n            var startReferenceDate = util.resetTime(new Date(startTime.getTime()));\n            var endReferenceDate = new Date(startReferenceDate.getTime());\n            for (var i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n                endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n                var eventObj = extend({}, event, null, true);\n                eventObj[eventFields.startTime] = new Date(startReferenceDate);\n                eventObj[eventFields.endTime] = new Date(endReferenceDate);\n                startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n                eventData.push(eventObj);\n            }\n            var index = eventData.length - 1;\n            eventData[0][eventFields.startTime] = startTime;\n            eventData[parseInt(index.toString(), 10)][eventFields.endTime] = endTime;\n        }\n        else {\n            eventData.push(event);\n        }\n        return eventData;\n    };\n    DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable &&\n            ((this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay]) ||\n                (!this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay]))) {\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n        }\n        var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        if (eventObj[this.parent.eventFields.isAllDay]) {\n            var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n            var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n            var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n            eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n            eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n        }\n        else {\n            eventObj[this.parent.eventFields.startTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n            eventObj[this.parent.eventFields.endTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n        }\n        return eventObj;\n    };\n    DragAndDrop.prototype.getDayIndex = function (event) {\n        var eventObj = extend({}, event, null, true);\n        var startDate = util.resetTime(eventObj[this.parent.eventFields.startTime]);\n        if (this.parent.activeViewOptions.timeScale.enable && !eventObj[this.parent.eventFields.isAllDay]) {\n            var startHour = this.parent.activeView.getStartHour();\n            startDate.setMilliseconds(startHour.getTime() - util.resetTime(startHour).getTime());\n        }\n        var startTime = startDate.getTime();\n        var query = '';\n        var wrapper = cls.DAY_WRAPPER_CLASS;\n        if (this.parent.activeViewOptions.timeScale.enable && (eventObj[this.parent.eventFields.isAllDay])) {\n            wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n        }\n        else {\n            wrapper = cls.WORK_CELLS_CLASS;\n        }\n        query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n        }\n        this.targetTd = this.parent.element.querySelector(query);\n        if (isNullOrUndefined(this.targetTd)) {\n            return -1;\n        }\n        return this.targetTd.cellIndex;\n    };\n    DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n        this.verticalEvent.initializeValues();\n        var datesCount = this.verticalEvent.getStartCount();\n        if (!this.parent.uiStateValues.isGroupAdaptive) {\n            for (var i = 0; i < this.actionObj.groupIndex; i++) {\n                if (this.verticalEvent.dateRender[parseInt(i.toString(), 10)]) {\n                    datesCount = datesCount + this.verticalEvent.dateRender[parseInt(i.toString(), 10)].length;\n                }\n            }\n        }\n        var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n        var target = (this.parent.activeViewOptions.group.byDate &&\n            !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target))) ? true : false;\n        if (target || !this.parent.activeViewOptions.group.byDate) {\n            var dynamicIndex = -1;\n            var dayIndex = !this.parent.activeViewOptions.group.byDate ?\n                isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount\n                : this.parent.getIndexOfDate(this.verticalEvent.dateRender[parseInt(indexGroup.toString(), 10)], util.resetTime(\n                // eslint-disable-next-line max-len\n                this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n            var splitEvents = this.splitEvent(event);\n            var events_1 = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 ||\n                this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n            for (var i = 0; i < events_1.length; i++) {\n                if (i > 0) {\n                    var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[parseInt(i.toString(), 10)][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n                    if (this.parent.activeViewOptions.group.resources.length > 0) {\n                        filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n                    }\n                    var appWrap = this.parent.element.querySelector(filterQuery);\n                    if (appWrap) {\n                        dayIndex = dayIndex + 1;\n                        dynamicIndex = appWrap.cellIndex;\n                    }\n                    else {\n                        dayIndex = -1;\n                    }\n                }\n                if (dayIndex >= 0) {\n                    var record = this.verticalEvent.isSpannedEvent(events_1[parseInt(i.toString(), 10)], dayIndex, indexGroup);\n                    var eStart = record[this.verticalEvent.fields.startTime];\n                    var eEnd = record[this.verticalEvent.fields.endTime];\n                    var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) :\n                        this.actionObj.element.offsetHeight;\n                    var topValue = this.parent.activeViewOptions.timeScale.enable ?\n                        this.verticalEvent.getTopValue(eStart) : this.actionObj.element.offsetTop;\n                    if (isNullOrUndefined(index)) {\n                        if (i === 0) {\n                            this.actionObj.clone.style.top = formatUnit(topValue);\n                            this.actionObj.clone.style.height = formatUnit(appHeight);\n                        }\n                        else {\n                            this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                        }\n                    }\n                    else {\n                        var appWidth = this.actionObj.cellWidth;\n                        if (event[this.parent.eventFields.isAllDay]) {\n                            topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n                            appHeight = this.getAllDayEventHeight();\n                            var timeDiff = event[this.parent.eventFields.endTime].getTime() -\n                                event[this.parent.eventFields.startTime].getTime();\n                            var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n                            if (allDayDifference >= 0) {\n                                appWidth = (allDayDifference * this.actionObj.cellWidth);\n                            }\n                        }\n                        if (this.actionObj.cloneElement[parseInt(index.toString(), 10)]) {\n                            if (i === 0) {\n                                this.actionObj.cloneElement[parseInt(index.toString(), 10)].style.top = formatUnit(topValue);\n                                this.actionObj.cloneElement[parseInt(index.toString(), 10)].style.height = formatUnit(appHeight);\n                                this.actionObj.cloneElement[parseInt(index.toString(), 10)].style.width = formatUnit(appWidth);\n                                this.actionObj.cloneElement[parseInt(index.toString(), 10)].style.left = formatUnit(0);\n                            }\n                            else {\n                                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n        var startTime = record[this.parent.eventFields.startTime].getTime();\n        var endTime = record[this.parent.eventFields.endTime].getTime();\n        if (startTime !== endTime) {\n            var appointmentElement = this.verticalEvent.\n                createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n            addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n            setStyleAttribute(appointmentElement, {\n                'width': '100%',\n                'height': height + 'px',\n                'top': top + 'px',\n                'border': '0px'\n            });\n            var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n            appointmentWrap[parseInt(index.toString(), 10)].appendChild(appointmentElement);\n        }\n    };\n    DragAndDrop.prototype.getRenderedDates = function () {\n        var _this = this;\n        var _a, _b;\n        var renderDates = this.parent.activeView.renderDates;\n        (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) { return +date; }));\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.eventBase.slots = [];\n            var resources = this.parent.resourceBase.lastResourceLevel.\n                filter(function (res) { return res.groupIndex === _this.actionObj.groupIndex; });\n            renderDates = resources[0].renderDates;\n            (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) { return +date; }));\n        }\n        return renderDates;\n    };\n    DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n        this.parent.eventBase.slots = [];\n        var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n        var renderDates = this.getRenderedDates();\n        var events = this.parent.eventBase.splitEvent(event, renderDates);\n        var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n        }\n        var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n        if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n            var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n            this.appendCloneElement(this.getEventWrapper(cellIndex));\n            // eslint-disable-next-line max-len\n            this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.swapDragging = function (e) {\n        if (this.isPreventMultiDrag) {\n            return;\n        }\n        var colIndex = !isNullOrUndefined(closest(this.actionObj.target, 'td')) && closest(this.actionObj.target, 'td').cellIndex;\n        if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n            addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = true;\n            var eventHeight = this.getAllDayEventHeight();\n            var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n            if (allDayElement[0].offsetHeight < eventHeight) {\n                for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n                    var element = allDayElement_1[_i];\n                    element.style.height = ((eventHeight + 2) / 12) + 'em';\n                }\n            }\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(this.actionObj.cellWidth),\n                height: formatUnit(eventHeight),\n                top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n            });\n        }\n        if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n            removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = false;\n            // eslint-disable-next-line max-len\n            var height = (this.actionObj.element.offsetHeight === 0) ? this.actionObj.height : this.actionObj.element.offsetHeight;\n            setStyleAttribute(this.actionObj.clone, {\n                left: formatUnit(0),\n                height: formatUnit(height),\n                width: formatUnit(this.actionObj.cellWidth)\n            });\n        }\n    };\n    DragAndDrop.prototype.calculateVerticalDate = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'tr'))) ||\n            (e.target && e.target.tagName === 'DIV')) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n            this.removeCloneElement();\n        }\n        var eventDuration = util.getUniversalTime(eventObj[this.parent.eventFields.endTime]) -\n            util.getUniversalTime(eventObj[this.parent.eventFields.startTime]);\n        var td = closest(this.actionObj.target, 'td');\n        if (!isNullOrUndefined(td)) {\n            var tr = td.parentElement;\n            this.actionObj.index = (tr.rowIndex * tr.children.length) + td.cellIndex;\n            var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n            td = workCells[this.actionObj.index];\n            var currentDate = this.parent.getDateFromElement(td);\n            if (!isNullOrUndefined(currentDate)) {\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n                }\n                var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n                var dragStart = new Date(timeString.getTime());\n                var startTimeDiff = util.getUniversalTime(eventObj[this.parent.eventFields.startTime]) -\n                    util.getUniversalTime(util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime])));\n                dragStart.setMilliseconds(startTimeDiff);\n                var dragEnd = new Date(dragStart.getTime());\n                dragEnd.setMilliseconds(eventDuration);\n                this.actionObj.start = new Date(dragStart.getTime());\n                this.actionObj.end = new Date(dragEnd.getTime());\n            }\n        }\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n            var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n            for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n                var wrapper = eventWrappers_1[_i];\n                remove(wrapper);\n            }\n        }\n        if (this.multiData && this.multiData.length > 0) {\n            var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n            var startTimeDiff = startTime.getTime() - this.startTime;\n            if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n                startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n                startTimeDiff -= new Date(this.startTime).getMonth();\n                startTimeDiff += startTime.getMonth();\n            }\n            for (var index = 0; index < this.multiData.length; index++) {\n                this.updatedData[parseInt(index.toString(), 10)] =\n                    this.updateMultipleVerticalDate(this.multiData[parseInt(index.toString(), 10)], startTimeDiff);\n                if (this.parent.currentView === 'TimelineYear') {\n                    this.dynamicYearlyEventsRendering(this.updatedData[parseInt(index.toString(), 10)]);\n                }\n                else {\n                    this.dynamicEventsRendering(this.updatedData[parseInt(index.toString(), 10)]);\n                }\n            }\n        }\n        else {\n            if (this.parent.currentView === 'TimelineYear') {\n                this.dynamicYearlyEventsRendering(event);\n            }\n            else {\n                this.dynamicEventsRendering(event);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n        if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n        }\n        else {\n            var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n        }\n        eventObj[this.parent.eventFields.endTime] =\n            new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n        return eventObj;\n    };\n    DragAndDrop.prototype.calculateTimelineTime = function (e) {\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = util.getUniversalTime(eventObj[this.parent.eventFields.endTime]) -\n            util.getUniversalTime(eventObj[this.parent.eventFields.startTime]);\n        var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth :\n            parseInt(this.actionObj.clone.style.left, 10);\n        offsetLeft = Math.round(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n        var rightOffset;\n        if (this.parent.enableRtl) {\n            rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n            this.actionObj.clone.style.right = formatUnit(rightOffset);\n        }\n        offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n        var colIndex = this.getColumnIndex(offsetLeft);\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl &&\n            this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right &&\n            !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n        var leftVal = (this.parent.eventDragArea) ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n        if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n            this.isCursorAhead = true;\n        }\n        var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n        if (this.parent.enableRtl) {\n            cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) /\n                this.actionObj.cellWidth)) - 1;\n        }\n        if (this.cursorPointIndex < 0) {\n            this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n        }\n        var tr = this.parent.getContentTable().querySelector('tr');\n        var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n        index = index < 0 ? 0 : index;\n        var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[parseInt(index.toString(), 10)].getTime()) :\n            this.parent.getDateFromElement(tr.children[parseInt(index.toString(), 10)]);\n        eventStart = this.isAllDayDrag ? util.resetTime(eventStart) : eventStart;\n        if (this.isStepDragging) {\n            var widthDiff = this.getWidthDiff(tr, index);\n            if (widthDiff !== 0) {\n                var timeDiff = Math.ceil(widthDiff / this.widthPerMinute);\n                eventStart.setMinutes(eventStart.getMinutes() + (timeDiff * this.actionObj.interval));\n                if (this.isCursorAhead || cursorDrag) {\n                    eventStart.setMilliseconds(-(eventDuration));\n                }\n                else {\n                    eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n                    var intervalInMS = this.actionObj.interval * util.MS_PER_MINUTE;\n                    timeDiff = Math.abs(eventStart.getTime() - this.actionObj.start.getTime()) / intervalInMS;\n                    var roundTimeDiff = Math.trunc(timeDiff);\n                    if (roundTimeDiff !== timeDiff) {\n                        timeDiff = (roundTimeDiff * intervalInMS) * (eventStart > this.actionObj.start ? 1 : -1);\n                        eventStart = new Date(this.actionObj.start.getTime() + timeDiff);\n                    }\n                }\n            }\n            else {\n                eventStart = this.actionObj.start;\n            }\n        }\n        else {\n            if ((this.isCursorAhead || cursorDrag) && !this.isAllDayDrag) {\n                var minutes = this.isTimelineDayProcess || this.isAllDayDrag ? MINUTES_PER_DAY : this.actionObj.slotInterval;\n                eventStart.setMinutes(eventStart.getMinutes() + minutes);\n                eventStart.setMilliseconds(-(eventDuration));\n                if (eventStart.getTime() === util.resetTime(eventStart).getTime() && eventStart.getMinutes() === 0 && eventDuration === 0) {\n                    eventStart.setMinutes(-minutes);\n                }\n            }\n            else {\n                eventStart.setMinutes(eventStart.getMinutes() - (this.cursorPointIndex *\n                    (this.isTimelineDayProcess || this.isAllDayDrag ? MINUTES_PER_DAY : this.actionObj.slotInterval)));\n            }\n        }\n        if (!this.isStepDragging) {\n            eventStart = this.calculateIntervalTime(eventStart);\n        }\n        if (this.isTimelineDayProcess || this.isAllDayDrag) {\n            var eventSrt = eventObj[this.parent.eventFields.startTime];\n            eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n        }\n        if (this.parent.eventDragArea) {\n            var targetDate = this.parent.getDateFromElement(e.target);\n            if (!isNullOrUndefined(targetDate)) {\n                if (!this.parent.activeViewOptions.timeScale.enable || (this.parent.currentView === 'TimelineMonth')) {\n                    var eventSrt = eventObj[this.parent.eventFields.startTime];\n                    eventStart = new Date(targetDate.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n                }\n                else {\n                    eventStart = targetDate;\n                }\n            }\n        }\n        var eventEnd = new Date(eventStart.getTime());\n        eventEnd.setMilliseconds(eventDuration);\n        var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n        if (this.multiData.length > 0) {\n            var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var i = 0; i < this.multiData.length; i++) {\n                this.updatedData[parseInt(i.toString(), 10)] =\n                    this.updateMultipleData(this.multiData[parseInt(i.toString(), 10)], startTimeDiff);\n            }\n            eventsData = this.updatedData;\n        }\n        for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n            var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[parseInt(dataIndex.toString(), 10)] : this.actionObj.clone;\n            if (isNullOrUndefined(this.parent.eventDragArea)) {\n                var events_2 = this.timelineEventModule.splitEvent(eventsData[parseInt(dataIndex.toString(), 10)], this.timelineEventModule.dateRender);\n                var eventData = events_2[0].data;\n                var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n                var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData);\n                // eslint-disable-next-line max-len\n                var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n                // eslint-disable-next-line max-len\n                var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n                day = day < 0 ? 0 : day;\n                var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n                if (this.parent.enableRtl) {\n                    cloneElement.style.right = formatUnit(left);\n                }\n                else {\n                    cloneElement.style.left = formatUnit(left);\n                }\n                if (!this.isMorePopupOpened) {\n                    cloneElement.style.width = formatUnit(width);\n                }\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                this.calculateResourceGroupingPosition(e, cloneElement);\n            }\n            this.actionObj.start = new Date(eventStart.getTime());\n            this.actionObj.end = new Date(eventEnd.getTime());\n            this.updateTimePosition(this.actionObj.start, this.updatedData);\n        }\n    };\n    DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n        if (this.scrollEdges.left || this.scrollEdges.right) {\n            var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            if (this.parent.enableRtl) {\n                rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n                if (this.scrollEdges.right) {\n                    rightOffset = (rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth) -\n                        (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                else {\n                    rightOffset = rightOffset + this.widthUptoCursorPoint;\n                    if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n                        this.actionObj.clone.style.width =\n                            formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n                        rightOffset = (viewEle.scrollLeft - viewEle.scrollWidth);\n                    }\n                }\n                if (isNullOrUndefined(this.parent.eventDragArea)) {\n                    this.actionObj.clone.style.left = formatUnit(rightOffset);\n                }\n            }\n            else {\n                if (this.scrollEdges.left) {\n                    offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n                    if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n                        viewEle.scrollLeft = viewEle.scrollLeft - 1;\n                    }\n                    else if (this.actionObj.clone.offsetLeft === 0) {\n                        offsetLeft = viewEle.scrollLeft;\n                    }\n                }\n                else {\n                    offsetLeft = (viewEle.scrollLeft + viewEle.offsetWidth -\n                        this.actionObj.clone.offsetWidth) + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n                if (isNullOrUndefined(this.parent.eventDragArea)) {\n                    this.actionObj.clone.style.left = formatUnit(offsetLeft);\n                }\n            }\n        }\n        return offsetLeft;\n    };\n    DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n        var pages = this.scrollArgs.element.getBoundingClientRect();\n        if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n            var targetLeft = tr.children[parseInt(index.toString(), 10)].offsetLeft;\n            var pageX = this.actionObj.pageX - pages.left;\n            if (this.parent.enableRtl) {\n                return (targetLeft + this.actionObj.cellWidth) - (this.scrollArgs.element.scrollLeft + pageX);\n            }\n            else {\n                return (this.scrollArgs.element.scrollLeft + pageX) - targetLeft;\n            }\n        }\n        return 0;\n    };\n    DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n        var index = Math.round(offsetLeft / this.actionObj.cellWidth);\n        if (this.isHeaderRows) {\n            return index;\n        }\n        return this.getIndex(index);\n    };\n    DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n        var index = colIndex + cloneIndex;\n        if (this.isHeaderRows) {\n            var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n            return (index > dateLength - 1) ? dateLength - 1 : index;\n        }\n        return (index > tr.children.length - 1) ? tr.children.length - 1 : index;\n    };\n    DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n        var td = closest(e.target, '.e-work-cells');\n        if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n            var targetDate = this.parent.getDateFromElement(td);\n            targetDate = this.isAllDayDrag ? util.resetTime(targetDate) : targetDate;\n            if (this.isHeaderRows) {\n                var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n                targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n            }\n            var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n            if (this.isTimelineDayProcess || this.isAllDayDrag) {\n                this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / (util.MS_PER_DAY)));\n            }\n            else {\n                var widthDiff = Math.floor((timeDiff / util.MS_PER_MINUTE) / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n                this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n                this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n            }\n        }\n        else {\n            this.cursorPointIndex = 0;\n        }\n    };\n    DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n        var translateY = util.getTranslateY(dragArea.querySelector('table'));\n        translateY = (isNullOrUndefined(translateY)) ? 0 : translateY;\n        var rowHeight = (this.parent.rowAutoHeight) ?\n            ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n        var rowIndex = Math.floor(Math.floor((this.actionObj.Y +\n            (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset))) -\n            util.getElementTop(dragArea, this.parent.uiStateValues.isTransformed)) / rowHeight);\n        rowIndex = (rowIndex < 0) ? 0 : (rowIndex > trCollection.length - 1) ? trCollection.length - 1 : rowIndex;\n        this.actionObj.index = rowIndex;\n        var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n        var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper, cloneElement);\n        var td = closest(this.actionObj.target, 'td');\n        this.actionObj.groupIndex = (td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)))\n            ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n        if (!isNullOrUndefined(this.parent.eventDragArea)) {\n            return;\n        }\n        var top = this.parent.getElementHeight(trCollection[parseInt(rowIndex.toString(), 10)]) * rowIndex;\n        if (this.parent.rowAutoHeight) {\n            var cursorElement = this.getCursorElement(e);\n            if (cursorElement) {\n                top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop :\n                    (cursorElement.offsetParent && cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS)) ?\n                        cursorElement.offsetParent.offsetTop : top;\n            }\n        }\n        cloneElement.style.top = formatUnit(top);\n    };\n    DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n        if (cloneElement === void 0) { cloneElement = null; }\n        cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        if (this.parent.eventDragArea && dragElement) {\n            dragElement.appendChild(cloneElement);\n        }\n        else {\n            element.appendChild(cloneElement);\n        }\n    };\n    DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n        var eventWrapper;\n        if (isNullOrUndefined(isAllDayDrag)) {\n            isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n            eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n        }\n        else {\n            var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n            eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!eventWrapper) {\n                eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                targetWrapper.appendChild(eventWrapper);\n            }\n        }\n        return eventWrapper;\n    };\n    DragAndDrop.prototype.getAllDayEventHeight = function () {\n        var eventWrapper = createElement('div', { className: cls.APPOINTMENT_CLASS });\n        this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n        var eventHeight = eventWrapper.offsetHeight;\n        remove(eventWrapper);\n        return eventHeight;\n    };\n    DragAndDrop.prototype.isAllowDrop = function (e) {\n        if (!this.actionObj.excludeSelectors) {\n            return false;\n        }\n        var dropSelectors = this.actionObj.excludeSelectors.split(',');\n        var isAllowDrop = false;\n        for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n            var selector = dropSelectors_1[_i];\n            if (e.target.classList.contains(selector)) {\n                isAllowDrop = true;\n                break;\n            }\n        }\n        return isAllowDrop;\n    };\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name\n     */\n    DragAndDrop.prototype.getModuleName = function () {\n        return 'dragAndDrop';\n    };\n    return DragAndDrop;\n}(ActionBase));\nexport { DragAndDrop };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}