{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable max-len */\nimport { isNullOrUndefined, closest, extend, EventHandler, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { createElement, prepend, append, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager, Query, Predicate } from '@syncfusion/ej2-data';\nimport { generate, getDateFromRecurrenceDateString } from '../../recurrence-editor/date-generator';\nimport * as util from '../base/util';\nimport * as cls from '../base/css-constant';\nimport * as event from '../base/constant';\n/**\n * EventBase for appointment rendering\n */\nvar EventBase = /** @class */function () {\n  /**\n   * Constructor for EventBase\n   *\n   * @param {Schedule} parent Accepts the schedule instance\n   */\n  function EventBase(parent) {\n    this.slots = [];\n    this.processedData = [];\n    this.isDoubleTapped = false;\n    this.parent = parent;\n  }\n  EventBase.prototype.processData = function (events, timeZonePropChanged, oldTimezone) {\n    var _this = this;\n    var start = this.parent.activeView.startDate();\n    var end = this.parent.activeView.endDate();\n    var fields = this.parent.eventFields;\n    var processed = [];\n    var temp = 1;\n    var generateID = false;\n    var resourceCollection = this.parent.resourceBase ? this.parent.resourceBase.resourceCollection : [];\n    if (events.length > 0 && isNullOrUndefined(events[0][fields.id])) {\n      generateID = true;\n    }\n    var _loop_1 = function (event_1) {\n      if (generateID) {\n        event_1[fields.id] = temp++;\n      }\n      event_1 = this_1.updateEventDateTime(event_1);\n      if (timeZonePropChanged) {\n        this_1.processTimezoneChange(event_1, oldTimezone);\n      } else if (!this_1.parent.isPrinting && !this_1.parent.uiStateValues.isPreventTimezone) {\n        event_1 = this_1.processTimezone(event_1);\n      }\n      for (var level = 0; level < resourceCollection.length; level++) {\n        if (event_1[resourceCollection[parseInt(level.toString(), 10)].field] === null || event_1[resourceCollection[parseInt(level.toString(), 10)].field] === 0) {\n          event_1[resourceCollection[parseInt(level.toString(), 10)].field] = undefined;\n        }\n      }\n      if (!isNullOrUndefined(event_1[fields.recurrenceRule]) && event_1[fields.recurrenceRule] === '') {\n        event_1[fields.recurrenceRule] = null;\n      }\n      if (!isNullOrUndefined(event_1[fields.recurrenceRule]) && isNullOrUndefined(event_1[fields.recurrenceID]) && !(this_1.parent.crudModule && this_1.parent.crudModule.crudObj.isCrudAction)) {\n        processed = processed.concat(this_1.generateOccurrence(event_1, null, true));\n      } else {\n        if (this_1.parent.crudModule && this_1.parent.crudModule.crudObj.isCrudAction) {\n          if (!isNullOrUndefined(event_1[fields.recurrenceRule]) && isNullOrUndefined(event_1[fields.recurrenceID])) {\n            var recurrenceEvent = this_1.generateOccurrence(event_1, null, true);\n            var _loop_2 = function (occurrence) {\n              var app = this_1.parent.eventsProcessed.filter(function (data) {\n                return data[fields.startTime].getTime() - occurrence[fields.startTime].getTime() === 0 && data[fields.id] === occurrence[fields.id];\n              });\n              occurrence.Guid = app.length > 0 ? app[0].Guid : this_1.generateGuid();\n              processed.push(occurrence);\n            };\n            for (var _i = 0, recurrenceEvent_1 = recurrenceEvent; _i < recurrenceEvent_1.length; _i++) {\n              var occurrence = recurrenceEvent_1[_i];\n              _loop_2(occurrence);\n            }\n          } else {\n            var app = this_1.parent.eventsProcessed.filter(function (data) {\n              return data[_this.parent.eventFields.id] === event_1[_this.parent.eventFields.id];\n            });\n            event_1.Guid = app.length > 0 ? app[0].Guid : this_1.generateGuid();\n            processed.push(event_1);\n          }\n        } else {\n          event_1.Guid = this_1.generateGuid();\n          processed.push(event_1);\n        }\n      }\n    };\n    var this_1 = this;\n    for (var _i = 0, events_1 = events; _i < events_1.length; _i++) {\n      var event_1 = events_1[_i];\n      _loop_1(event_1);\n    }\n    this.parent.eventsProcessed = [];\n    var eventData = processed.filter(function (data) {\n      return !data[_this.parent.eventFields.isBlock];\n    });\n    this.parent.eventsProcessed = this.filterEvents(start, end, eventData);\n    if (!this.parent.activeViewOptions.allowOverlap && this.parent.eventsProcessed.length > 0) {\n      this.processedData = this.parent.eventsProcessed;\n      var nonOverlapList = [];\n      var fields_1 = this.parent.eventFields;\n      for (var _a = 0, _b = this.parent.eventsProcessed; _a < _b.length; _a++) {\n        var data = _b[_a];\n        var overlappingData = this.findOverlappingData(data, nonOverlapList);\n        if (!overlappingData) {\n          nonOverlapList.push(data);\n        } else if (!this.parent.eventSettings.sortComparer) {\n          var dataDuration = new Date(data[fields_1.endTime]).getTime() - new Date(data[fields_1.startTime]).getTime();\n          var duplicateDuration = new Date(overlappingData[fields_1.endTime]).getTime() - new Date(overlappingData[fields_1.startTime]).getTime();\n          if (dataDuration > duplicateDuration && data[fields_1.startTime] === overlappingData[fields_1.startTime] || data[fields_1.isAllDay] === true) {\n            var index = nonOverlapList.indexOf(overlappingData);\n            if (index !== -1) {\n              nonOverlapList.splice(index, 1);\n            }\n            nonOverlapList.push(data);\n          }\n        }\n      }\n      this.parent.eventsProcessed = nonOverlapList;\n    }\n    var blockData = processed.filter(function (data) {\n      return data[_this.parent.eventFields.isBlock];\n    });\n    for (var _c = 0, blockData_1 = blockData; _c < blockData_1.length; _c++) {\n      var eventObj = blockData_1[_c];\n      if (eventObj[fields.isAllDay]) {\n        var isDifferentDate = util.resetTime(new Date(eventObj[fields.startTime].getTime())) < util.resetTime(new Date(eventObj[fields.endTime].getTime()));\n        if (!isDifferentDate) {\n          eventObj[fields.startTime] = util.resetTime(eventObj[fields.startTime]);\n          eventObj[fields.endTime] = util.addDays(util.resetTime(eventObj[fields.endTime]), 1);\n        }\n      }\n    }\n    this.parent.blockProcessed = blockData;\n    return eventData;\n  };\n  EventBase.prototype.findOverlappingData = function (eventData, eventList) {\n    var isResource = this.parent.activeViewOptions.group.resources.length > 0;\n    var resourceCollection = isResource ? this.parent.resourceBase.resourceCollection : [];\n    var lastLevelResource = isResource ? resourceCollection[resourceCollection.length - 1].field : null;\n    var fields = this.parent.eventFields;\n    var newStartTime = new Date(eventData[fields.startTime]);\n    var newEndTime = new Date(eventData[fields.endTime]);\n    for (var _i = 0, eventList_1 = eventList; _i < eventList_1.length; _i++) {\n      var existingEvent = eventList_1[_i];\n      if (newStartTime < existingEvent[fields.endTime] && newEndTime > existingEvent[fields.startTime] && existingEvent[fields.id] !== eventData[fields.id] && (!isResource || isNullOrUndefined(lastLevelResource) || this.compareResourceValues(existingEvent[\"\" + lastLevelResource], eventData[\"\" + lastLevelResource]))) {\n        return existingEvent;\n      }\n    }\n    return undefined;\n  };\n  EventBase.prototype.isOverlapRange = function (eventData, currentAction) {\n    var _this = this;\n    if (currentAction === void 0) {\n      currentAction = null;\n    }\n    var isResource = this.parent.activeViewOptions.group.resources.length > 0;\n    var resourceCollection = isResource ? this.parent.resourceBase.resourceCollection : [];\n    var lastLevelResource = isResource ? resourceCollection[resourceCollection.length - 1].field : null;\n    var eventCollection = Array.isArray(eventData) ? eventData : [eventData];\n    var fields = this.parent.eventFields;\n    var processOverlappingEvents = function (data) {\n      return _this.processedData.filter(function (x) {\n        return data[fields.startTime] < x[fields.endTime] && data[fields.endTime] > x[fields.startTime] && x[fields.id] !== data[fields.id] && (!isResource || isNullOrUndefined(lastLevelResource) || _this.compareResourceValues(x[\"\" + lastLevelResource], data[\"\" + lastLevelResource]));\n      });\n    };\n    var overlappedEvents = [];\n    var isOverlapAlert = false;\n    for (var _i = 0, eventCollection_1 = eventCollection; _i < eventCollection_1.length; _i++) {\n      var event_2 = eventCollection_1[_i];\n      var dataCol = !isNullOrUndefined(event_2[fields.recurrenceRule]) && (isNullOrUndefined(event_2[fields.recurrenceID]) || event_2[fields.recurrenceID] === event_2[fields.id]) && (isNullOrUndefined(event_2[fields.recurrenceID]) || currentAction === 'EditSeries') ? this.generateOccurrence(event_2) : [event_2];\n      for (var _a = 0, dataCol_1 = dataCol; _a < dataCol_1.length; _a++) {\n        var data = dataCol_1[_a];\n        var overlappingEvents = processOverlappingEvents(data);\n        if (overlappingEvents.length > 0) {\n          overlappedEvents.push.apply(overlappedEvents, overlappingEvents);\n        }\n        if (this.findOverlappingData(data, this.parent.eventsProcessed)) {\n          isOverlapAlert = true;\n        }\n      }\n    }\n    this.parent.overlapAppointments = overlappedEvents;\n    return isOverlapAlert;\n  };\n  EventBase.prototype.compareResourceValues = function (a, b) {\n    var getValue = function (value) {\n      return Array.isArray(value) ? value[0] : value;\n    };\n    return getValue(a) === getValue(b);\n  };\n  EventBase.prototype.checkOverlap = function (eventData) {\n    if (!this.parent.activeViewOptions.allowOverlap) {\n      if (this.isOverlapRange(eventData)) {\n        this.parent.quickPopup.openValidationError('overlapAlert', eventData);\n        return true;\n      }\n    }\n    return false;\n  };\n  EventBase.prototype.updateEventDateTime = function (eventData) {\n    if (typeof eventData[this.parent.eventFields.startTime] === 'string') {\n      eventData[this.parent.eventFields.startTime] = util.getDateFromString(eventData[this.parent.eventFields.startTime]);\n    }\n    if (typeof eventData[this.parent.eventFields.endTime] === 'string') {\n      eventData[this.parent.eventFields.endTime] = util.getDateFromString(eventData[this.parent.eventFields.endTime]);\n    }\n    return eventData;\n  };\n  EventBase.prototype.getProcessedEvents = function (eventCollection) {\n    if (eventCollection === void 0) {\n      eventCollection = this.parent.eventsData;\n    }\n    var processed = [];\n    for (var _i = 0, eventCollection_2 = eventCollection; _i < eventCollection_2.length; _i++) {\n      var event_3 = eventCollection_2[_i];\n      if (!isNullOrUndefined(event_3[this.parent.eventFields.recurrenceRule]) && isNullOrUndefined(event_3[this.parent.eventFields.recurrenceID])) {\n        processed = processed.concat(this.generateOccurrence(event_3));\n      } else {\n        processed.push(event_3);\n      }\n    }\n    return processed;\n  };\n  EventBase.prototype.timezonePropertyChange = function (oldTimezone) {\n    var data = this.parent.eventsData.concat(this.parent.blockData);\n    var processed = this.processData(data, true, oldTimezone);\n    this.parent.notify(event.dataReady, {\n      processedData: processed\n    });\n  };\n  EventBase.prototype.timezoneConvert = function (eventData) {\n    var fields = this.parent.eventFields;\n    eventData[fields.startTimezone] = eventData[fields.startTimezone] || eventData[fields.endTimezone];\n    eventData[fields.endTimezone] = eventData[fields.endTimezone] || eventData[fields.startTimezone];\n    if (this.parent.timezone) {\n      var startTz = eventData[fields.startTimezone];\n      var endTz = eventData[fields.endTimezone];\n      eventData[fields.startTime] = this.parent.tzModule.convert(eventData[fields.startTime], this.parent.timezone, startTz);\n      eventData[fields.endTime] = this.parent.tzModule.convert(eventData[fields.endTime], this.parent.timezone, endTz);\n    }\n  };\n  EventBase.prototype.processTimezoneChange = function (event, oldTimezone) {\n    var fields = this.parent.eventFields;\n    if (event[fields.isAllDay]) {\n      return;\n    }\n    if (oldTimezone && this.parent.timezone) {\n      event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], oldTimezone, this.parent.timezone);\n      event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], oldTimezone, this.parent.timezone);\n    } else if (!oldTimezone && this.parent.timezone) {\n      event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], this.parent.timezone);\n      event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], this.parent.timezone);\n    } else if (oldTimezone && !this.parent.timezone) {\n      event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], oldTimezone);\n      event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], oldTimezone);\n    }\n  };\n  EventBase.prototype.processTimezone = function (event, isReverse) {\n    if (isReverse === void 0) {\n      isReverse = false;\n    }\n    var fields = this.parent.eventFields;\n    if (event[fields.isAllDay]) {\n      return event;\n    }\n    if (event[fields.startTimezone] || event[fields.endTimezone]) {\n      var startTimezone = event[fields.startTimezone] || event[fields.endTimezone];\n      var endTimezone = event[fields.endTimezone] || event[fields.startTimezone];\n      if (isReverse) {\n        if (this.parent.timezone) {\n          event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], startTimezone, this.parent.timezone);\n          event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], endTimezone, this.parent.timezone);\n          event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], this.parent.timezone);\n          event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], this.parent.timezone);\n        } else {\n          event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], startTimezone);\n          event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], endTimezone);\n        }\n      } else {\n        event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], startTimezone);\n        event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], endTimezone);\n        if (this.parent.timezone) {\n          event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], startTimezone, this.parent.timezone);\n          event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], endTimezone, this.parent.timezone);\n        }\n      }\n    } else if (this.parent.timezone) {\n      if (isReverse) {\n        event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], this.parent.timezone);\n        event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], this.parent.timezone);\n      } else {\n        event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], this.parent.timezone);\n        event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], this.parent.timezone);\n      }\n    }\n    return event;\n  };\n  EventBase.prototype.filterBlockEvents = function (eventObj) {\n    var fields = this.parent.eventFields;\n    var eStart = eventObj[fields.startTime];\n    var eEnd = eventObj[fields.endTime];\n    var resourceData;\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      var data = this.getGroupIndexFromEvent(eventObj);\n      resourceData = this.parent.resourceBase.lastResourceLevel[parseInt(data.toString(), 10)];\n    }\n    var blockEvents = extend([], this.parent.blockProcessed, null, true);\n    for (var _i = 0, blockEvents_1 = blockEvents; _i < blockEvents_1.length; _i++) {\n      var eventObj_1 = blockEvents_1[_i];\n      if (eventObj_1[fields.isAllDay]) {\n        var isDifferentTime = eventObj_1[fields.endTime].getTime() > util.resetTime(new Date(eventObj_1[fields.endTime].getTime())).getTime();\n        if (isDifferentTime) {\n          eventObj_1[fields.startTime] = util.resetTime(eventObj_1[fields.startTime]);\n          eventObj_1[fields.endTime] = util.addDays(util.resetTime(eventObj_1[fields.endTime]), 1);\n        }\n      }\n    }\n    return this.filterEvents(eStart, eEnd, blockEvents, resourceData);\n  };\n  EventBase.prototype.filterEvents = function (startDate, endDate, appointments, resourceTdData) {\n    if (appointments === void 0) {\n      appointments = this.parent.eventsProcessed;\n    }\n    var predicate = this.parent.dataModule.getStartEndQuery(startDate, endDate);\n    var filter = new DataManager({\n      json: appointments\n    }).executeLocal(new Query().where(predicate));\n    if (resourceTdData) {\n      filter = this.filterEventsByResource(resourceTdData, filter);\n    }\n    return this.sortByTime(filter);\n  };\n  EventBase.prototype.filterEventsByRange = function (eventCollection, startDate, endDate) {\n    var _this = this;\n    var filteredEvents = [];\n    if (startDate && endDate) {\n      filteredEvents = this.filterEvents(startDate, endDate, eventCollection);\n    } else if (startDate && !endDate) {\n      filteredEvents = eventCollection.filter(function (e) {\n        return e[_this.parent.eventFields.startTime] >= startDate;\n      });\n    } else if (!startDate && endDate) {\n      filteredEvents = eventCollection.filter(function (e) {\n        return e[_this.parent.eventFields.endTime] <= endDate;\n      });\n    } else {\n      filteredEvents = eventCollection;\n    }\n    return this.sortByTime(filteredEvents);\n  };\n  EventBase.prototype.filterEventsByResource = function (resourceTdData, appointments) {\n    if (appointments === void 0) {\n      appointments = this.parent.eventsProcessed;\n    }\n    var predicate = {};\n    var resourceCollection = this.parent.resourceBase.resourceCollection;\n    for (var level = 0; level < resourceCollection.length; level++) {\n      predicate[resourceCollection[parseInt(level.toString(), 10)].field] = resourceTdData.groupOrder[parseInt(level.toString(), 10)];\n    }\n    var keys = Object.keys(predicate);\n    var filteredCollection = appointments.filter(function (eventObj) {\n      return keys.every(function (key) {\n        if (eventObj[\"\" + key] instanceof Array) {\n          return eventObj[\"\" + key].indexOf(predicate[\"\" + key]) > -1;\n        } else {\n          return eventObj[\"\" + key] === predicate[\"\" + key];\n        }\n      });\n    });\n    return filteredCollection;\n  };\n  EventBase.prototype.sortByTime = function (appointmentsCollection) {\n    if (this.parent.eventSettings.sortComparer && (typeof this.parent.eventSettings.sortComparer === 'function' || typeof this.parent.eventSettings.sortComparer === 'string')) {\n      appointmentsCollection = this.customSorting(appointmentsCollection);\n    } else {\n      var fieldMappings_1 = this.parent.eventFields;\n      appointmentsCollection.sort(function (a, b) {\n        var d1 = a[fieldMappings_1.startTime];\n        var d2 = b[fieldMappings_1.startTime];\n        return d1.getTime() - d2.getTime();\n      });\n    }\n    return appointmentsCollection;\n  };\n  EventBase.prototype.sortByDateTime = function (appointments) {\n    if (this.parent.eventSettings.sortComparer && (typeof this.parent.eventSettings.sortComparer === 'function' || typeof this.parent.eventSettings.sortComparer === 'string')) {\n      appointments = this.customSorting(appointments);\n    } else {\n      var fieldMapping_1 = this.parent.eventFields;\n      appointments.sort(function (object1, object2) {\n        var d3 = object1[fieldMapping_1.startTime];\n        var d4 = object2[fieldMapping_1.startTime];\n        var d5 = object1[fieldMapping_1.endTime];\n        var d6 = object2[fieldMapping_1.endTime];\n        var d1 = d5.getTime() - d3.getTime();\n        var d2 = d6.getTime() - d4.getTime();\n        return d3.getTime() - d4.getTime() || d2 - d1;\n      });\n    }\n    return appointments;\n  };\n  EventBase.prototype.customSorting = function (appointments) {\n    if (typeof this.parent.eventSettings.sortComparer === 'function') {\n      return this.parent.eventSettings.sortComparer.call(this.parent, appointments);\n    } else if (typeof this.parent.eventSettings.sortComparer === 'string') {\n      var splits = this.parent.eventSettings.sortComparer.split('.');\n      var sortFn = void 0;\n      if (!isNullOrUndefined(window)) {\n        sortFn = window[splits[splits.length - 1]];\n      }\n      if (sortFn) {\n        return sortFn(appointments);\n      }\n    }\n    return appointments;\n  };\n  EventBase.prototype.getSmallestMissingNumber = function (array) {\n    var large = Math.max.apply(Math, array);\n    for (var i = 0; i < large; i++) {\n      if (array.indexOf(i) === -1) {\n        return i;\n      }\n    }\n    return large + 1;\n  };\n  EventBase.prototype.splitEventByDay = function (event) {\n    var eventFields = this.parent.eventFields;\n    var data = [];\n    var eventStartTime = event[eventFields.startTime];\n    var eventEndTime = event[eventFields.endTime];\n    var isDifferentDate = util.resetTime(new Date(eventStartTime.getTime())) < util.resetTime(new Date(eventEndTime.getTime()));\n    if (isDifferentDate) {\n      var start = new Date(eventStartTime.getTime());\n      var end = util.addDays(util.resetTime(new Date(eventStartTime.getTime())), 1);\n      var endDate = eventEndTime.getHours() === 0 && eventEndTime.getMinutes() === 0 ? eventEndTime : util.addDays(eventEndTime, 1);\n      var index = 1;\n      var eventLength = util.getDaysCount(eventStartTime.getTime(), endDate.getTime());\n      while (end <= eventEndTime && start.getTime() !== end.getTime()) {\n        var app = extend({}, event);\n        app[eventFields.startTime] = start;\n        app[eventFields.endTime] = end;\n        app.data = {\n          index: index,\n          count: eventLength\n        };\n        app.Guid = this.generateGuid();\n        app.isSpanned = true;\n        data.push(app);\n        start = end;\n        if (util.resetTime(new Date(start.getTime())).getTime() === util.resetTime(new Date(eventEndTime.getTime())).getTime() && !(end.getTime() === eventEndTime.getTime())) {\n          end = new Date(start.getTime());\n          end = new Date(end.setHours(eventEndTime.getHours(), eventEndTime.getMinutes(), eventEndTime.getSeconds()));\n        } else {\n          end = util.addDays(util.resetTime(new Date(start.getTime())), 1);\n        }\n        index++;\n      }\n    } else {\n      data.push(event);\n    }\n    return data;\n  };\n  EventBase.prototype.splitEvent = function (event, dateRender) {\n    var fields = this.parent.eventFields;\n    var start = util.resetTime(event[fields.startTime]).getTime();\n    var end = util.resetTime(event[fields.endTime]).getTime();\n    if (util.getDateInMs(event[fields.endTime]) <= 0) {\n      var temp = util.addDays(util.resetTime(event[fields.endTime]), -1).getTime();\n      end = start > temp ? start : temp;\n    }\n    var orgStart = start;\n    var orgEnd = end;\n    var ranges = [];\n    if (start !== end) {\n      if (start < dateRender[0].getTime()) {\n        start = dateRender[0].getTime();\n      }\n      if (end > dateRender[dateRender.length - 1].getTime()) {\n        end = dateRender[dateRender.length - 1].getTime();\n      }\n      var cStart = start;\n      for (var level = 0; level < this.slots.length; level++) {\n        var slot = this.slots[parseInt(level.toString(), 10)];\n        if (this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'TimelineWorkWeek' || this.parent.activeViewOptions.group.byDate || this.parent.activeViewOptions.showWeekend) {\n          var slotDates = [];\n          for (var _i = 0, slot_1 = slot; _i < slot_1.length; _i++) {\n            var s = slot_1[_i];\n            slotDates.push(new Date(s));\n          }\n          var renderedDates = this.getRenderedDates(slotDates);\n          if (!isNullOrUndefined(renderedDates) && renderedDates.length > 0) {\n            slot = [];\n            for (var _a = 0, renderedDates_1 = renderedDates; _a < renderedDates_1.length; _a++) {\n              var date = renderedDates_1[_a];\n              slot.push(date.getTime());\n            }\n          }\n        }\n        if (typeof slot === 'number') {\n          var temp = slot;\n          slot = [];\n          slot.push(temp);\n        }\n        var firstSlot = slot[0];\n        cStart = cStart <= firstSlot && end >= firstSlot ? firstSlot : cStart;\n        if (cStart > end || firstSlot > end) {\n          break;\n        }\n        if (!this.parent.activeViewOptions.group.byDate && this.parent.activeViewOptions.showWeekend && this.parent.currentView !== 'WorkWeek' && this.parent.currentView !== 'TimelineWorkWeek') {\n          var startIndex = slot.indexOf(cStart);\n          if (startIndex !== -1) {\n            var endIndex = slot.indexOf(end);\n            var hasBreak = endIndex !== -1;\n            endIndex = hasBreak ? endIndex : slot.length - 1;\n            var count = endIndex - startIndex + 1;\n            var isLeft = slot[parseInt(startIndex.toString(), 10)] !== orgStart;\n            var isRight = slot[parseInt(endIndex.toString(), 10)] !== orgEnd;\n            ranges.push(this.cloneEventObject(event, slot[parseInt(startIndex.toString(), 10)], slot[parseInt(endIndex.toString(), 10)], count, isLeft, isRight));\n            if (hasBreak) {\n              break;\n            }\n          }\n        } else {\n          if (this.dateInRange(cStart, slot[0], slot[slot.length - 1])) {\n            var availSlot = [];\n            for (var i = 0; i < slot.length; i++) {\n              if (this.dateInRange(slot[parseInt(i.toString(), 10)], orgStart, orgEnd)) {\n                availSlot.push(slot[parseInt(i.toString(), 10)]);\n              }\n            }\n            if (availSlot.length > 0) {\n              if (!this.parent.activeViewOptions.group.byDate) {\n                var isLeft = availSlot[0] !== orgStart;\n                var isRight = availSlot[availSlot.length - 1] !== orgEnd;\n                ranges.push(this.cloneEventObject(event, availSlot[0], availSlot[availSlot.length - 1], availSlot.length, isLeft, isRight));\n              } else {\n                for (var _b = 0, availSlot_1 = availSlot; _b < availSlot_1.length; _b++) {\n                  var slot_2 = availSlot_1[_b];\n                  ranges.push(this.cloneEventObject(event, slot_2, slot_2, 1, slot_2 !== orgStart, slot_2 !== orgEnd));\n                }\n              }\n            }\n          }\n        }\n      }\n    } else {\n      ranges.push(this.cloneEventObject(event, start, end, 1, false, false));\n    }\n    return ranges;\n  };\n  EventBase.prototype.cloneEventObject = function (event, start, end, count, isLeft, isRight) {\n    var fields = this.parent.eventFields;\n    var e = extend({}, event, null, true);\n    var data = {\n      count: count,\n      isLeft: isLeft,\n      isRight: isRight\n    };\n    data[fields.startTime] = event[fields.startTime];\n    data[fields.endTime] = event[fields.endTime];\n    e.data = data;\n    e[fields.startTime] = new Date(start);\n    e[fields.endTime] = new Date(end);\n    return e;\n  };\n  EventBase.prototype.dateInRange = function (date, start, end) {\n    return start <= date && date <= end;\n  };\n  EventBase.prototype.getSelectedEventElements = function (target) {\n    this.removeSelectedAppointmentClass();\n    if (this.parent.selectedElements.length <= 0) {\n      this.parent.selectedElements.push(target);\n    } else {\n      var isAlreadySelected = this.parent.selectedElements.filter(function (element) {\n        return element.getAttribute('data-guid') === target.getAttribute('data-guid');\n      });\n      if (isAlreadySelected.length <= 0) {\n        var elementSelector = 'div[data-guid=\"' + target.getAttribute('data-guid') + '\"]';\n        var focusElements = [].slice.call(this.parent.element.querySelectorAll(elementSelector));\n        for (var _i = 0, focusElements_1 = focusElements; _i < focusElements_1.length; _i++) {\n          var element = focusElements_1[_i];\n          this.parent.selectedElements.push(element);\n        }\n      } else {\n        var selectedElements = this.parent.selectedElements.filter(function (element) {\n          return element.getAttribute('data-guid') !== target.getAttribute('data-guid');\n        });\n        this.parent.selectedElements = selectedElements;\n      }\n    }\n    if (target && this.parent.selectedElements.length > 0) {\n      this.addSelectedAppointments(this.parent.selectedElements, false);\n    }\n    return this.parent.selectedElements;\n  };\n  EventBase.prototype.getSelectedEvents = function () {\n    var _this = this;\n    var eventSelect = [];\n    var elementSelect = [];\n    var selectAppointments = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_BORDER));\n    selectAppointments.filter(function (element) {\n      var isAlreadyAdded = eventSelect.filter(function (event) {\n        return event.Guid === element.getAttribute('data-guid');\n      });\n      if (isAlreadyAdded.length === 0) {\n        eventSelect.push(_this.getEventByGuid(element.getAttribute('data-guid')));\n      }\n      elementSelect.push(element);\n    });\n    return {\n      event: eventSelect.length > 1 ? eventSelect : eventSelect[0],\n      element: elementSelect.length > 1 ? elementSelect : elementSelect[0]\n    };\n  };\n  EventBase.prototype.removeSelectedAppointmentClass = function () {\n    var selectedAppointments = this.getSelectedAppointments();\n    removeClass(selectedAppointments, cls.APPOINTMENT_BORDER);\n    if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      removeClass(selectedAppointments, cls.AGENDA_SELECTED_CELL);\n    }\n  };\n  EventBase.prototype.addSelectedAppointments = function (cells, preventFocus) {\n    if (this.parent.currentView !== 'MonthAgenda') {\n      this.parent.removeSelectedClass();\n    }\n    addClass(cells, cls.APPOINTMENT_BORDER);\n    if (cells.length > 0 && !preventFocus) {\n      cells[cells.length - 1].focus();\n    }\n  };\n  EventBase.prototype.getSelectedAppointments = function () {\n    return [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_BORDER + ',.' + cls.APPOINTMENT_CLASS + ':focus'));\n  };\n  EventBase.prototype.focusElement = function (isFocused) {\n    if (this.parent.eventWindow.dialogObject && this.parent.eventWindow.dialogObject.visible) {\n      return;\n    }\n    var activeEle = document.activeElement;\n    var selectedCell = this.parent.getSelectedCells();\n    if (selectedCell.length > 0 && (activeEle && (this.parent.element.contains(activeEle) || selectedCell.indexOf(activeEle) !== -1) || isFocused)) {\n      if (this.parent.keyboardInteractionModule) {\n        var target = !isNullOrUndefined(this.parent.activeCellsData) && this.parent.activeCellsData.element || selectedCell[selectedCell.length - 1];\n        this.parent.keyboardInteractionModule.selectCells(target instanceof Array, target);\n      }\n      return;\n    }\n    var selectedAppointments = this.getSelectedAppointments();\n    if (selectedAppointments.length > 0) {\n      if (this.parent.activeEventData && this.parent.activeEventData.element && selectedAppointments.indexOf(this.parent.activeEventData.element) > -1) {\n        this.parent.activeEventData.element.focus();\n        return;\n      }\n      selectedAppointments[selectedAppointments.length - 1].focus();\n      return;\n    }\n  };\n  EventBase.prototype.selectWorkCellByTime = function (eventsData) {\n    var target;\n    if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      return target;\n    }\n    if (eventsData.length > 0) {\n      var selectedObject = eventsData[eventsData.length - 1];\n      var eventStartTime = selectedObject[this.parent.eventFields.startTime];\n      var nearestTime = void 0;\n      var isAllDay = this.isAllDayAppointment(selectedObject);\n      if (this.parent.currentView === 'Month' || isAllDay || !this.parent.activeViewOptions.timeScale.enable) {\n        nearestTime = new Date(+eventStartTime).setHours(0, 0, 0, 0);\n      } else {\n        nearestTime = this.findNearestSlot(eventStartTime);\n      }\n      var targetArea = void 0;\n      if (isAllDay && ['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) !== -1) {\n        targetArea = this.parent.getAllDayRow();\n      } else {\n        targetArea = this.parent.getContentTable();\n      }\n      var queryString = '[data-date=\"' + new Date(nearestTime).getTime() + '\"]';\n      if (!isNullOrUndefined(this.parent.activeViewOptions.group.resources) && this.parent.activeViewOptions.group.resources.length > 0) {\n        queryString += '[data-group-index=\"' + this.getGroupIndexFromEvent(selectedObject) + '\"]';\n      }\n      target = targetArea.querySelector(queryString);\n      if (target) {\n        this.parent.activeCellsData = this.parent.getCellDetails(target);\n        if (this.parent.keyboardInteractionModule) {\n          this.parent.keyboardInteractionModule.selectCells(false, target);\n        }\n        return target;\n      }\n    }\n    return target;\n  };\n  EventBase.prototype.findNearestSlot = function (appointmentTime) {\n    var msMajorInterval = this.parent.activeViewOptions.timeScale.interval * util.MS_PER_MINUTE;\n    var msInterval = msMajorInterval / this.parent.activeViewOptions.timeScale.slotCount;\n    var numberOfSlots = Math.round(util.MS_PER_DAY / msInterval);\n    var startTime = new Date(appointmentTime);\n    startTime.setHours(0, 0, 0, 0);\n    var slots = Array.from({\n      length: numberOfSlots\n    }, function (_, i) {\n      var slotTime = new Date(startTime.getTime() + i * msInterval);\n      return slotTime;\n    });\n    var nearestSlot = slots.reduce(function (nearest, slot) {\n      var difference = Math.abs(appointmentTime.getTime() - slot.getTime());\n      if (!nearest || difference < Math.abs(appointmentTime.getTime() - nearest.getTime())) {\n        return slot;\n      }\n      return nearest;\n    }, null);\n    return Math.trunc(nearestSlot.getTime() / 1000) * 1000;\n  };\n  EventBase.prototype.getGroupIndexFromEvent = function (eventData) {\n    var levelIndex;\n    var resource;\n    var levelName;\n    var idField;\n    for (var i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n      var resourceData = eventData[this.parent.resourceBase.resourceCollection[parseInt(i.toString(), 10)].field];\n      if (!isNullOrUndefined(resourceData)) {\n        resource = this.parent.resourceBase.resourceCollection[parseInt(i.toString(), 10)];\n        levelIndex = i;\n        levelName = resource.name;\n        idField = resource.field;\n        break;\n      }\n    }\n    if (isNullOrUndefined(levelName) && isNullOrUndefined(levelIndex)) {\n      levelName = this.parent.resourceCollection.slice(-1)[0].name;\n      levelIndex = this.parent.resourceCollection.length - 1;\n      idField = this.parent.resourceCollection.slice(-1)[0].field;\n      resource = this.parent.resourceCollection.filter(function (e, index) {\n        if (e.name === levelName) {\n          levelIndex = index;\n          return e;\n        }\n        return null;\n      })[0];\n    }\n    var id = eventData[\"\" + idField] instanceof Array ? eventData[\"\" + idField][0] : eventData[\"\" + idField];\n    if (levelIndex > 0) {\n      var parentField = this.parent.resourceCollection[levelIndex - 1].field;\n      return this.parent.resourceBase.getIndexFromResourceId(id, levelName, resource, eventData, parentField);\n    } else {\n      return this.parent.resourceBase.getIndexFromResourceId(id, levelName, resource);\n    }\n  };\n  EventBase.prototype.isAllDayAppointment = function (event) {\n    var fieldMapping = this.parent.eventFields;\n    var isAllDay = event[fieldMapping.isAllDay];\n    var isFullDay = (util.getUniversalTime(event[fieldMapping.endTime]) - util.getUniversalTime(event[fieldMapping.startTime])) / util.MS_PER_DAY >= 1;\n    return isAllDay || this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' && isFullDay ? true : false;\n  };\n  EventBase.prototype.addEventListener = function () {\n    this.parent.on(event.documentClick, this.appointmentBorderRemove, this);\n  };\n  EventBase.prototype.removeEventListener = function () {\n    this.parent.off(event.documentClick, this.appointmentBorderRemove);\n  };\n  EventBase.prototype.appointmentBorderRemove = function (event) {\n    var element = event.event.target;\n    if (closest(element, '.' + cls.APPOINTMENT_CLASS)) {\n      if (this.parent.currentView !== 'MonthAgenda') {\n        this.parent.removeSelectedClass();\n      }\n    } else if (!closest(element, '.' + cls.POPUP_OPEN)) {\n      if (this.parent.uiStateValues.isTapHold && closest(element, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS)) {\n        return;\n      }\n      this.parent.uiStateValues.isTapHold = false;\n      this.removeSelectedAppointmentClass();\n      this.parent.selectedElements = [];\n    }\n  };\n  EventBase.prototype.wireAppointmentEvents = function (element, event, isPreventCrud) {\n    if (isPreventCrud === void 0) {\n      isPreventCrud = false;\n    }\n    var isReadOnly = !isNullOrUndefined(event) ? event[this.parent.eventFields.isReadonly] : false;\n    EventHandler.add(element, 'click', this.eventClick, this);\n    if (!this.parent.isAdaptive && !this.parent.activeViewOptions.readonly && !isReadOnly) {\n      EventHandler.add(element, 'touchend', this.eventTouchClick, this);\n      EventHandler.add(element, 'dblclick', this.eventDoubleClick, this);\n    }\n    if (!this.parent.activeViewOptions.readonly && !isReadOnly && !isPreventCrud) {\n      if (this.parent.resizeModule) {\n        this.parent.resizeModule.wireResizeEvent(element);\n      }\n      if (this.parent.dragAndDropModule) {\n        this.parent.dragAndDropModule.wireDragEvent(element);\n      }\n    }\n  };\n  EventBase.prototype.eventTouchClick = function (e) {\n    var _this = this;\n    if (this.parent.uiStateValues.isTouchScroll || this.parent.uiStateValues.isTapHold || this.parent.uiStateValues.action) {\n      this.parent.uiStateValues.isTouchScroll = this.parent.uiStateValues.isTapHold = false;\n      return;\n    }\n    setTimeout(function () {\n      return _this.isDoubleTapped = false;\n    }, 250);\n    e.preventDefault();\n    if (this.isDoubleTapped) {\n      this.eventDoubleClick(e);\n    } else if (!this.isDoubleTapped) {\n      this.isDoubleTapped = true;\n      this.eventClick(e);\n    }\n  };\n  EventBase.prototype.renderResizeHandler = function (element, spanEvent, isReadOnly) {\n    if (!this.parent.resizeModule || !this.parent.allowResizing || this.parent.activeViewOptions.readonly || isReadOnly) {\n      return;\n    }\n    for (var _i = 0, _a = Object.keys(spanEvent); _i < _a.length; _i++) {\n      var resizeEdge = _a[_i];\n      var resizeHandler = createElement('div', {\n        className: cls.EVENT_RESIZE_CLASS\n      });\n      switch (resizeEdge) {\n        case 'isLeft':\n          if (!spanEvent.isLeft) {\n            resizeHandler.appendChild(createElement('div', {\n              className: 'e-left-right-resize'\n            }));\n            addClass([resizeHandler], this.parent.enableRtl ? cls.RIGHT_RESIZE_HANDLER : cls.LEFT_RESIZE_HANDLER);\n            prepend([resizeHandler], element);\n          }\n          break;\n        case 'isRight':\n          if (!spanEvent.isRight) {\n            resizeHandler.appendChild(createElement('div', {\n              className: 'e-left-right-resize'\n            }));\n            addClass([resizeHandler], this.parent.enableRtl ? cls.LEFT_RESIZE_HANDLER : cls.RIGHT_RESIZE_HANDLER);\n            append([resizeHandler], element);\n          }\n          break;\n        case 'isTop':\n          if (!spanEvent.isTop) {\n            resizeHandler.appendChild(createElement('div', {\n              className: 'e-top-bottom-resize'\n            }));\n            addClass([resizeHandler], cls.TOP_RESIZE_HANDLER);\n            prepend([resizeHandler], element);\n          }\n          break;\n        case 'isBottom':\n          if (!spanEvent.isBottom) {\n            resizeHandler.appendChild(createElement('div', {\n              className: 'e-top-bottom-resize'\n            }));\n            addClass([resizeHandler], cls.BOTTOM_RESIZE_HANDLER);\n            append([resizeHandler], element);\n          }\n          break;\n      }\n    }\n  };\n  EventBase.prototype.eventClick = function (eventData) {\n    var _this = this;\n    var target = eventData.target;\n    if (target.classList.contains(cls.DRAG_CLONE_CLASS) || target.classList.contains(cls.RESIZE_CLONE_CLASS) || target.classList.contains(cls.INLINE_SUBJECT_CLASS)) {\n      return;\n    }\n    if ((eventData.ctrlKey || eventData.metaKey) && eventData.which === 1 && this.parent.keyboardInteractionModule) {\n      this.parent.quickPopup.quickPopup.hide();\n      this.parent.selectedElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_BORDER));\n      var target_1 = closest(eventData.target, '.' + cls.APPOINTMENT_CLASS);\n      this.getSelectedEventElements(target_1);\n      this.activeEventData(eventData, false);\n      var selectArgs = {\n        data: this.parent.activeEventData.event,\n        element: this.parent.activeEventData.element,\n        event: eventData,\n        requestType: 'eventSelect'\n      };\n      this.parent.trigger(event.select, selectArgs);\n      var args = extend(this.parent.activeEventData, {\n        cancel: false,\n        originalEvent: eventData\n      });\n      this.parent.trigger(event.eventClick, args);\n    } else {\n      this.removeSelectedAppointmentClass();\n      this.activeEventData(eventData, true);\n      var selectEventArgs = {\n        data: this.parent.activeEventData.event,\n        element: this.parent.activeEventData.element,\n        event: eventData,\n        requestType: 'eventSelect'\n      };\n      this.parent.trigger(event.select, selectEventArgs);\n      var args = extend(this.parent.activeEventData, {\n        cancel: false,\n        originalEvent: eventData\n      });\n      this.parent.trigger(event.eventClick, args, function (eventClickArgs) {\n        if (eventClickArgs.cancel) {\n          _this.removeSelectedAppointmentClass();\n          _this.parent.selectedElements = [];\n          if (_this.parent.quickPopup) {\n            _this.parent.quickPopup.quickPopupHide();\n          }\n        } else {\n          if (_this.parent.currentView === 'Agenda' || _this.parent.currentView === 'MonthAgenda') {\n            addClass([_this.parent.activeEventData.element], cls.AGENDA_SELECTED_CELL);\n          }\n          if (_this.parent.allowInline) {\n            var inlineArgs = {\n              data: eventClickArgs.event,\n              element: eventClickArgs.element,\n              type: 'Event'\n            };\n            _this.parent.notify(event.inlineClick, inlineArgs);\n          } else {\n            _this.parent.notify(event.eventClick, eventClickArgs);\n          }\n        }\n      });\n    }\n  };\n  EventBase.prototype.eventDoubleClick = function (eventData) {\n    var _this = this;\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n    if (eventData.type === 'touchend') {\n      this.activeEventData(eventData, true);\n    }\n    this.removeSelectedAppointmentClass();\n    this.parent.selectedElements = [];\n    if (this.parent.activeEventData.element.classList.contains(cls.INLINE_APPOINTMENT_CLASS) || this.parent.activeEventData.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS)) {\n      return;\n    }\n    var args = extend(this.parent.activeEventData, {\n      cancel: false,\n      originalEvent: eventData\n    });\n    this.parent.trigger(event.eventDoubleClick, args, function (eventDoubleClickArgs) {\n      if (!eventDoubleClickArgs.cancel) {\n        if (!isNullOrUndefined(_this.parent.activeEventData.event) && isNullOrUndefined(_this.parent.activeEventData.event[_this.parent.eventFields.recurrenceID])) {\n          _this.parent.eventWindow.openEditor(_this.parent.activeEventData.event, 'Save');\n        } else {\n          _this.parent.currentAction = 'EditOccurrence';\n          _this.parent.quickPopup.openRecurrenceAlert();\n        }\n      }\n    });\n  };\n  EventBase.prototype.getEventByGuid = function (guid) {\n    return this.parent.eventsProcessed.filter(function (data) {\n      return data.Guid === guid;\n    })[0];\n  };\n  EventBase.prototype.getEventById = function (id) {\n    var _this = this;\n    return this.parent.eventsData.filter(function (data) {\n      return data[_this.parent.eventFields.id] === id;\n    })[0];\n  };\n  EventBase.prototype.generateGuid = function () {\n    return 'xyxxxxyx-xxxy-yxxx-xyxx-xxyxxxxyyxxx'.replace(/[xy]/g, function (c) {\n      var r = Math.random() * 16 | 0;\n      var v = c === 'x' ? r : r & 0x3 | 0x8;\n      return v.toString(16);\n    });\n  };\n  EventBase.prototype.getEventIDType = function () {\n    if (this.parent.eventsData.length !== 0) {\n      return typeof this.parent.eventsData[0][this.parent.eventFields.id];\n    }\n    if (this.parent.blockData.length !== 0) {\n      return typeof this.parent.blockData[0][this.parent.eventFields.id];\n    }\n    return 'string';\n  };\n  EventBase.prototype.getEventMaxID = function (resourceId) {\n    var _this = this;\n    if (this.parent.eventsData.length < 1 && this.parent.blockData.length < 1) {\n      return 1;\n    }\n    var eventId;\n    var idType = this.getEventIDType();\n    if (idType === 'string') {\n      eventId = this.generateGuid();\n    }\n    if (idType === 'number') {\n      var datas = this.parent.eventsData.concat(this.parent.blockData);\n      var appIds = datas.map(function (event) {\n        return event[_this.parent.eventFields.id];\n      });\n      var maxId = appIds.reduce(function (a, b) {\n        return Math.max(a, b);\n      });\n      maxId = isNullOrUndefined(resourceId) ? maxId : maxId + resourceId;\n      eventId = maxId + 1;\n    }\n    return eventId;\n  };\n  EventBase.prototype.activeEventData = function (eventData, isMultiple) {\n    var _this = this;\n    var target = closest(eventData.target, '.' + cls.APPOINTMENT_CLASS);\n    var guid = target.getAttribute('data-guid');\n    if (isMultiple) {\n      this.addSelectedAppointments([].slice.call(this.parent.element.querySelectorAll('div[data-guid=\"' + guid + '\"]')), true);\n      target.focus();\n    }\n    var eventObject = this.getEventByGuid(guid);\n    if (eventObject && eventObject.isSpanned) {\n      eventObject = this.parent.eventsData.filter(function (obj) {\n        return obj[_this.parent.eventFields.id] === eventObject[_this.parent.eventFields.id];\n      })[0];\n    }\n    this.parent.activeEventData = {\n      event: eventObject,\n      element: target\n    };\n  };\n  EventBase.prototype.generateOccurrence = function (event, viewDate, isMaxCount) {\n    var _this = this;\n    var startDate = event[this.parent.eventFields.startTime];\n    var endDate = event[this.parent.eventFields.endTime];\n    var eventRule = event[this.parent.eventFields.recurrenceRule];\n    var timeZoneDiff = endDate.getTimezoneOffset() - startDate.getTimezoneOffset();\n    var duration = endDate.getTime() - startDate.getTime() - timeZoneDiff * 60000;\n    viewDate = new Date((viewDate || this.parent.activeView.startDate()).getTime() - duration);\n    var exception = event[this.parent.eventFields.recurrenceException];\n    var maxCount;\n    if (this.parent.currentView !== 'Agenda' && isMaxCount) {\n      maxCount = util.getDateCount(viewDate, this.parent.activeView.endDate()) + 1;\n    }\n    var newTimezone = this.parent.timezone || this.parent.tzModule.getLocalTimezoneName();\n    var firstDay = this.parent.activeViewOptions.firstDayOfWeek;\n    var calendarMode = this.parent.calendarMode;\n    if (event[this.parent.eventFields.recurrenceRule] && this.isDayBasedRecurrence(event) && this.parent.timezone && event[this.parent.eventFields.startTimezone] && event[this.parent.eventFields.endTimezone]) {\n      startDate = this.parent.tzModule.convert(event[this.parent.eventFields.startTime], this.parent.timezone, event[this.parent.eventFields.startTimezone]);\n    }\n    var dates = generate(startDate, eventRule, exception, firstDay, maxCount, viewDate, calendarMode, newTimezone);\n    if (this.parent.currentView === 'Agenda' && eventRule.indexOf('COUNT') === -1 && eventRule.indexOf('UNTIL') === -1) {\n      if (isNullOrUndefined(event.generatedDates)) {\n        event.generatedDates = {\n          start: new Date(dates[0]),\n          end: new Date(dates[dates.length - 1])\n        };\n      } else {\n        if (dates[0] < event.generatedDates.start.getTime()) {\n          event.generatedDates.start = new Date(dates[0]);\n        }\n        if (dates[dates.length - 1] > event.generatedDates.end.getTime()) {\n          event.generatedDates.end = new Date(dates[dates.length - 1]);\n        }\n      }\n    }\n    var isDSTAdjusted = false;\n    var convertedDates = [];\n    if (event[this.parent.eventFields.recurrenceRule] && this.isDayBasedRecurrence(event) && this.parent.timezone && event[this.parent.eventFields.startTimezone] && event[this.parent.eventFields.endTimezone]) {\n      isDSTAdjusted = true;\n      convertedDates.push.apply(convertedDates, dates.map(function (date) {\n        return _this.parent.tzModule.convert(new Date(date), event[_this.parent.eventFields.startTimezone], _this.parent.timezone).getTime();\n      }));\n    }\n    convertedDates = convertedDates.length > 0 ? convertedDates : dates;\n    var occurrenceCollection = [];\n    for (var _i = 0, convertedDates_1 = convertedDates; _i < convertedDates_1.length; _i++) {\n      var date = convertedDates_1[_i];\n      var clonedObject = extend({}, event, null, true);\n      date = !isDSTAdjusted ? this.getDSTAdjustedTime(date, clonedObject) : date;\n      clonedObject[this.parent.eventFields.startTime] = new Date(date);\n      clonedObject[this.parent.eventFields.endTime] = new Date(new Date(date).setMilliseconds(duration));\n      clonedObject[this.parent.eventFields.recurrenceID] = clonedObject[this.parent.eventFields.id];\n      delete clonedObject[this.parent.eventFields.recurrenceException];\n      delete clonedObject[this.parent.eventFields.followingID];\n      clonedObject.Guid = this.generateGuid();\n      occurrenceCollection.push(clonedObject);\n    }\n    return occurrenceCollection;\n  };\n  EventBase.prototype.isDayBasedRecurrence = function (event) {\n    return event[this.parent.eventFields.recurrenceRule].includes('BYMONTHDAY') || event[this.parent.eventFields.recurrenceRule].includes('BYDAY');\n  };\n  EventBase.prototype.getDSTAdjustedTime = function (date, event) {\n    var occurDate = date;\n    if (this.parent.timezone && (event[this.parent.eventFields.startTimezone] || event[this.parent.eventFields.endTimezone])) {\n      var eventOffset = this.getDSTDiff(event[this.parent.eventFields.startTime], new Date(date), event[this.parent.eventFields.startTimezone]);\n      var schOffset = this.getDSTDiff(event[this.parent.eventFields.startTime], new Date(date), this.parent.timezone);\n      occurDate = new Date(date).getTime() - (eventOffset - schOffset) * 60000;\n    }\n    return occurDate;\n  };\n  EventBase.prototype.getDSTDiff = function (startDate, occurDate, timezone) {\n    var startOffset = this.parent.tzModule.offset(new Date(startDate), timezone);\n    var occurOffset = this.parent.tzModule.offset(new Date(occurDate), timezone);\n    return startOffset - occurOffset;\n  };\n  EventBase.prototype.getParentEvent = function (eventObj, isParent) {\n    if (isParent === void 0) {\n      isParent = false;\n    }\n    var parentEvent;\n    do {\n      eventObj = this.getFollowingEvent(eventObj);\n      if (eventObj) {\n        parentEvent = extend({}, eventObj, null, true);\n      }\n    } while (eventObj && isParent);\n    if (isParent && parentEvent) {\n      var collection = this.getEventCollections(parentEvent);\n      var followObj = collection.follow.slice(-1)[0];\n      if (collection.occurrence.length > 0 && !parentEvent[this.parent.eventFields.recurrenceException]) {\n        followObj = collection.occurrence.slice(-1)[0];\n      }\n      if (followObj) {\n        parentEvent[this.parent.eventFields.recurrenceRule] = followObj[this.parent.eventFields.recurrenceRule];\n      }\n    }\n    return parentEvent;\n  };\n  EventBase.prototype.getEventCollections = function (parentObj, childObj) {\n    var followingCollection = [];\n    var occurrenceCollection = [];\n    var followingEvent = parentObj;\n    do {\n      followingEvent = this.getFollowingEvent(followingEvent, true);\n      if (followingEvent) {\n        followingCollection.push(followingEvent);\n      }\n      occurrenceCollection = occurrenceCollection.concat(this.getOccurrenceEvent(followingEvent || parentObj));\n    } while (followingEvent);\n    var collections = {};\n    if (childObj) {\n      var fields_2 = this.parent.eventFields;\n      collections = {\n        follow: followingCollection.filter(function (eventData) {\n          return eventData[fields_2.startTime] >= childObj[fields_2.startTime];\n        }),\n        occurrence: occurrenceCollection.filter(function (eventData) {\n          return eventData[fields_2.startTime] >= childObj[fields_2.startTime];\n        })\n      };\n    } else {\n      collections = {\n        follow: followingCollection,\n        occurrence: occurrenceCollection\n      };\n    }\n    return collections;\n  };\n  EventBase.prototype.getFollowingEvent = function (parentObj, isReverse) {\n    var fields = this.parent.eventFields;\n    var fieldValue;\n    if (isReverse) {\n      fieldValue = parentObj[fields.id];\n    } else {\n      fieldValue = parentObj[fields.recurrenceID] || parentObj[fields.followingID];\n    }\n    var parentApp = this.parent.eventsData.filter(function (data) {\n      return data[isReverse ? fields.followingID : fields.id] === fieldValue;\n    });\n    return parentApp.shift();\n  };\n  EventBase.prototype.isFollowingEvent = function (parentObj, childObj) {\n    var parentStart = parentObj[this.parent.eventFields.startTime];\n    var childStart = childObj[this.parent.eventFields.startTime];\n    return parentStart.getHours() === childStart.getHours() && parentStart.getMinutes() === childStart.getMinutes() && parentStart.getSeconds() === childStart.getSeconds();\n  };\n  EventBase.prototype.getOccurrenceEvent = function (eventObj, isGuid, isFollowing) {\n    if (isGuid === void 0) {\n      isGuid = false;\n    }\n    if (isFollowing === void 0) {\n      isFollowing = false;\n    }\n    var idField = isGuid ? 'Guid' : isFollowing ? this.parent.eventFields.followingID : this.parent.eventFields.recurrenceID;\n    var fieldKey = isGuid ? 'Guid' : this.parent.eventFields.id;\n    var dataSource = isGuid ? this.parent.eventsProcessed : this.parent.eventsData;\n    return dataSource.filter(function (data) {\n      return data[\"\" + idField] === eventObj[\"\" + fieldKey];\n    });\n  };\n  EventBase.prototype.getOccurrencesByID = function (id) {\n    var fields = this.parent.eventFields;\n    var occurrenceCollection = [];\n    var parentObject = this.parent.eventsData.filter(function (obj) {\n      return obj[fields.id] === id;\n    });\n    for (var _i = 0, parentObject_1 = parentObject; _i < parentObject_1.length; _i++) {\n      var event_4 = parentObject_1[_i];\n      if (!isNullOrUndefined(event_4[fields.recurrenceRule])) {\n        occurrenceCollection = occurrenceCollection.concat(this.generateOccurrence(event_4));\n      }\n    }\n    return occurrenceCollection;\n  };\n  EventBase.prototype.getOccurrencesByRange = function (startTime, endTime) {\n    var fields = this.parent.eventFields;\n    var occurrenceCollection = [];\n    for (var _i = 0, _a = this.parent.eventsData; _i < _a.length; _i++) {\n      var event_5 = _a[_i];\n      if (!isNullOrUndefined(event_5[fields.recurrenceRule])) {\n        occurrenceCollection = occurrenceCollection.concat(this.generateOccurrence(event_5));\n      }\n    }\n    var filter = occurrenceCollection.filter(function (obj) {\n      return obj[fields.startTime] >= startTime && obj[fields.endTime] <= endTime && !isNullOrUndefined(obj[fields.recurrenceID]);\n    });\n    return filter;\n  };\n  EventBase.prototype.getDeletedOccurrences = function (recurrenceData) {\n    var fields = this.parent.eventFields;\n    var parentObject;\n    var deletedOccurrences = [];\n    if (typeof recurrenceData === 'string' || typeof recurrenceData === 'number') {\n      parentObject = this.parent.eventsData.filter(function (obj) {\n        return obj[fields.id] === recurrenceData;\n      })[0];\n    } else {\n      parentObject = extend({}, recurrenceData, null, true);\n    }\n    if (parentObject[fields.recurrenceException]) {\n      var exDateString_1 = parentObject[fields.recurrenceException].split(',');\n      var _loop_3 = function (i, len) {\n        var edited = this_2.parent.eventsData.filter(function (eventObj) {\n          return eventObj[fields.recurrenceID] === parentObject[fields.id] && eventObj[fields.recurrenceException] === exDateString_1[parseInt(i.toString(), 10)];\n        });\n        if (edited.length === 0) {\n          var exDate = getDateFromRecurrenceDateString(exDateString_1[parseInt(i.toString(), 10)]);\n          var childObject = extend({}, recurrenceData, null, true);\n          childObject[fields.recurrenceID] = parentObject[fields.id];\n          delete childObject[fields.followingID];\n          childObject[fields.recurrenceException] = exDateString_1[parseInt(i.toString(), 10)];\n          var startDate = new Date(exDate.getTime());\n          var time = parentObject[fields.endTime].getTime() - parentObject[fields.startTime].getTime();\n          var endDate = new Date(startDate.getTime());\n          endDate.setMilliseconds(time);\n          childObject[fields.startTime] = new Date(startDate.getTime());\n          childObject[fields.endTime] = new Date(endDate.getTime());\n          deletedOccurrences.push(childObject);\n        }\n      };\n      var this_2 = this;\n      for (var i = 0, len = exDateString_1.length; i < len; i++) {\n        _loop_3(i, len);\n      }\n    }\n    return deletedOccurrences;\n  };\n  EventBase.prototype.applyResourceColor = function (element, data, type, index, alpha) {\n    if (!this.parent.resourceBase) {\n      return;\n    }\n    var alphaColor = function (color, alpha) {\n      color = color.replace('#', '');\n      var r = parseInt(color.substring(0, color.length / 3), 16);\n      var g = parseInt(color.substring(color.length / 3, 2 * color.length / 3), 16);\n      var b = parseInt(color.substring(2 * color.length / 3, 3 * color.length / 3), 16);\n      return \"rgba(\" + r + \", \" + g + \", \" + b + \", \" + alpha + \")\";\n    };\n    // index refers groupOrder\n    var color = this.parent.resourceBase.getResourceColor(data, index);\n    if (color) {\n      element.style[type] = !isNullOrUndefined(alpha) ? alphaColor(color, alpha) : color;\n    }\n  };\n  EventBase.prototype.createBlockAppointmentElement = function (record, resIndex, isResourceEventTemplate) {\n    var eventSubject = record[this.parent.eventFields.subject] || this.parent.eventSettings.fields.subject.default;\n    var appointmentWrapper = createElement('div', {\n      className: cls.BLOCK_APPOINTMENT_CLASS,\n      attrs: {\n        'data-id': 'Appointment_' + record[this.parent.eventFields.id],\n        'aria-disabled': 'true'\n      }\n    });\n    var templateElement;\n    if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n      var scheduleId = this.parent.element.id + '_';\n      var viewName = this.parent.activeViewOptions.eventTemplateName;\n      var templateId = scheduleId + viewName + 'eventTemplate';\n      var templateName = isResourceEventTemplate && this.parent.currentView.indexOf('Year') === -1 ? this.parent.getEventTemplateName(resIndex) : 'eventTemplate';\n      templateElement = this.parent.getAppointmentTemplate()(record, this.parent, templateName, templateId, false, undefined, undefined, this.parent.root);\n    } else {\n      var appointmentSubject = createElement('div', {\n        className: cls.SUBJECT_CLASS\n      });\n      this.parent.sanitize(eventSubject, appointmentSubject);\n      templateElement = [appointmentSubject];\n    }\n    append(templateElement, appointmentWrapper);\n    this.setWrapperAttributes(appointmentWrapper, resIndex);\n    return appointmentWrapper;\n  };\n  EventBase.prototype.setWrapperAttributes = function (appointmentWrapper, resIndex) {\n    if (!isNullOrUndefined(this.cssClass)) {\n      addClass([appointmentWrapper], this.cssClass);\n    }\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      appointmentWrapper.setAttribute('data-group-index', resIndex.toString());\n    }\n  };\n  EventBase.prototype.getReadonlyAttribute = function (event) {\n    return (event[this.parent.eventFields.isReadonly] || this.parent.readonly).toString();\n  };\n  EventBase.prototype.isBlockRange = function (eventData) {\n    var eventCollection = eventData instanceof Array ? eventData : [eventData];\n    var isBlockAlert = false;\n    var fields = this.parent.eventFields;\n    for (var _i = 0, _a = eventCollection; _i < _a.length; _i++) {\n      var event_6 = _a[_i];\n      var dataCol = [];\n      if (!isNullOrUndefined(event_6[fields.recurrenceRule]) && (isNullOrUndefined(event_6[fields.recurrenceID]) || event_6[fields.id] === event_6[fields.recurrenceID])) {\n        dataCol = this.generateOccurrence(event_6);\n      } else {\n        dataCol.push(event_6);\n      }\n      for (var _b = 0, dataCol_2 = dataCol; _b < dataCol_2.length; _b++) {\n        var data = dataCol_2[_b];\n        var filterBlockEvents = this.filterBlockEvents(data);\n        if (filterBlockEvents.length > 0) {\n          isBlockAlert = true;\n          break;\n        }\n      }\n    }\n    this.parent.uiStateValues.isBlock = isBlockAlert;\n    return isBlockAlert;\n  };\n  EventBase.prototype.getFilterEventsList = function (dataSource, query) {\n    return new DataManager(dataSource).executeLocal(new Query().where(query));\n  };\n  EventBase.prototype.getSeriesEvents = function (parentEvent, startTime) {\n    var fields = this.parent.eventFields;\n    startTime = isNullOrUndefined(startTime) ? parentEvent[fields.startTime] : startTime;\n    var deleteFutureEditEvents;\n    var futureEvents;\n    var deleteFutureEditEventList = [];\n    var delId = parentEvent[fields.id];\n    var followingId = parentEvent[fields.followingID];\n    var deleteFutureEvent;\n    var startTimeQuery = this.parent.currentAction === 'EditSeries' ? 'greaterthan' : 'greaterthanorequal';\n    do {\n      deleteFutureEvent = new Predicate(fields.followingID, 'equal', delId).and(new Predicate(fields.startTime, startTimeQuery, startTime));\n      futureEvents = this.getFilterEventsList(this.parent.eventsData, deleteFutureEvent);\n      deleteFutureEditEvents = futureEvents.slice(-1)[0];\n      if (!isNullOrUndefined(deleteFutureEditEvents) && deleteFutureEditEvents[fields.id] !== followingId) {\n        deleteFutureEditEventList.push(deleteFutureEditEvents);\n        delId = deleteFutureEditEvents[fields.id];\n        followingId = deleteFutureEditEvents[fields.followingID];\n      } else {\n        followingId = null;\n      }\n    } while (futureEvents.length === 1 && !isNullOrUndefined(deleteFutureEditEvents[fields.followingID]));\n    return deleteFutureEditEventList;\n  };\n  EventBase.prototype.getEditedOccurrences = function (deleteFutureEditEventList, startTime) {\n    var fields = this.parent.eventFields;\n    var deleteRecurrenceEventList = [];\n    var delEditedEvents;\n    for (var _i = 0, deleteFutureEditEventList_1 = deleteFutureEditEventList; _i < deleteFutureEditEventList_1.length; _i++) {\n      var event_7 = deleteFutureEditEventList_1[_i];\n      var delEventQuery = new Predicate(fields.recurrenceID, 'equal', event_7[fields.id]).or(new Predicate(fields.recurrenceID, 'equal', event_7[fields.followingID]).and(new Predicate(fields.recurrenceID, 'notequal', undefined)).and(new Predicate(fields.recurrenceID, 'notequal', null)));\n      if (this.parent.currentAction === 'EditFollowingEvents' || this.parent.currentAction === 'DeleteFollowingEvents') {\n        delEventQuery = delEventQuery.and(new Predicate(fields.startTime, 'greaterthanorequal', startTime));\n      }\n      delEditedEvents = this.getFilterEventsList(this.parent.eventsData, delEventQuery);\n      deleteRecurrenceEventList = deleteRecurrenceEventList.concat(delEditedEvents);\n    }\n    return deleteRecurrenceEventList;\n  };\n  EventBase.prototype.getRenderedDates = function (dateRender) {\n    var firstDate = 0;\n    var lastDate = dateRender.length;\n    var filteredDates;\n    var maxDate = isNullOrUndefined(this.parent.maxDate) ? new Date(2099, 11, 31) : this.parent.maxDate;\n    var minDate = isNullOrUndefined(this.parent.minDate) ? new Date(1900, 0, 1) : this.parent.minDate;\n    if (dateRender[0] < minDate && dateRender[dateRender.length - 1] > maxDate) {\n      for (var i = 0; i < dateRender.length; i++) {\n        if (util.resetTime(dateRender[parseInt(i.toString(), 10)]).getTime() === util.resetTime(new Date(minDate)).getTime()) {\n          firstDate = i;\n        }\n        if (util.resetTime(dateRender[parseInt(i.toString(), 10)]).getTime() === util.resetTime(new Date(maxDate)).getTime()) {\n          lastDate = i;\n        }\n      }\n      filteredDates = dateRender.filter(function (date) {\n        return date >= dateRender[parseInt(firstDate.toString(), 10)] && date <= dateRender[parseInt(lastDate.toString(), 10)];\n      });\n    }\n    return filteredDates;\n  };\n  EventBase.prototype.isValidEvent = function (eventObj, start, end, schedule) {\n    var isHourRange = end.getTime() > schedule.startHour.getTime() && start.getTime() < schedule.endHour.getTime();\n    var isSameRange = schedule.startHour.getTime() <= start.getTime() && eventObj[this.parent.eventFields.startTime].getTime() >= schedule.startHour.getTime() && eventObj[this.parent.eventFields.endTime].getTime() < schedule.endHour.getTime() && start.getTime() === end.getTime();\n    return isHourRange || isSameRange;\n  };\n  EventBase.prototype.allDayExpandScroll = function (dateHeader) {\n    var indentHeight = 0;\n    var headerRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.HEADER_ROW_CLASS));\n    headerRows.forEach(function (element) {\n      var tdEle = [].slice.call(element.children);\n      tdEle.forEach(function (ele) {\n        ele.style.top = indentHeight + 'px';\n      });\n      indentHeight += element.offsetHeight;\n    });\n    indentHeight = dateHeader.offsetHeight - indentHeight;\n    this.parent.element.querySelector('.' + cls.ALLDAY_CELLS_CLASS).style.height = indentHeight / 12 + 'em';\n    if (this.parent.uiStateValues.expand) {\n      addClass([dateHeader], cls.ALLDAY_APPOINTMENT_SCROLL);\n    } else {\n      removeClass([dateHeader], cls.ALLDAY_APPOINTMENT_SCROLL);\n    }\n  };\n  EventBase.prototype.updateEventMinimumDuration = function (startEndHours, startTime, endTime) {\n    if (startTime.getTime() < endTime.getTime() || startTime.getTime() === endTime.getTime() && startEndHours.startHour.getTime() < endTime.getTime() && startEndHours.endHour.getTime() > startTime.getTime() && this.parent.currentView.indexOf('Timeline') === -1) {\n      var eventDuration = (util.getUniversalTime(endTime) - util.getUniversalTime(startTime)) / util.MS_PER_MINUTE;\n      if (eventDuration < this.parent.eventSettings.minimumEventDuration) {\n        var tempEnd = new Date(startTime);\n        tempEnd.setMinutes(tempEnd.getMinutes() + this.parent.eventSettings.minimumEventDuration);\n        endTime = tempEnd;\n        if (endTime.getTime() > startEndHours.endHour.getTime()) {\n          var tempStart = new Date(startEndHours.endHour.getTime());\n          tempStart.setMinutes(tempStart.getMinutes() - this.parent.eventSettings.minimumEventDuration);\n          startTime = tempStart;\n          endTime = startEndHours.endHour;\n        }\n      }\n    }\n    return {\n      startDate: startTime,\n      endDate: endTime\n    };\n  };\n  EventBase.prototype.createEventWrapper = function (type, index) {\n    if (type === void 0) {\n      type = '';\n    }\n    if (index === void 0) {\n      index = 0;\n    }\n    var tr = createElement('tr');\n    var levels = this.parent.activeView.colLevels.slice(-1)[0];\n    var className = this.parent.isReact && this.parent.activeViewOptions.eventTemplate ? ' ' + cls.APPOINTMENT_WRAPPER_HIDDEN_CLASS : '';\n    for (var i = 0, len = levels.length; i < len; i++) {\n      var col = levels[parseInt(i.toString(), 10)];\n      var appointmentWrap = createElement('td', {\n        className: type === 'allDay' ? cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS + className : type === 'timeIndicator' ? cls.TIMELINE_WRAPPER_CLASS : cls.DAY_WRAPPER_CLASS + className,\n        attrs: {\n          'data-date': col.date.getTime().toString()\n        }\n      });\n      if (!isNullOrUndefined(col.groupIndex)) {\n        appointmentWrap.setAttribute('data-group-index', col.groupIndex.toString());\n      }\n      if (type === '') {\n        var innerWrapper = createElement('div', {\n          id: cls.APPOINTMENT_WRAPPER_CLASS + '-' + index.toString(),\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        appointmentWrap.appendChild(innerWrapper);\n      }\n      tr.appendChild(appointmentWrap);\n      index = index + 1;\n    }\n    return tr;\n  };\n  EventBase.prototype.getPageCoordinates = function (e) {\n    if (isNullOrUndefined(e)) {\n      return e;\n    }\n    var eventArgs = e.event;\n    return eventArgs && eventArgs.changedTouches ? eventArgs.changedTouches[0] : e.changedTouches ? e.changedTouches[0] : eventArgs || e;\n  };\n  EventBase.prototype.renderSpannedIcon = function (element, spanEvent) {\n    var iconElement = createElement('div', {\n      className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON\n    });\n    if (spanEvent.isLeft) {\n      var iconLeft = iconElement.cloneNode();\n      addClass([iconLeft], cls.EVENT_ICON_LEFT_CLASS);\n      prepend([iconLeft], element);\n    }\n    if (spanEvent.isRight) {\n      var iconRight = iconElement.cloneNode();\n      addClass([iconRight], cls.EVENT_ICON_RIGHT_CLASS);\n      append([iconRight], element);\n    }\n    if (spanEvent.isTop) {\n      var iconTop = iconElement.cloneNode();\n      addClass([iconTop], cls.EVENT_ICON_UP_CLASS);\n      prepend([iconTop], element);\n    }\n    if (spanEvent.isBottom) {\n      var iconBottom = iconElement.cloneNode();\n      addClass([iconBottom], cls.EVENT_ICON_DOWN_CLASS);\n      append([iconBottom], element);\n    }\n  };\n  EventBase.prototype.addCellHeight = function (selector, eventHeight, eventGap, headerHeight, indHeight, isScrollUpdate) {\n    if (isScrollUpdate === void 0) {\n      isScrollUpdate = true;\n    }\n    if (this.parent.activeViewOptions.maxEventsPerRow && !this.parent.rowAutoHeight) {\n      var rows = [].slice.call(this.parent.element.querySelectorAll(selector));\n      var weekNumberRows = this.parent.showWeekNumber ? [].slice.call(this.parent.element.querySelectorAll('.' + cls.WEEK_NUMBER_WRAPPER_CLASS + ' tbody tr')) : [];\n      for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n        var row = rows_1[_i];\n        var height = this.parent.activeViewOptions.maxEventsPerRow * (eventHeight + (this.parent.currentView === 'Month' ? eventGap : 2)) + headerHeight + indHeight;\n        if (weekNumberRows.length > 0) {\n          setStyleAttribute(weekNumberRows[rows.indexOf(row)].firstElementChild, {\n            'height': height + 'px'\n          });\n        }\n        setStyleAttribute(row.firstElementChild, {\n          'height': height + 'px'\n        });\n      }\n      if (!this.parent.enablePersistence && !this.parent.activeViewOptions.allowVirtualScrolling && isScrollUpdate) {\n        this.parent.notify(event.contentReady, {});\n      }\n    }\n  };\n  EventBase.prototype.unWireEvents = function () {\n    var appElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n    for (var _i = 0, appElements_1 = appElements; _i < appElements_1.length; _i++) {\n      var element = appElements_1[_i];\n      EventHandler.clearEvents(element);\n    }\n  };\n  EventBase.prototype.destroy = function () {\n    this.unWireEvents();\n    this.parent = null;\n  };\n  return EventBase;\n}();\nexport { EventBase };","map":{"version":3,"names":["isNullOrUndefined","closest","extend","EventHandler","setStyleAttribute","createElement","prepend","append","addClass","removeClass","DataManager","Query","Predicate","generate","getDateFromRecurrenceDateString","util","cls","event","EventBase","parent","slots","processedData","isDoubleTapped","prototype","processData","events","timeZonePropChanged","oldTimezone","_this","start","activeView","startDate","end","endDate","fields","eventFields","processed","temp","generateID","resourceCollection","resourceBase","length","id","_loop_1","event_1","this_1","updateEventDateTime","processTimezoneChange","isPrinting","uiStateValues","isPreventTimezone","processTimezone","level","parseInt","toString","field","undefined","recurrenceRule","recurrenceID","crudModule","crudObj","isCrudAction","concat","generateOccurrence","recurrenceEvent","_loop_2","occurrence","app","eventsProcessed","filter","data","startTime","getTime","Guid","generateGuid","push","_i","recurrenceEvent_1","events_1","eventData","isBlock","filterEvents","activeViewOptions","allowOverlap","nonOverlapList","fields_1","_a","_b","overlappingData","findOverlappingData","eventSettings","sortComparer","dataDuration","Date","endTime","duplicateDuration","isAllDay","index","indexOf","splice","blockData","_c","blockData_1","eventObj","isDifferentDate","resetTime","addDays","blockProcessed","eventList","isResource","group","resources","lastLevelResource","newStartTime","newEndTime","eventList_1","existingEvent","compareResourceValues","isOverlapRange","currentAction","eventCollection","Array","isArray","processOverlappingEvents","x","overlappedEvents","isOverlapAlert","eventCollection_1","event_2","dataCol","dataCol_1","overlappingEvents","apply","overlapAppointments","a","b","getValue","value","checkOverlap","quickPopup","openValidationError","getDateFromString","getProcessedEvents","eventsData","eventCollection_2","event_3","timezonePropertyChange","notify","dataReady","timezoneConvert","startTimezone","endTimezone","timezone","startTz","endTz","tzModule","convert","add","remove","isReverse","filterBlockEvents","eStart","eEnd","resourceData","getGroupIndexFromEvent","lastResourceLevel","blockEvents","blockEvents_1","eventObj_1","isDifferentTime","appointments","resourceTdData","predicate","dataModule","getStartEndQuery","json","executeLocal","where","filterEventsByResource","sortByTime","filterEventsByRange","filteredEvents","e","groupOrder","keys","Object","filteredCollection","every","key","appointmentsCollection","customSorting","fieldMappings_1","sort","d1","d2","sortByDateTime","fieldMapping_1","object1","object2","d3","d4","d5","d6","call","splits","split","sortFn","window","getSmallestMissingNumber","array","large","Math","max","i","splitEventByDay","eventStartTime","eventEndTime","getHours","getMinutes","eventLength","getDaysCount","count","isSpanned","setHours","getSeconds","splitEvent","dateRender","getDateInMs","orgStart","orgEnd","ranges","cStart","slot","currentView","byDate","showWeekend","slotDates","slot_1","s","renderedDates","getRenderedDates","renderedDates_1","date","firstSlot","startIndex","endIndex","hasBreak","isLeft","isRight","cloneEventObject","dateInRange","availSlot","availSlot_1","slot_2","getSelectedEventElements","target","removeSelectedAppointmentClass","selectedElements","isAlreadySelected","element","getAttribute","elementSelector","focusElements","slice","querySelectorAll","focusElements_1","addSelectedAppointments","getSelectedEvents","eventSelect","elementSelect","selectAppointments","APPOINTMENT_BORDER","isAlreadyAdded","getEventByGuid","selectedAppointments","getSelectedAppointments","AGENDA_SELECTED_CELL","cells","preventFocus","removeSelectedClass","focus","APPOINTMENT_CLASS","focusElement","isFocused","eventWindow","dialogObject","visible","activeEle","document","activeElement","selectedCell","getSelectedCells","contains","keyboardInteractionModule","activeCellsData","selectCells","activeEventData","selectWorkCellByTime","selectedObject","nearestTime","isAllDayAppointment","timeScale","enable","findNearestSlot","targetArea","getAllDayRow","getContentTable","queryString","querySelector","getCellDetails","appointmentTime","msMajorInterval","interval","MS_PER_MINUTE","msInterval","slotCount","numberOfSlots","round","MS_PER_DAY","from","_","slotTime","nearestSlot","reduce","nearest","difference","abs","trunc","levelIndex","resource","levelName","idField","name","parentField","getIndexFromResourceId","fieldMapping","isFullDay","getUniversalTime","spannedEventPlacement","addEventListener","on","documentClick","appointmentBorderRemove","removeEventListener","off","POPUP_OPEN","isTapHold","WORK_CELLS_CLASS","ALLDAY_CELLS_CLASS","wireAppointmentEvents","isPreventCrud","isReadOnly","isReadonly","eventClick","isAdaptive","readonly","eventTouchClick","eventDoubleClick","resizeModule","wireResizeEvent","dragAndDropModule","wireDragEvent","isTouchScroll","action","setTimeout","preventDefault","renderResizeHandler","spanEvent","allowResizing","resizeEdge","resizeHandler","className","EVENT_RESIZE_CLASS","appendChild","enableRtl","RIGHT_RESIZE_HANDLER","LEFT_RESIZE_HANDLER","isTop","TOP_RESIZE_HANDLER","isBottom","BOTTOM_RESIZE_HANDLER","classList","DRAG_CLONE_CLASS","RESIZE_CLONE_CLASS","INLINE_SUBJECT_CLASS","ctrlKey","metaKey","which","hide","target_1","selectArgs","requestType","trigger","select","args","cancel","originalEvent","selectEventArgs","eventClickArgs","quickPopupHide","allowInline","inlineArgs","type","inlineClick","INLINE_APPOINTMENT_CLASS","eventDoubleClickArgs","openEditor","openRecurrenceAlert","guid","getEventById","replace","c","r","random","v","getEventIDType","getEventMaxID","resourceId","eventId","idType","datas","appIds","map","maxId","isMultiple","eventObject","obj","viewDate","isMaxCount","eventRule","timeZoneDiff","getTimezoneOffset","duration","exception","recurrenceException","maxCount","getDateCount","newTimezone","getLocalTimezoneName","firstDay","firstDayOfWeek","calendarMode","isDayBasedRecurrence","dates","generatedDates","isDSTAdjusted","convertedDates","occurrenceCollection","convertedDates_1","clonedObject","getDSTAdjustedTime","setMilliseconds","followingID","includes","occurDate","eventOffset","getDSTDiff","schOffset","startOffset","offset","occurOffset","getParentEvent","isParent","parentEvent","getFollowingEvent","collection","getEventCollections","followObj","follow","parentObj","childObj","followingCollection","followingEvent","getOccurrenceEvent","collections","fields_2","fieldValue","parentApp","shift","isFollowingEvent","parentStart","childStart","isGuid","isFollowing","fieldKey","dataSource","getOccurrencesByID","parentObject","parentObject_1","event_4","getOccurrencesByRange","event_5","getDeletedOccurrences","recurrenceData","deletedOccurrences","exDateString_1","_loop_3","len","edited","this_2","exDate","childObject","time","applyResourceColor","alpha","alphaColor","color","substring","g","getResourceColor","style","createBlockAppointmentElement","record","resIndex","isResourceEventTemplate","eventSubject","subject","default","appointmentWrapper","BLOCK_APPOINTMENT_CLASS","attrs","templateElement","eventTemplate","scheduleId","viewName","eventTemplateName","templateId","templateName","getEventTemplateName","getAppointmentTemplate","root","appointmentSubject","SUBJECT_CLASS","sanitize","setWrapperAttributes","cssClass","setAttribute","getReadonlyAttribute","isBlockRange","isBlockAlert","event_6","dataCol_2","getFilterEventsList","query","getSeriesEvents","deleteFutureEditEvents","futureEvents","deleteFutureEditEventList","delId","followingId","deleteFutureEvent","startTimeQuery","and","getEditedOccurrences","deleteRecurrenceEventList","delEditedEvents","deleteFutureEditEventList_1","event_7","delEventQuery","or","firstDate","lastDate","filteredDates","maxDate","minDate","isValidEvent","schedule","isHourRange","startHour","endHour","isSameRange","allDayExpandScroll","dateHeader","indentHeight","headerRows","HEADER_ROW_CLASS","forEach","tdEle","children","ele","top","offsetHeight","height","expand","ALLDAY_APPOINTMENT_SCROLL","updateEventMinimumDuration","startEndHours","eventDuration","minimumEventDuration","tempEnd","setMinutes","tempStart","createEventWrapper","tr","levels","colLevels","isReact","APPOINTMENT_WRAPPER_HIDDEN_CLASS","col","appointmentWrap","ALLDAY_APPOINTMENT_WRAPPER_CLASS","TIMELINE_WRAPPER_CLASS","DAY_WRAPPER_CLASS","groupIndex","innerWrapper","APPOINTMENT_WRAPPER_CLASS","getPageCoordinates","eventArgs","changedTouches","renderSpannedIcon","iconElement","EVENT_INDICATOR_CLASS","ICON","iconLeft","cloneNode","EVENT_ICON_LEFT_CLASS","iconRight","EVENT_ICON_RIGHT_CLASS","iconTop","EVENT_ICON_UP_CLASS","iconBottom","EVENT_ICON_DOWN_CLASS","addCellHeight","selector","eventHeight","eventGap","headerHeight","indHeight","isScrollUpdate","maxEventsPerRow","rowAutoHeight","rows","weekNumberRows","showWeekNumber","WEEK_NUMBER_WRAPPER_CLASS","rows_1","row","firstElementChild","enablePersistence","allowVirtualScrolling","contentReady","unWireEvents","appElements","appElements_1","clearEvents","destroy"],"sources":["C:/Users/Dell/OneDrive/Desktop/Programs/soc-portal/node_modules/@syncfusion/ej2-schedule/src/schedule/event-renderer/event-base.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable max-len */\nimport { isNullOrUndefined, closest, extend, EventHandler, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { createElement, prepend, append, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager, Query, Predicate } from '@syncfusion/ej2-data';\nimport { generate, getDateFromRecurrenceDateString } from '../../recurrence-editor/date-generator';\nimport * as util from '../base/util';\nimport * as cls from '../base/css-constant';\nimport * as event from '../base/constant';\n/**\n * EventBase for appointment rendering\n */\nvar EventBase = /** @class */ (function () {\n    /**\n     * Constructor for EventBase\n     *\n     * @param {Schedule} parent Accepts the schedule instance\n     */\n    function EventBase(parent) {\n        this.slots = [];\n        this.processedData = [];\n        this.isDoubleTapped = false;\n        this.parent = parent;\n    }\n    EventBase.prototype.processData = function (events, timeZonePropChanged, oldTimezone) {\n        var _this = this;\n        var start = this.parent.activeView.startDate();\n        var end = this.parent.activeView.endDate();\n        var fields = this.parent.eventFields;\n        var processed = [];\n        var temp = 1;\n        var generateID = false;\n        var resourceCollection = this.parent.resourceBase ? this.parent.resourceBase.resourceCollection : [];\n        if (events.length > 0 && isNullOrUndefined(events[0][fields.id])) {\n            generateID = true;\n        }\n        var _loop_1 = function (event_1) {\n            if (generateID) {\n                event_1[fields.id] = temp++;\n            }\n            event_1 = this_1.updateEventDateTime(event_1);\n            if (timeZonePropChanged) {\n                this_1.processTimezoneChange(event_1, oldTimezone);\n            }\n            else if (!this_1.parent.isPrinting && !this_1.parent.uiStateValues.isPreventTimezone) {\n                event_1 = this_1.processTimezone(event_1);\n            }\n            for (var level = 0; level < resourceCollection.length; level++) {\n                if (event_1[resourceCollection[parseInt(level.toString(), 10)].field] === null || event_1[resourceCollection[parseInt(level.toString(), 10)].field] === 0) {\n                    event_1[resourceCollection[parseInt(level.toString(), 10)].field] = undefined;\n                }\n            }\n            if (!isNullOrUndefined(event_1[fields.recurrenceRule]) && event_1[fields.recurrenceRule] === '') {\n                event_1[fields.recurrenceRule] = null;\n            }\n            if (!isNullOrUndefined(event_1[fields.recurrenceRule]) && isNullOrUndefined(event_1[fields.recurrenceID]) &&\n                !(this_1.parent.crudModule && this_1.parent.crudModule.crudObj.isCrudAction)) {\n                processed = processed.concat(this_1.generateOccurrence(event_1, null, true));\n            }\n            else {\n                if (this_1.parent.crudModule && this_1.parent.crudModule.crudObj.isCrudAction) {\n                    if (!isNullOrUndefined(event_1[fields.recurrenceRule]) && isNullOrUndefined(event_1[fields.recurrenceID])) {\n                        var recurrenceEvent = this_1.generateOccurrence(event_1, null, true);\n                        var _loop_2 = function (occurrence) {\n                            var app = this_1.parent.eventsProcessed.filter(function (data) {\n                                return data[fields.startTime].getTime() - occurrence[fields.startTime].getTime() === 0 &&\n                                    data[fields.id] === occurrence[fields.id];\n                            });\n                            occurrence.Guid = (app.length > 0) ? app[0].Guid : this_1.generateGuid();\n                            processed.push(occurrence);\n                        };\n                        for (var _i = 0, recurrenceEvent_1 = recurrenceEvent; _i < recurrenceEvent_1.length; _i++) {\n                            var occurrence = recurrenceEvent_1[_i];\n                            _loop_2(occurrence);\n                        }\n                    }\n                    else {\n                        var app = this_1.parent.eventsProcessed.filter(function (data) {\n                            return data[_this.parent.eventFields.id] === event_1[_this.parent.eventFields.id];\n                        });\n                        event_1.Guid = (app.length > 0) ? app[0].Guid : this_1.generateGuid();\n                        processed.push(event_1);\n                    }\n                }\n                else {\n                    event_1.Guid = this_1.generateGuid();\n                    processed.push(event_1);\n                }\n            }\n        };\n        var this_1 = this;\n        for (var _i = 0, events_1 = events; _i < events_1.length; _i++) {\n            var event_1 = events_1[_i];\n            _loop_1(event_1);\n        }\n        this.parent.eventsProcessed = [];\n        var eventData = processed.filter(function (data) {\n            return !data[_this.parent.eventFields.isBlock];\n        });\n        this.parent.eventsProcessed = this.filterEvents(start, end, eventData);\n        if (!this.parent.activeViewOptions.allowOverlap && this.parent.eventsProcessed.length > 0) {\n            this.processedData = this.parent.eventsProcessed;\n            var nonOverlapList = [];\n            var fields_1 = this.parent.eventFields;\n            for (var _a = 0, _b = this.parent.eventsProcessed; _a < _b.length; _a++) {\n                var data = _b[_a];\n                var overlappingData = this.findOverlappingData(data, nonOverlapList);\n                if (!overlappingData) {\n                    nonOverlapList.push(data);\n                }\n                else if (!this.parent.eventSettings.sortComparer) {\n                    var dataDuration = new Date(data[fields_1.endTime]).getTime() - new Date(data[fields_1.startTime]).getTime();\n                    var duplicateDuration = new Date(overlappingData[fields_1.endTime]).getTime() - new Date(overlappingData[fields_1.startTime]).getTime();\n                    if ((dataDuration > duplicateDuration && data[fields_1.startTime] === overlappingData[fields_1.startTime]) || (data[fields_1.isAllDay] === true)) {\n                        var index = nonOverlapList.indexOf(overlappingData);\n                        if (index !== -1) {\n                            nonOverlapList.splice(index, 1);\n                        }\n                        nonOverlapList.push(data);\n                    }\n                }\n            }\n            this.parent.eventsProcessed = nonOverlapList;\n        }\n        var blockData = processed.filter(function (data) {\n            return data[_this.parent.eventFields.isBlock];\n        });\n        for (var _c = 0, blockData_1 = blockData; _c < blockData_1.length; _c++) {\n            var eventObj = blockData_1[_c];\n            if (eventObj[fields.isAllDay]) {\n                var isDifferentDate = util.resetTime(new Date(eventObj[fields.startTime].getTime())) <\n                    util.resetTime(new Date(eventObj[fields.endTime].getTime()));\n                if (!isDifferentDate) {\n                    eventObj[fields.startTime] = util.resetTime(eventObj[fields.startTime]);\n                    eventObj[fields.endTime] = util.addDays(util.resetTime(eventObj[fields.endTime]), 1);\n                }\n            }\n        }\n        this.parent.blockProcessed = blockData;\n        return eventData;\n    };\n    EventBase.prototype.findOverlappingData = function (eventData, eventList) {\n        var isResource = this.parent.activeViewOptions.group.resources.length > 0;\n        var resourceCollection = isResource ? this.parent.resourceBase.resourceCollection : [];\n        var lastLevelResource = isResource ? resourceCollection[resourceCollection.length - 1].field : null;\n        var fields = this.parent.eventFields;\n        var newStartTime = new Date(eventData[fields.startTime]);\n        var newEndTime = new Date(eventData[fields.endTime]);\n        for (var _i = 0, eventList_1 = eventList; _i < eventList_1.length; _i++) {\n            var existingEvent = eventList_1[_i];\n            if (newStartTime < existingEvent[fields.endTime] &&\n                newEndTime > existingEvent[fields.startTime] &&\n                existingEvent[fields.id] !== eventData[fields.id] &&\n                (!isResource || isNullOrUndefined(lastLevelResource) ||\n                    this.compareResourceValues(existingEvent[\"\" + lastLevelResource], eventData[\"\" + lastLevelResource]))) {\n                return existingEvent;\n            }\n        }\n        return undefined;\n    };\n    EventBase.prototype.isOverlapRange = function (eventData, currentAction) {\n        var _this = this;\n        if (currentAction === void 0) { currentAction = null; }\n        var isResource = this.parent.activeViewOptions.group.resources.length > 0;\n        var resourceCollection = isResource ? this.parent.resourceBase.resourceCollection : [];\n        var lastLevelResource = isResource ? resourceCollection[resourceCollection.length - 1].field : null;\n        var eventCollection = Array.isArray(eventData) ? eventData : [eventData];\n        var fields = this.parent.eventFields;\n        var processOverlappingEvents = function (data) {\n            return _this.processedData.filter(function (x) {\n                return data[fields.startTime] < x[fields.endTime] &&\n                    data[fields.endTime] > x[fields.startTime] &&\n                    x[fields.id] !== data[fields.id] &&\n                    (!isResource || isNullOrUndefined(lastLevelResource) || _this.compareResourceValues(x[\"\" + lastLevelResource], data[\"\" + lastLevelResource]));\n            });\n        };\n        var overlappedEvents = [];\n        var isOverlapAlert = false;\n        for (var _i = 0, eventCollection_1 = eventCollection; _i < eventCollection_1.length; _i++) {\n            var event_2 = eventCollection_1[_i];\n            var dataCol = !isNullOrUndefined(event_2[fields.recurrenceRule]) &&\n                (isNullOrUndefined(event_2[fields.recurrenceID]) || event_2[fields.recurrenceID] === event_2[fields.id]) &&\n                (isNullOrUndefined(event_2[fields.recurrenceID]) || currentAction === 'EditSeries')\n                ? this.generateOccurrence(event_2)\n                : [event_2];\n            for (var _a = 0, dataCol_1 = dataCol; _a < dataCol_1.length; _a++) {\n                var data = dataCol_1[_a];\n                var overlappingEvents = processOverlappingEvents(data);\n                if (overlappingEvents.length > 0) {\n                    overlappedEvents.push.apply(overlappedEvents, overlappingEvents);\n                }\n                if (this.findOverlappingData(data, this.parent.eventsProcessed)) {\n                    isOverlapAlert = true;\n                }\n            }\n        }\n        this.parent.overlapAppointments = overlappedEvents;\n        return isOverlapAlert;\n    };\n    EventBase.prototype.compareResourceValues = function (a, b) {\n        var getValue = function (value) { return Array.isArray(value) ? value[0] : value; };\n        return getValue(a) === getValue(b);\n    };\n    EventBase.prototype.checkOverlap = function (eventData) {\n        if (!this.parent.activeViewOptions.allowOverlap) {\n            if (this.isOverlapRange(eventData)) {\n                this.parent.quickPopup.openValidationError('overlapAlert', eventData);\n                return true;\n            }\n        }\n        return false;\n    };\n    EventBase.prototype.updateEventDateTime = function (eventData) {\n        if (typeof eventData[this.parent.eventFields.startTime] === 'string') {\n            eventData[this.parent.eventFields.startTime] = util.getDateFromString(eventData[this.parent.eventFields.startTime]);\n        }\n        if (typeof eventData[this.parent.eventFields.endTime] === 'string') {\n            eventData[this.parent.eventFields.endTime] = util.getDateFromString(eventData[this.parent.eventFields.endTime]);\n        }\n        return eventData;\n    };\n    EventBase.prototype.getProcessedEvents = function (eventCollection) {\n        if (eventCollection === void 0) { eventCollection = this.parent.eventsData; }\n        var processed = [];\n        for (var _i = 0, eventCollection_2 = eventCollection; _i < eventCollection_2.length; _i++) {\n            var event_3 = eventCollection_2[_i];\n            if (!isNullOrUndefined(event_3[this.parent.eventFields.recurrenceRule]) &&\n                isNullOrUndefined(event_3[this.parent.eventFields.recurrenceID])) {\n                processed = processed.concat(this.generateOccurrence(event_3));\n            }\n            else {\n                processed.push(event_3);\n            }\n        }\n        return processed;\n    };\n    EventBase.prototype.timezonePropertyChange = function (oldTimezone) {\n        var data = this.parent.eventsData.concat(this.parent.blockData);\n        var processed = this.processData(data, true, oldTimezone);\n        this.parent.notify(event.dataReady, { processedData: processed });\n    };\n    EventBase.prototype.timezoneConvert = function (eventData) {\n        var fields = this.parent.eventFields;\n        eventData[fields.startTimezone] = eventData[fields.startTimezone] || eventData[fields.endTimezone];\n        eventData[fields.endTimezone] = eventData[fields.endTimezone] || eventData[fields.startTimezone];\n        if (this.parent.timezone) {\n            var startTz = eventData[fields.startTimezone];\n            var endTz = eventData[fields.endTimezone];\n            eventData[fields.startTime] = this.parent.tzModule.convert(eventData[fields.startTime], this.parent.timezone, startTz);\n            eventData[fields.endTime] = this.parent.tzModule.convert(eventData[fields.endTime], this.parent.timezone, endTz);\n        }\n    };\n    EventBase.prototype.processTimezoneChange = function (event, oldTimezone) {\n        var fields = this.parent.eventFields;\n        if (event[fields.isAllDay]) {\n            return;\n        }\n        if (oldTimezone && this.parent.timezone) {\n            event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], oldTimezone, this.parent.timezone);\n            event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], oldTimezone, this.parent.timezone);\n        }\n        else if (!oldTimezone && this.parent.timezone) {\n            event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], this.parent.timezone);\n            event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], this.parent.timezone);\n        }\n        else if (oldTimezone && !this.parent.timezone) {\n            event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], oldTimezone);\n            event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], oldTimezone);\n        }\n    };\n    EventBase.prototype.processTimezone = function (event, isReverse) {\n        if (isReverse === void 0) { isReverse = false; }\n        var fields = this.parent.eventFields;\n        if (event[fields.isAllDay]) {\n            return event;\n        }\n        if (event[fields.startTimezone] || event[fields.endTimezone]) {\n            var startTimezone = event[fields.startTimezone] || event[fields.endTimezone];\n            var endTimezone = event[fields.endTimezone] || event[fields.startTimezone];\n            if (isReverse) {\n                if (this.parent.timezone) {\n                    event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], startTimezone, this.parent.timezone);\n                    event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], endTimezone, this.parent.timezone);\n                    event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], this.parent.timezone);\n                    event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], this.parent.timezone);\n                }\n                else {\n                    event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], startTimezone);\n                    event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], endTimezone);\n                }\n            }\n            else {\n                event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], startTimezone);\n                event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], endTimezone);\n                if (this.parent.timezone) {\n                    event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], startTimezone, this.parent.timezone);\n                    event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], endTimezone, this.parent.timezone);\n                }\n            }\n        }\n        else if (this.parent.timezone) {\n            if (isReverse) {\n                event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], this.parent.timezone);\n                event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], this.parent.timezone);\n            }\n            else {\n                event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], this.parent.timezone);\n                event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], this.parent.timezone);\n            }\n        }\n        return event;\n    };\n    EventBase.prototype.filterBlockEvents = function (eventObj) {\n        var fields = this.parent.eventFields;\n        var eStart = eventObj[fields.startTime];\n        var eEnd = eventObj[fields.endTime];\n        var resourceData;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            var data = this.getGroupIndexFromEvent(eventObj);\n            resourceData = this.parent.resourceBase.lastResourceLevel[parseInt(data.toString(), 10)];\n        }\n        var blockEvents = extend([], this.parent.blockProcessed, null, true);\n        for (var _i = 0, blockEvents_1 = blockEvents; _i < blockEvents_1.length; _i++) {\n            var eventObj_1 = blockEvents_1[_i];\n            if (eventObj_1[fields.isAllDay]) {\n                var isDifferentTime = eventObj_1[fields.endTime].getTime() >\n                    util.resetTime(new Date(eventObj_1[fields.endTime].getTime())).getTime();\n                if (isDifferentTime) {\n                    eventObj_1[fields.startTime] = util.resetTime(eventObj_1[fields.startTime]);\n                    eventObj_1[fields.endTime] = util.addDays(util.resetTime(eventObj_1[fields.endTime]), 1);\n                }\n            }\n        }\n        return this.filterEvents(eStart, eEnd, blockEvents, resourceData);\n    };\n    EventBase.prototype.filterEvents = function (startDate, endDate, appointments, resourceTdData) {\n        if (appointments === void 0) { appointments = this.parent.eventsProcessed; }\n        var predicate = this.parent.dataModule.getStartEndQuery(startDate, endDate);\n        var filter = new DataManager({ json: appointments }).executeLocal(new Query().where(predicate));\n        if (resourceTdData) {\n            filter = this.filterEventsByResource(resourceTdData, filter);\n        }\n        return this.sortByTime(filter);\n    };\n    EventBase.prototype.filterEventsByRange = function (eventCollection, startDate, endDate) {\n        var _this = this;\n        var filteredEvents = [];\n        if (startDate && endDate) {\n            filteredEvents = this.filterEvents(startDate, endDate, eventCollection);\n        }\n        else if (startDate && !endDate) {\n            filteredEvents = eventCollection.filter(function (e) { return e[_this.parent.eventFields.startTime] >= startDate; });\n        }\n        else if (!startDate && endDate) {\n            filteredEvents = eventCollection.filter(function (e) { return e[_this.parent.eventFields.endTime] <= endDate; });\n        }\n        else {\n            filteredEvents = eventCollection;\n        }\n        return this.sortByTime(filteredEvents);\n    };\n    EventBase.prototype.filterEventsByResource = function (resourceTdData, appointments) {\n        if (appointments === void 0) { appointments = this.parent.eventsProcessed; }\n        var predicate = {};\n        var resourceCollection = this.parent.resourceBase.resourceCollection;\n        for (var level = 0; level < resourceCollection.length; level++) {\n            predicate[resourceCollection[parseInt(level.toString(), 10)].field] = resourceTdData.groupOrder[parseInt(level.toString(), 10)];\n        }\n        var keys = Object.keys(predicate);\n        var filteredCollection = appointments.filter(function (eventObj) { return keys.every(function (key) {\n            if (eventObj[\"\" + key] instanceof Array) {\n                return eventObj[\"\" + key].indexOf(predicate[\"\" + key]) > -1;\n            }\n            else {\n                return eventObj[\"\" + key] === predicate[\"\" + key];\n            }\n        }); });\n        return filteredCollection;\n    };\n    EventBase.prototype.sortByTime = function (appointmentsCollection) {\n        if (this.parent.eventSettings.sortComparer && (typeof (this.parent.eventSettings.sortComparer) === 'function' || typeof (this.parent.eventSettings.sortComparer) === 'string')) {\n            appointmentsCollection = this.customSorting(appointmentsCollection);\n        }\n        else {\n            var fieldMappings_1 = this.parent.eventFields;\n            appointmentsCollection.sort(function (a, b) {\n                var d1 = a[fieldMappings_1.startTime];\n                var d2 = b[fieldMappings_1.startTime];\n                return d1.getTime() - d2.getTime();\n            });\n        }\n        return appointmentsCollection;\n    };\n    EventBase.prototype.sortByDateTime = function (appointments) {\n        if (this.parent.eventSettings.sortComparer && (typeof (this.parent.eventSettings.sortComparer) === 'function' || typeof (this.parent.eventSettings.sortComparer) === 'string')) {\n            appointments = this.customSorting(appointments);\n        }\n        else {\n            var fieldMapping_1 = this.parent.eventFields;\n            appointments.sort(function (object1, object2) {\n                var d3 = object1[fieldMapping_1.startTime];\n                var d4 = object2[fieldMapping_1.startTime];\n                var d5 = object1[fieldMapping_1.endTime];\n                var d6 = object2[fieldMapping_1.endTime];\n                var d1 = d5.getTime() - d3.getTime();\n                var d2 = d6.getTime() - d4.getTime();\n                return (d3.getTime() - d4.getTime() || d2 - d1);\n            });\n        }\n        return appointments;\n    };\n    EventBase.prototype.customSorting = function (appointments) {\n        if (typeof (this.parent.eventSettings.sortComparer) === 'function') {\n            return this.parent.eventSettings.sortComparer.call(this.parent, appointments);\n        }\n        else if (typeof (this.parent.eventSettings.sortComparer) === 'string') {\n            var splits = this.parent.eventSettings.sortComparer.split('.');\n            var sortFn = void 0;\n            if (!isNullOrUndefined(window)) {\n                sortFn = window[splits[splits.length - 1]];\n            }\n            if (sortFn) {\n                return sortFn(appointments);\n            }\n        }\n        return appointments;\n    };\n    EventBase.prototype.getSmallestMissingNumber = function (array) {\n        var large = Math.max.apply(Math, array);\n        for (var i = 0; i < large; i++) {\n            if (array.indexOf(i) === -1) {\n                return i;\n            }\n        }\n        return large + 1;\n    };\n    EventBase.prototype.splitEventByDay = function (event) {\n        var eventFields = this.parent.eventFields;\n        var data = [];\n        var eventStartTime = event[eventFields.startTime];\n        var eventEndTime = event[eventFields.endTime];\n        var isDifferentDate = util.resetTime(new Date(eventStartTime.getTime())) <\n            util.resetTime(new Date(eventEndTime.getTime()));\n        if (isDifferentDate) {\n            var start = new Date(eventStartTime.getTime());\n            var end = util.addDays(util.resetTime(new Date(eventStartTime.getTime())), 1);\n            var endDate = (eventEndTime.getHours() === 0 && eventEndTime.getMinutes() === 0) ?\n                eventEndTime : util.addDays(eventEndTime, 1);\n            var index = 1;\n            var eventLength = util.getDaysCount(eventStartTime.getTime(), endDate.getTime());\n            while (end <= eventEndTime && start.getTime() !== end.getTime()) {\n                var app = extend({}, event);\n                app[eventFields.startTime] = start;\n                app[eventFields.endTime] = end;\n                app.data = { index: index, count: eventLength };\n                app.Guid = this.generateGuid();\n                app.isSpanned = true;\n                data.push(app);\n                start = end;\n                if ((util.resetTime(new Date(start.getTime())).getTime() === util.resetTime(new Date(eventEndTime.getTime())).getTime())\n                    && !(end.getTime() === eventEndTime.getTime())) {\n                    end = new Date(start.getTime());\n                    end = new Date(end.setHours(eventEndTime.getHours(), eventEndTime.getMinutes(), eventEndTime.getSeconds()));\n                }\n                else {\n                    end = util.addDays(util.resetTime(new Date(start.getTime())), 1);\n                }\n                index++;\n            }\n        }\n        else {\n            data.push(event);\n        }\n        return data;\n    };\n    EventBase.prototype.splitEvent = function (event, dateRender) {\n        var fields = this.parent.eventFields;\n        var start = util.resetTime(event[fields.startTime]).getTime();\n        var end = util.resetTime(event[fields.endTime]).getTime();\n        if (util.getDateInMs(event[fields.endTime]) <= 0) {\n            var temp = util.addDays(util.resetTime(event[fields.endTime]), -1).getTime();\n            end = start > temp ? start : temp;\n        }\n        var orgStart = start;\n        var orgEnd = end;\n        var ranges = [];\n        if (start !== end) {\n            if (start < dateRender[0].getTime()) {\n                start = dateRender[0].getTime();\n            }\n            if (end > dateRender[dateRender.length - 1].getTime()) {\n                end = dateRender[dateRender.length - 1].getTime();\n            }\n            var cStart = start;\n            for (var level = 0; level < this.slots.length; level++) {\n                var slot = this.slots[parseInt(level.toString(), 10)];\n                if (this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'TimelineWorkWeek'\n                    || this.parent.activeViewOptions.group.byDate || this.parent.activeViewOptions.showWeekend) {\n                    var slotDates = [];\n                    for (var _i = 0, slot_1 = slot; _i < slot_1.length; _i++) {\n                        var s = slot_1[_i];\n                        slotDates.push(new Date(s));\n                    }\n                    var renderedDates = this.getRenderedDates(slotDates);\n                    if (!isNullOrUndefined(renderedDates) && renderedDates.length > 0) {\n                        slot = [];\n                        for (var _a = 0, renderedDates_1 = renderedDates; _a < renderedDates_1.length; _a++) {\n                            var date = renderedDates_1[_a];\n                            slot.push(date.getTime());\n                        }\n                    }\n                }\n                if (typeof (slot) === 'number') {\n                    var temp = slot;\n                    slot = [];\n                    slot.push(temp);\n                }\n                var firstSlot = slot[0];\n                cStart = (cStart <= firstSlot && end >= firstSlot) ? firstSlot : cStart;\n                if (cStart > end || firstSlot > end) {\n                    break;\n                }\n                if (!this.parent.activeViewOptions.group.byDate && this.parent.activeViewOptions.showWeekend &&\n                    this.parent.currentView !== 'WorkWeek' && this.parent.currentView !== 'TimelineWorkWeek') {\n                    var startIndex = slot.indexOf(cStart);\n                    if (startIndex !== -1) {\n                        var endIndex = slot.indexOf(end);\n                        var hasBreak = endIndex !== -1;\n                        endIndex = hasBreak ? endIndex : slot.length - 1;\n                        var count = ((endIndex - startIndex) + 1);\n                        var isLeft = (slot[parseInt(startIndex.toString(), 10)] !== orgStart);\n                        var isRight = (slot[parseInt(endIndex.toString(), 10)] !== orgEnd);\n                        ranges.push(this.cloneEventObject(event, slot[parseInt(startIndex.toString(), 10)], slot[parseInt(endIndex.toString(), 10)], count, isLeft, isRight));\n                        if (hasBreak) {\n                            break;\n                        }\n                    }\n                }\n                else {\n                    if (this.dateInRange(cStart, slot[0], slot[slot.length - 1])) {\n                        var availSlot = [];\n                        for (var i = 0; i < slot.length; i++) {\n                            if (this.dateInRange(slot[parseInt(i.toString(), 10)], orgStart, orgEnd)) {\n                                availSlot.push(slot[parseInt(i.toString(), 10)]);\n                            }\n                        }\n                        if (availSlot.length > 0) {\n                            if (!this.parent.activeViewOptions.group.byDate) {\n                                var isLeft = (availSlot[0] !== orgStart);\n                                var isRight = (availSlot[availSlot.length - 1] !== orgEnd);\n                                ranges.push(this.cloneEventObject(event, availSlot[0], availSlot[availSlot.length - 1], availSlot.length, isLeft, isRight));\n                            }\n                            else {\n                                for (var _b = 0, availSlot_1 = availSlot; _b < availSlot_1.length; _b++) {\n                                    var slot_2 = availSlot_1[_b];\n                                    ranges.push(this.cloneEventObject(event, slot_2, slot_2, 1, (slot_2 !== orgStart), (slot_2 !== orgEnd)));\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            ranges.push(this.cloneEventObject(event, start, end, 1, false, false));\n        }\n        return ranges;\n    };\n    EventBase.prototype.cloneEventObject = function (event, start, end, count, isLeft, isRight) {\n        var fields = this.parent.eventFields;\n        var e = extend({}, event, null, true);\n        var data = { count: count, isLeft: isLeft, isRight: isRight };\n        data[fields.startTime] = event[fields.startTime];\n        data[fields.endTime] = event[fields.endTime];\n        e.data = data;\n        e[fields.startTime] = new Date(start);\n        e[fields.endTime] = new Date(end);\n        return e;\n    };\n    EventBase.prototype.dateInRange = function (date, start, end) {\n        return start <= date && date <= end;\n    };\n    EventBase.prototype.getSelectedEventElements = function (target) {\n        this.removeSelectedAppointmentClass();\n        if (this.parent.selectedElements.length <= 0) {\n            this.parent.selectedElements.push(target);\n        }\n        else {\n            var isAlreadySelected = this.parent.selectedElements.filter(function (element) {\n                return element.getAttribute('data-guid') === target.getAttribute('data-guid');\n            });\n            if (isAlreadySelected.length <= 0) {\n                var elementSelector = 'div[data-guid=\"' + target.getAttribute('data-guid') + '\"]';\n                var focusElements = [].slice.call(this.parent.element.querySelectorAll(elementSelector));\n                for (var _i = 0, focusElements_1 = focusElements; _i < focusElements_1.length; _i++) {\n                    var element = focusElements_1[_i];\n                    this.parent.selectedElements.push(element);\n                }\n            }\n            else {\n                var selectedElements = this.parent.selectedElements.filter(function (element) {\n                    return element.getAttribute('data-guid') !== target.getAttribute('data-guid');\n                });\n                this.parent.selectedElements = selectedElements;\n            }\n        }\n        if (target && this.parent.selectedElements.length > 0) {\n            this.addSelectedAppointments(this.parent.selectedElements, false);\n        }\n        return this.parent.selectedElements;\n    };\n    EventBase.prototype.getSelectedEvents = function () {\n        var _this = this;\n        var eventSelect = [];\n        var elementSelect = [];\n        var selectAppointments = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_BORDER));\n        selectAppointments.filter(function (element) {\n            var isAlreadyAdded = eventSelect.filter(function (event) {\n                return event.Guid === element.getAttribute('data-guid');\n            });\n            if (isAlreadyAdded.length === 0) {\n                eventSelect.push(_this.getEventByGuid(element.getAttribute('data-guid')));\n            }\n            elementSelect.push(element);\n        });\n        return {\n            event: eventSelect.length > 1 ? eventSelect : eventSelect[0],\n            element: elementSelect.length > 1 ? elementSelect : elementSelect[0]\n        };\n    };\n    EventBase.prototype.removeSelectedAppointmentClass = function () {\n        var selectedAppointments = this.getSelectedAppointments();\n        removeClass(selectedAppointments, cls.APPOINTMENT_BORDER);\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            removeClass(selectedAppointments, cls.AGENDA_SELECTED_CELL);\n        }\n    };\n    EventBase.prototype.addSelectedAppointments = function (cells, preventFocus) {\n        if (this.parent.currentView !== 'MonthAgenda') {\n            this.parent.removeSelectedClass();\n        }\n        addClass(cells, cls.APPOINTMENT_BORDER);\n        if (cells.length > 0 && !preventFocus) {\n            cells[cells.length - 1].focus();\n        }\n    };\n    EventBase.prototype.getSelectedAppointments = function () {\n        return [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_BORDER + ',.' + cls.APPOINTMENT_CLASS + ':focus'));\n    };\n    EventBase.prototype.focusElement = function (isFocused) {\n        if (this.parent.eventWindow.dialogObject && this.parent.eventWindow.dialogObject.visible) {\n            return;\n        }\n        var activeEle = document.activeElement;\n        var selectedCell = this.parent.getSelectedCells();\n        if (selectedCell.length > 0 && ((activeEle && (this.parent.element.contains(activeEle) ||\n            selectedCell.indexOf(activeEle) !== -1)) || isFocused)) {\n            if (this.parent.keyboardInteractionModule) {\n                var target = ((!isNullOrUndefined(this.parent.activeCellsData) &&\n                    this.parent.activeCellsData.element) || selectedCell[selectedCell.length - 1]);\n                this.parent.keyboardInteractionModule.selectCells(target instanceof Array, target);\n            }\n            return;\n        }\n        var selectedAppointments = this.getSelectedAppointments();\n        if (selectedAppointments.length > 0) {\n            if (this.parent.activeEventData && this.parent.activeEventData.element && selectedAppointments.indexOf(this.parent.activeEventData.element) > -1) {\n                this.parent.activeEventData.element.focus();\n                return;\n            }\n            selectedAppointments[selectedAppointments.length - 1].focus();\n            return;\n        }\n    };\n    EventBase.prototype.selectWorkCellByTime = function (eventsData) {\n        var target;\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            return target;\n        }\n        if (eventsData.length > 0) {\n            var selectedObject = eventsData[eventsData.length - 1];\n            var eventStartTime = selectedObject[this.parent.eventFields.startTime];\n            var nearestTime = void 0;\n            var isAllDay = this.isAllDayAppointment(selectedObject);\n            if (this.parent.currentView === 'Month' || isAllDay || !this.parent.activeViewOptions.timeScale.enable) {\n                nearestTime = new Date(+eventStartTime).setHours(0, 0, 0, 0);\n            }\n            else {\n                nearestTime = this.findNearestSlot(eventStartTime);\n            }\n            var targetArea = void 0;\n            if (isAllDay && ['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) !== -1) {\n                targetArea = this.parent.getAllDayRow();\n            }\n            else {\n                targetArea = this.parent.getContentTable();\n            }\n            var queryString = '[data-date=\"' + new Date(nearestTime).getTime() + '\"]';\n            if (!isNullOrUndefined(this.parent.activeViewOptions.group.resources) &&\n                this.parent.activeViewOptions.group.resources.length > 0) {\n                queryString += '[data-group-index=\"' + this.getGroupIndexFromEvent(selectedObject) + '\"]';\n            }\n            target = targetArea.querySelector(queryString);\n            if (target) {\n                this.parent.activeCellsData = this.parent.getCellDetails(target);\n                if (this.parent.keyboardInteractionModule) {\n                    this.parent.keyboardInteractionModule.selectCells(false, target);\n                }\n                return target;\n            }\n        }\n        return target;\n    };\n    EventBase.prototype.findNearestSlot = function (appointmentTime) {\n        var msMajorInterval = this.parent.activeViewOptions.timeScale.interval * util.MS_PER_MINUTE;\n        var msInterval = msMajorInterval / this.parent.activeViewOptions.timeScale.slotCount;\n        var numberOfSlots = Math.round(util.MS_PER_DAY / msInterval);\n        var startTime = new Date(appointmentTime);\n        startTime.setHours(0, 0, 0, 0);\n        var slots = Array.from({ length: numberOfSlots }, function (_, i) {\n            var slotTime = new Date(startTime.getTime() + i * msInterval);\n            return slotTime;\n        });\n        var nearestSlot = slots.reduce(function (nearest, slot) {\n            var difference = Math.abs(appointmentTime.getTime() - slot.getTime());\n            if (!nearest || difference < Math.abs(appointmentTime.getTime() - nearest.getTime())) {\n                return slot;\n            }\n            return nearest;\n        }, null);\n        return Math.trunc(nearestSlot.getTime() / 1000) * 1000;\n    };\n    EventBase.prototype.getGroupIndexFromEvent = function (eventData) {\n        var levelIndex;\n        var resource;\n        var levelName;\n        var idField;\n        for (var i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n            var resourceData = eventData[this.parent.resourceBase.resourceCollection[parseInt(i.toString(), 10)].field];\n            if (!isNullOrUndefined(resourceData)) {\n                resource = this.parent.resourceBase.resourceCollection[parseInt(i.toString(), 10)];\n                levelIndex = i;\n                levelName = resource.name;\n                idField = resource.field;\n                break;\n            }\n        }\n        if (isNullOrUndefined(levelName) && isNullOrUndefined(levelIndex)) {\n            levelName = this.parent.resourceCollection.slice(-1)[0].name;\n            levelIndex = this.parent.resourceCollection.length - 1;\n            idField = this.parent.resourceCollection.slice(-1)[0].field;\n            resource = this.parent.resourceCollection.filter(function (e, index) {\n                if (e.name === levelName) {\n                    levelIndex = index;\n                    return e;\n                }\n                return null;\n            })[0];\n        }\n        var id = ((eventData[\"\" + idField] instanceof Array) ?\n            eventData[\"\" + idField][0] : eventData[\"\" + idField]);\n        if (levelIndex > 0) {\n            var parentField = this.parent.resourceCollection[levelIndex - 1].field;\n            return this.parent.resourceBase.getIndexFromResourceId(id, levelName, resource, eventData, parentField);\n        }\n        else {\n            return this.parent.resourceBase.getIndexFromResourceId(id, levelName, resource);\n        }\n    };\n    EventBase.prototype.isAllDayAppointment = function (event) {\n        var fieldMapping = this.parent.eventFields;\n        var isAllDay = event[fieldMapping.isAllDay];\n        var isFullDay = ((util.getUniversalTime(event[fieldMapping.endTime]) - util.getUniversalTime(event[fieldMapping.startTime]))\n            / util.MS_PER_DAY) >= 1;\n        return (isAllDay || (this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' && isFullDay)) ? true : false;\n    };\n    EventBase.prototype.addEventListener = function () {\n        this.parent.on(event.documentClick, this.appointmentBorderRemove, this);\n    };\n    EventBase.prototype.removeEventListener = function () {\n        this.parent.off(event.documentClick, this.appointmentBorderRemove);\n    };\n    EventBase.prototype.appointmentBorderRemove = function (event) {\n        var element = event.event.target;\n        if (closest(element, '.' + cls.APPOINTMENT_CLASS)) {\n            if (this.parent.currentView !== 'MonthAgenda') {\n                this.parent.removeSelectedClass();\n            }\n        }\n        else if (!closest(element, '.' + cls.POPUP_OPEN)) {\n            if (this.parent.uiStateValues.isTapHold && closest(element, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS)) {\n                return;\n            }\n            this.parent.uiStateValues.isTapHold = false;\n            this.removeSelectedAppointmentClass();\n            this.parent.selectedElements = [];\n        }\n    };\n    EventBase.prototype.wireAppointmentEvents = function (element, event, isPreventCrud) {\n        if (isPreventCrud === void 0) { isPreventCrud = false; }\n        var isReadOnly = (!isNullOrUndefined(event)) ? event[this.parent.eventFields.isReadonly] : false;\n        EventHandler.add(element, 'click', this.eventClick, this);\n        if (!this.parent.isAdaptive && !this.parent.activeViewOptions.readonly && !isReadOnly) {\n            EventHandler.add(element, 'touchend', this.eventTouchClick, this);\n            EventHandler.add(element, 'dblclick', this.eventDoubleClick, this);\n        }\n        if (!this.parent.activeViewOptions.readonly && !isReadOnly && !isPreventCrud) {\n            if (this.parent.resizeModule) {\n                this.parent.resizeModule.wireResizeEvent(element);\n            }\n            if (this.parent.dragAndDropModule) {\n                this.parent.dragAndDropModule.wireDragEvent(element);\n            }\n        }\n    };\n    EventBase.prototype.eventTouchClick = function (e) {\n        var _this = this;\n        if (this.parent.uiStateValues.isTouchScroll || this.parent.uiStateValues.isTapHold || this.parent.uiStateValues.action) {\n            this.parent.uiStateValues.isTouchScroll = this.parent.uiStateValues.isTapHold = false;\n            return;\n        }\n        setTimeout(function () { return _this.isDoubleTapped = false; }, 250);\n        e.preventDefault();\n        if (this.isDoubleTapped) {\n            this.eventDoubleClick(e);\n        }\n        else if (!this.isDoubleTapped) {\n            this.isDoubleTapped = true;\n            this.eventClick(e);\n        }\n    };\n    EventBase.prototype.renderResizeHandler = function (element, spanEvent, isReadOnly) {\n        if (!this.parent.resizeModule || !this.parent.allowResizing || this.parent.activeViewOptions.readonly || isReadOnly) {\n            return;\n        }\n        for (var _i = 0, _a = Object.keys(spanEvent); _i < _a.length; _i++) {\n            var resizeEdge = _a[_i];\n            var resizeHandler = createElement('div', { className: cls.EVENT_RESIZE_CLASS });\n            switch (resizeEdge) {\n                case 'isLeft':\n                    if (!spanEvent.isLeft) {\n                        resizeHandler.appendChild(createElement('div', { className: 'e-left-right-resize' }));\n                        addClass([resizeHandler], this.parent.enableRtl ? cls.RIGHT_RESIZE_HANDLER : cls.LEFT_RESIZE_HANDLER);\n                        prepend([resizeHandler], element);\n                    }\n                    break;\n                case 'isRight':\n                    if (!spanEvent.isRight) {\n                        resizeHandler.appendChild(createElement('div', { className: 'e-left-right-resize' }));\n                        addClass([resizeHandler], this.parent.enableRtl ? cls.LEFT_RESIZE_HANDLER : cls.RIGHT_RESIZE_HANDLER);\n                        append([resizeHandler], element);\n                    }\n                    break;\n                case 'isTop':\n                    if (!spanEvent.isTop) {\n                        resizeHandler.appendChild(createElement('div', { className: 'e-top-bottom-resize' }));\n                        addClass([resizeHandler], cls.TOP_RESIZE_HANDLER);\n                        prepend([resizeHandler], element);\n                    }\n                    break;\n                case 'isBottom':\n                    if (!spanEvent.isBottom) {\n                        resizeHandler.appendChild(createElement('div', { className: 'e-top-bottom-resize' }));\n                        addClass([resizeHandler], cls.BOTTOM_RESIZE_HANDLER);\n                        append([resizeHandler], element);\n                    }\n                    break;\n            }\n        }\n    };\n    EventBase.prototype.eventClick = function (eventData) {\n        var _this = this;\n        var target = eventData.target;\n        if (target.classList.contains(cls.DRAG_CLONE_CLASS) || target.classList.contains(cls.RESIZE_CLONE_CLASS) ||\n            target.classList.contains(cls.INLINE_SUBJECT_CLASS)) {\n            return;\n        }\n        if ((eventData.ctrlKey || eventData.metaKey) && eventData.which === 1 && this.parent.keyboardInteractionModule) {\n            this.parent.quickPopup.quickPopup.hide();\n            this.parent.selectedElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_BORDER));\n            var target_1 = closest(eventData.target, '.' + cls.APPOINTMENT_CLASS);\n            this.getSelectedEventElements(target_1);\n            this.activeEventData(eventData, false);\n            var selectArgs = {\n                data: this.parent.activeEventData.event,\n                element: this.parent.activeEventData.element,\n                event: eventData, requestType: 'eventSelect'\n            };\n            this.parent.trigger(event.select, selectArgs);\n            var args = extend(this.parent.activeEventData, { cancel: false, originalEvent: eventData });\n            this.parent.trigger(event.eventClick, args);\n        }\n        else {\n            this.removeSelectedAppointmentClass();\n            this.activeEventData(eventData, true);\n            var selectEventArgs = {\n                data: this.parent.activeEventData.event,\n                element: this.parent.activeEventData.element,\n                event: eventData, requestType: 'eventSelect'\n            };\n            this.parent.trigger(event.select, selectEventArgs);\n            var args = extend(this.parent.activeEventData, { cancel: false, originalEvent: eventData });\n            this.parent.trigger(event.eventClick, args, function (eventClickArgs) {\n                if (eventClickArgs.cancel) {\n                    _this.removeSelectedAppointmentClass();\n                    _this.parent.selectedElements = [];\n                    if (_this.parent.quickPopup) {\n                        _this.parent.quickPopup.quickPopupHide();\n                    }\n                }\n                else {\n                    if (_this.parent.currentView === 'Agenda' || _this.parent.currentView === 'MonthAgenda') {\n                        addClass([_this.parent.activeEventData.element], cls.AGENDA_SELECTED_CELL);\n                    }\n                    if (_this.parent.allowInline) {\n                        var inlineArgs = {\n                            data: eventClickArgs.event,\n                            element: eventClickArgs.element,\n                            type: 'Event'\n                        };\n                        _this.parent.notify(event.inlineClick, inlineArgs);\n                    }\n                    else {\n                        _this.parent.notify(event.eventClick, eventClickArgs);\n                    }\n                }\n            });\n        }\n    };\n    EventBase.prototype.eventDoubleClick = function (eventData) {\n        var _this = this;\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if (eventData.type === 'touchend') {\n            this.activeEventData(eventData, true);\n        }\n        this.removeSelectedAppointmentClass();\n        this.parent.selectedElements = [];\n        if (this.parent.activeEventData.element.classList.contains(cls.INLINE_APPOINTMENT_CLASS) ||\n            this.parent.activeEventData.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS)) {\n            return;\n        }\n        var args = extend(this.parent.activeEventData, { cancel: false, originalEvent: eventData });\n        this.parent.trigger(event.eventDoubleClick, args, function (eventDoubleClickArgs) {\n            if (!eventDoubleClickArgs.cancel) {\n                if (!isNullOrUndefined(_this.parent.activeEventData.event) &&\n                    isNullOrUndefined(_this.parent.activeEventData.event[_this.parent.eventFields.recurrenceID])) {\n                    _this.parent.eventWindow.openEditor(_this.parent.activeEventData.event, 'Save');\n                }\n                else {\n                    _this.parent.currentAction = 'EditOccurrence';\n                    _this.parent.quickPopup.openRecurrenceAlert();\n                }\n            }\n        });\n    };\n    EventBase.prototype.getEventByGuid = function (guid) {\n        return this.parent.eventsProcessed.filter(function (data) { return data.Guid === guid; })[0];\n    };\n    EventBase.prototype.getEventById = function (id) {\n        var _this = this;\n        return this.parent.eventsData.filter(function (data) {\n            return data[_this.parent.eventFields.id] === id;\n        })[0];\n    };\n    EventBase.prototype.generateGuid = function () {\n        return 'xyxxxxyx-xxxy-yxxx-xyxx-xxyxxxxyyxxx'.replace(/[xy]/g, function (c) {\n            var r = Math.random() * 16 | 0;\n            var v = (c === 'x') ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    };\n    EventBase.prototype.getEventIDType = function () {\n        if (this.parent.eventsData.length !== 0) {\n            return typeof (this.parent.eventsData[0][this.parent.eventFields.id]);\n        }\n        if (this.parent.blockData.length !== 0) {\n            return typeof (this.parent.blockData[0][this.parent.eventFields.id]);\n        }\n        return 'string';\n    };\n    EventBase.prototype.getEventMaxID = function (resourceId) {\n        var _this = this;\n        if (this.parent.eventsData.length < 1 && this.parent.blockData.length < 1) {\n            return 1;\n        }\n        var eventId;\n        var idType = this.getEventIDType();\n        if (idType === 'string') {\n            eventId = this.generateGuid();\n        }\n        if (idType === 'number') {\n            var datas = this.parent.eventsData.concat(this.parent.blockData);\n            var appIds = datas.map(function (event) { return event[_this.parent.eventFields.id]; });\n            var maxId = appIds.reduce(function (a, b) { return Math.max(a, b); });\n            maxId = isNullOrUndefined(resourceId) ? maxId : maxId + resourceId;\n            eventId = maxId + 1;\n        }\n        return eventId;\n    };\n    EventBase.prototype.activeEventData = function (eventData, isMultiple) {\n        var _this = this;\n        var target = closest(eventData.target, '.' + cls.APPOINTMENT_CLASS);\n        var guid = target.getAttribute('data-guid');\n        if (isMultiple) {\n            this.addSelectedAppointments([].slice.call(this.parent.element.querySelectorAll('div[data-guid=\"' + guid + '\"]')), true);\n            target.focus();\n        }\n        var eventObject = this.getEventByGuid(guid);\n        if (eventObject && eventObject.isSpanned) {\n            eventObject = this.parent.eventsData.filter(function (obj) {\n                return obj[_this.parent.eventFields.id] === eventObject[_this.parent.eventFields.id];\n            })[0];\n        }\n        this.parent.activeEventData = { event: eventObject, element: target };\n    };\n    EventBase.prototype.generateOccurrence = function (event, viewDate, isMaxCount) {\n        var _this = this;\n        var startDate = event[this.parent.eventFields.startTime];\n        var endDate = event[this.parent.eventFields.endTime];\n        var eventRule = event[this.parent.eventFields.recurrenceRule];\n        var timeZoneDiff = endDate.getTimezoneOffset() - startDate.getTimezoneOffset();\n        var duration = (endDate.getTime() - startDate.getTime()) - (timeZoneDiff * 60000);\n        viewDate = new Date((viewDate || this.parent.activeView.startDate()).getTime() - duration);\n        var exception = event[this.parent.eventFields.recurrenceException];\n        var maxCount;\n        if (this.parent.currentView !== 'Agenda' && isMaxCount) {\n            maxCount = util.getDateCount(viewDate, this.parent.activeView.endDate()) + 1;\n        }\n        var newTimezone = this.parent.timezone || this.parent.tzModule.getLocalTimezoneName();\n        var firstDay = this.parent.activeViewOptions.firstDayOfWeek;\n        var calendarMode = this.parent.calendarMode;\n        if (event[this.parent.eventFields.recurrenceRule] && this.isDayBasedRecurrence(event) &&\n            this.parent.timezone && event[this.parent.eventFields.startTimezone] && event[this.parent.eventFields.endTimezone]) {\n            startDate = this.parent.tzModule.convert(event[this.parent.eventFields.startTime], this.parent.timezone, event[this.parent.eventFields.startTimezone]);\n        }\n        var dates = generate(startDate, eventRule, exception, firstDay, maxCount, viewDate, calendarMode, newTimezone);\n        if (this.parent.currentView === 'Agenda' && eventRule.indexOf('COUNT') === -1 && eventRule.indexOf('UNTIL') === -1) {\n            if (isNullOrUndefined(event.generatedDates)) {\n                event.generatedDates = { start: new Date(dates[0]), end: new Date(dates[dates.length - 1]) };\n            }\n            else {\n                if (dates[0] < event.generatedDates.start.getTime()) {\n                    event.generatedDates.start = new Date(dates[0]);\n                }\n                if (dates[dates.length - 1] > event.generatedDates.end.getTime()) {\n                    event.generatedDates.end = new Date(dates[dates.length - 1]);\n                }\n            }\n        }\n        var isDSTAdjusted = false;\n        var convertedDates = [];\n        if (event[this.parent.eventFields.recurrenceRule] && this.isDayBasedRecurrence(event) &&\n            this.parent.timezone && event[this.parent.eventFields.startTimezone] && event[this.parent.eventFields.endTimezone]) {\n            isDSTAdjusted = true;\n            convertedDates.push.apply(convertedDates, dates.map(function (date) {\n                return _this.parent.tzModule.convert(new Date(date), event[_this.parent.eventFields.startTimezone], _this.parent.timezone).getTime();\n            }));\n        }\n        convertedDates = convertedDates.length > 0 ? convertedDates : dates;\n        var occurrenceCollection = [];\n        for (var _i = 0, convertedDates_1 = convertedDates; _i < convertedDates_1.length; _i++) {\n            var date = convertedDates_1[_i];\n            var clonedObject = extend({}, event, null, true);\n            date = !isDSTAdjusted ? this.getDSTAdjustedTime(date, clonedObject) : date;\n            clonedObject[this.parent.eventFields.startTime] = new Date(date);\n            clonedObject[this.parent.eventFields.endTime] = new Date(new Date(date).setMilliseconds(duration));\n            clonedObject[this.parent.eventFields.recurrenceID] = clonedObject[this.parent.eventFields.id];\n            delete clonedObject[this.parent.eventFields.recurrenceException];\n            delete clonedObject[this.parent.eventFields.followingID];\n            clonedObject.Guid = this.generateGuid();\n            occurrenceCollection.push(clonedObject);\n        }\n        return occurrenceCollection;\n    };\n    EventBase.prototype.isDayBasedRecurrence = function (event) {\n        return (event[this.parent.eventFields.recurrenceRule].includes('BYMONTHDAY')\n            || event[this.parent.eventFields.recurrenceRule].includes('BYDAY'));\n    };\n    EventBase.prototype.getDSTAdjustedTime = function (date, event) {\n        var occurDate = date;\n        if (this.parent.timezone &&\n            (event[this.parent.eventFields.startTimezone] || event[this.parent.eventFields.endTimezone])) {\n            var eventOffset = this.getDSTDiff(event[this.parent.eventFields.startTime], new Date(date), event[this.parent.eventFields.startTimezone]);\n            var schOffset = this.getDSTDiff(event[this.parent.eventFields.startTime], new Date(date), this.parent.timezone);\n            occurDate = (new Date(date).getTime() - (eventOffset - schOffset) * 60000);\n        }\n        return occurDate;\n    };\n    EventBase.prototype.getDSTDiff = function (startDate, occurDate, timezone) {\n        var startOffset = this.parent.tzModule.offset(new Date(startDate), timezone);\n        var occurOffset = this.parent.tzModule.offset(new Date(occurDate), timezone);\n        return startOffset - occurOffset;\n    };\n    EventBase.prototype.getParentEvent = function (eventObj, isParent) {\n        if (isParent === void 0) { isParent = false; }\n        var parentEvent;\n        do {\n            eventObj = this.getFollowingEvent(eventObj);\n            if (eventObj) {\n                parentEvent = extend({}, eventObj, null, true);\n            }\n        } while (eventObj && isParent);\n        if (isParent && parentEvent) {\n            var collection = this.getEventCollections(parentEvent);\n            var followObj = collection.follow.slice(-1)[0];\n            if (collection.occurrence.length > 0 && !parentEvent[this.parent.eventFields.recurrenceException]) {\n                followObj = collection.occurrence.slice(-1)[0];\n            }\n            if (followObj) {\n                parentEvent[this.parent.eventFields.recurrenceRule] = followObj[this.parent.eventFields.recurrenceRule];\n            }\n        }\n        return parentEvent;\n    };\n    EventBase.prototype.getEventCollections = function (parentObj, childObj) {\n        var followingCollection = [];\n        var occurrenceCollection = [];\n        var followingEvent = parentObj;\n        do {\n            followingEvent = this.getFollowingEvent(followingEvent, true);\n            if (followingEvent) {\n                followingCollection.push(followingEvent);\n            }\n            occurrenceCollection = occurrenceCollection.concat(this.getOccurrenceEvent(followingEvent || parentObj));\n        } while (followingEvent);\n        var collections = {};\n        if (childObj) {\n            var fields_2 = this.parent.eventFields;\n            collections = {\n                follow: followingCollection.filter(function (eventData) {\n                    return eventData[fields_2.startTime] >= childObj[fields_2.startTime];\n                }),\n                occurrence: occurrenceCollection.filter(function (eventData) {\n                    return eventData[fields_2.startTime] >= childObj[fields_2.startTime];\n                })\n            };\n        }\n        else {\n            collections = { follow: followingCollection, occurrence: occurrenceCollection };\n        }\n        return collections;\n    };\n    EventBase.prototype.getFollowingEvent = function (parentObj, isReverse) {\n        var fields = this.parent.eventFields;\n        var fieldValue;\n        if (isReverse) {\n            fieldValue = parentObj[fields.id];\n        }\n        else {\n            fieldValue = (parentObj[fields.recurrenceID] || parentObj[fields.followingID]);\n        }\n        var parentApp = this.parent.eventsData.filter(function (data) {\n            return data[isReverse ? fields.followingID : fields.id] === fieldValue;\n        });\n        return parentApp.shift();\n    };\n    EventBase.prototype.isFollowingEvent = function (parentObj, childObj) {\n        var parentStart = parentObj[this.parent.eventFields.startTime];\n        var childStart = childObj[this.parent.eventFields.startTime];\n        return parentStart.getHours() === childStart.getHours() && parentStart.getMinutes() === childStart.getMinutes() &&\n            parentStart.getSeconds() === childStart.getSeconds();\n    };\n    EventBase.prototype.getOccurrenceEvent = function (eventObj, isGuid, isFollowing) {\n        if (isGuid === void 0) { isGuid = false; }\n        if (isFollowing === void 0) { isFollowing = false; }\n        var idField = isGuid ? 'Guid' : (isFollowing) ? this.parent.eventFields.followingID : this.parent.eventFields.recurrenceID;\n        var fieldKey = isGuid ? 'Guid' : this.parent.eventFields.id;\n        var dataSource = isGuid ? this.parent.eventsProcessed : this.parent.eventsData;\n        return dataSource.filter(function (data) { return data[\"\" + idField] === eventObj[\"\" + fieldKey]; });\n    };\n    EventBase.prototype.getOccurrencesByID = function (id) {\n        var fields = this.parent.eventFields;\n        var occurrenceCollection = [];\n        var parentObject = this.parent.eventsData.filter(function (obj) { return obj[fields.id] === id; });\n        for (var _i = 0, parentObject_1 = parentObject; _i < parentObject_1.length; _i++) {\n            var event_4 = parentObject_1[_i];\n            if (!isNullOrUndefined(event_4[fields.recurrenceRule])) {\n                occurrenceCollection = occurrenceCollection.concat(this.generateOccurrence(event_4));\n            }\n        }\n        return occurrenceCollection;\n    };\n    EventBase.prototype.getOccurrencesByRange = function (startTime, endTime) {\n        var fields = this.parent.eventFields;\n        var occurrenceCollection = [];\n        for (var _i = 0, _a = this.parent.eventsData; _i < _a.length; _i++) {\n            var event_5 = _a[_i];\n            if (!isNullOrUndefined(event_5[fields.recurrenceRule])) {\n                occurrenceCollection = occurrenceCollection.concat(this.generateOccurrence(event_5));\n            }\n        }\n        var filter = occurrenceCollection.filter(function (obj) {\n            return obj[fields.startTime] >= startTime && obj[fields.endTime] <= endTime && !isNullOrUndefined(obj[fields.recurrenceID]);\n        });\n        return filter;\n    };\n    EventBase.prototype.getDeletedOccurrences = function (recurrenceData) {\n        var fields = this.parent.eventFields;\n        var parentObject;\n        var deletedOccurrences = [];\n        if (typeof recurrenceData === 'string' || typeof recurrenceData === 'number') {\n            parentObject = this.parent.eventsData.filter(function (obj) {\n                return obj[fields.id] === recurrenceData;\n            })[0];\n        }\n        else {\n            parentObject = extend({}, recurrenceData, null, true);\n        }\n        if (parentObject[fields.recurrenceException]) {\n            var exDateString_1 = parentObject[fields.recurrenceException].split(',');\n            var _loop_3 = function (i, len) {\n                var edited = this_2.parent.eventsData.filter(function (eventObj) {\n                    return eventObj[fields.recurrenceID] === parentObject[fields.id] && eventObj[fields.recurrenceException] === exDateString_1[parseInt(i.toString(), 10)];\n                });\n                if (edited.length === 0) {\n                    var exDate = getDateFromRecurrenceDateString(exDateString_1[parseInt(i.toString(), 10)]);\n                    var childObject = extend({}, recurrenceData, null, true);\n                    childObject[fields.recurrenceID] = parentObject[fields.id];\n                    delete childObject[fields.followingID];\n                    childObject[fields.recurrenceException] = exDateString_1[parseInt(i.toString(), 10)];\n                    var startDate = new Date(exDate.getTime());\n                    var time = parentObject[fields.endTime].getTime() - parentObject[fields.startTime].getTime();\n                    var endDate = new Date(startDate.getTime());\n                    endDate.setMilliseconds(time);\n                    childObject[fields.startTime] = new Date(startDate.getTime());\n                    childObject[fields.endTime] = new Date(endDate.getTime());\n                    deletedOccurrences.push(childObject);\n                }\n            };\n            var this_2 = this;\n            for (var i = 0, len = exDateString_1.length; i < len; i++) {\n                _loop_3(i, len);\n            }\n        }\n        return deletedOccurrences;\n    };\n    EventBase.prototype.applyResourceColor = function (element, data, type, index, alpha) {\n        if (!this.parent.resourceBase) {\n            return;\n        }\n        var alphaColor = function (color, alpha) {\n            color = color.replace('#', '');\n            var r = parseInt(color.substring(0, color.length / 3), 16);\n            var g = parseInt(color.substring(color.length / 3, 2 * color.length / 3), 16);\n            var b = parseInt(color.substring(2 * color.length / 3, 3 * color.length / 3), 16);\n            return \"rgba(\" + r + \", \" + g + \", \" + b + \", \" + alpha + \")\";\n        };\n        // index refers groupOrder\n        var color = this.parent.resourceBase.getResourceColor(data, index);\n        if (color) {\n            element.style[type] = !isNullOrUndefined(alpha) ? alphaColor(color, alpha) : color;\n        }\n    };\n    EventBase.prototype.createBlockAppointmentElement = function (record, resIndex, isResourceEventTemplate) {\n        var eventSubject = (record[this.parent.eventFields.subject] || this.parent.eventSettings.fields.subject.default);\n        var appointmentWrapper = createElement('div', {\n            className: cls.BLOCK_APPOINTMENT_CLASS,\n            attrs: {\n                'data-id': 'Appointment_' + record[this.parent.eventFields.id],\n                'aria-disabled': 'true'\n            }\n        });\n        var templateElement;\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n            var scheduleId = this.parent.element.id + '_';\n            var viewName = this.parent.activeViewOptions.eventTemplateName;\n            var templateId = scheduleId + viewName + 'eventTemplate';\n            var templateName = isResourceEventTemplate && this.parent.currentView.indexOf('Year') === -1 ?\n                this.parent.getEventTemplateName(resIndex) : 'eventTemplate';\n            templateElement = this.parent.getAppointmentTemplate()(record, this.parent, templateName, templateId, false, undefined, undefined, this.parent.root);\n        }\n        else {\n            var appointmentSubject = createElement('div', { className: cls.SUBJECT_CLASS });\n            this.parent.sanitize(eventSubject, appointmentSubject);\n            templateElement = [appointmentSubject];\n        }\n        append(templateElement, appointmentWrapper);\n        this.setWrapperAttributes(appointmentWrapper, resIndex);\n        return appointmentWrapper;\n    };\n    EventBase.prototype.setWrapperAttributes = function (appointmentWrapper, resIndex) {\n        if (!isNullOrUndefined(this.cssClass)) {\n            addClass([appointmentWrapper], this.cssClass);\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            appointmentWrapper.setAttribute('data-group-index', resIndex.toString());\n        }\n    };\n    EventBase.prototype.getReadonlyAttribute = function (event) {\n        return (event[this.parent.eventFields.isReadonly] || this.parent.readonly).toString();\n    };\n    EventBase.prototype.isBlockRange = function (eventData) {\n        var eventCollection = (eventData instanceof Array) ? eventData : [eventData];\n        var isBlockAlert = false;\n        var fields = this.parent.eventFields;\n        for (var _i = 0, _a = eventCollection; _i < _a.length; _i++) {\n            var event_6 = _a[_i];\n            var dataCol = [];\n            if (!isNullOrUndefined(event_6[fields.recurrenceRule]) &&\n                (isNullOrUndefined(event_6[fields.recurrenceID]) || event_6[fields.id] === event_6[fields.recurrenceID])) {\n                dataCol = this.generateOccurrence(event_6);\n            }\n            else {\n                dataCol.push(event_6);\n            }\n            for (var _b = 0, dataCol_2 = dataCol; _b < dataCol_2.length; _b++) {\n                var data = dataCol_2[_b];\n                var filterBlockEvents = this.filterBlockEvents(data);\n                if (filterBlockEvents.length > 0) {\n                    isBlockAlert = true;\n                    break;\n                }\n            }\n        }\n        this.parent.uiStateValues.isBlock = isBlockAlert;\n        return isBlockAlert;\n    };\n    EventBase.prototype.getFilterEventsList = function (dataSource, query) {\n        return new DataManager(dataSource).executeLocal(new Query().where(query));\n    };\n    EventBase.prototype.getSeriesEvents = function (parentEvent, startTime) {\n        var fields = this.parent.eventFields;\n        startTime = isNullOrUndefined(startTime) ? parentEvent[fields.startTime] : startTime;\n        var deleteFutureEditEvents;\n        var futureEvents;\n        var deleteFutureEditEventList = [];\n        var delId = parentEvent[fields.id];\n        var followingId = parentEvent[fields.followingID];\n        var deleteFutureEvent;\n        var startTimeQuery = this.parent.currentAction === 'EditSeries' ? 'greaterthan' : 'greaterthanorequal';\n        do {\n            deleteFutureEvent = ((new Predicate(fields.followingID, 'equal', delId))).\n                and(new Predicate(fields.startTime, startTimeQuery, startTime));\n            futureEvents = this.getFilterEventsList(this.parent.eventsData, deleteFutureEvent);\n            deleteFutureEditEvents = futureEvents.slice(-1)[0];\n            if (!isNullOrUndefined(deleteFutureEditEvents) && deleteFutureEditEvents[fields.id] !== followingId) {\n                deleteFutureEditEventList.push(deleteFutureEditEvents);\n                delId = deleteFutureEditEvents[fields.id];\n                followingId = deleteFutureEditEvents[fields.followingID];\n            }\n            else {\n                followingId = null;\n            }\n        } while (futureEvents.length === 1 && !isNullOrUndefined(deleteFutureEditEvents[fields.followingID]));\n        return deleteFutureEditEventList;\n    };\n    EventBase.prototype.getEditedOccurrences = function (deleteFutureEditEventList, startTime) {\n        var fields = this.parent.eventFields;\n        var deleteRecurrenceEventList = [];\n        var delEditedEvents;\n        for (var _i = 0, deleteFutureEditEventList_1 = deleteFutureEditEventList; _i < deleteFutureEditEventList_1.length; _i++) {\n            var event_7 = deleteFutureEditEventList_1[_i];\n            var delEventQuery = new Predicate(fields.recurrenceID, 'equal', event_7[fields.id]).\n                or(new Predicate(fields.recurrenceID, 'equal', event_7[fields.followingID]).\n                and(new Predicate(fields.recurrenceID, 'notequal', undefined)).\n                and(new Predicate(fields.recurrenceID, 'notequal', null)));\n            if (this.parent.currentAction === 'EditFollowingEvents' || this.parent.currentAction === 'DeleteFollowingEvents') {\n                delEventQuery = delEventQuery.and(new Predicate(fields.startTime, 'greaterthanorequal', startTime));\n            }\n            delEditedEvents = this.getFilterEventsList(this.parent.eventsData, delEventQuery);\n            deleteRecurrenceEventList = deleteRecurrenceEventList.concat(delEditedEvents);\n        }\n        return deleteRecurrenceEventList;\n    };\n    EventBase.prototype.getRenderedDates = function (dateRender) {\n        var firstDate = 0;\n        var lastDate = dateRender.length;\n        var filteredDates;\n        var maxDate = isNullOrUndefined(this.parent.maxDate) ? new Date(2099, 11, 31) : this.parent.maxDate;\n        var minDate = isNullOrUndefined(this.parent.minDate) ? new Date(1900, 0, 1) : this.parent.minDate;\n        if (dateRender[0] < minDate && dateRender[dateRender.length - 1] > maxDate) {\n            for (var i = 0; i < dateRender.length; i++) {\n                if (util.resetTime(dateRender[parseInt(i.toString(), 10)]).getTime() === util.resetTime(new Date(minDate)).getTime()) {\n                    firstDate = i;\n                }\n                if (util.resetTime(dateRender[parseInt(i.toString(), 10)]).getTime() === util.resetTime(new Date(maxDate)).getTime()) {\n                    lastDate = i;\n                }\n            }\n            filteredDates = dateRender.filter(function (date) { return date >= dateRender[parseInt(firstDate.toString(), 10)] && date <= dateRender[parseInt(lastDate.toString(), 10)]; });\n        }\n        return filteredDates;\n    };\n    EventBase.prototype.isValidEvent = function (eventObj, start, end, schedule) {\n        var isHourRange = end.getTime() > schedule.startHour.getTime() && start.getTime() < schedule.endHour.getTime();\n        var isSameRange = schedule.startHour.getTime() <= start.getTime() &&\n            eventObj[this.parent.eventFields.startTime].getTime() >= schedule.startHour.getTime() &&\n            eventObj[this.parent.eventFields.endTime].getTime() < schedule.endHour.getTime() && start.getTime() === end.getTime();\n        return isHourRange || isSameRange;\n    };\n    EventBase.prototype.allDayExpandScroll = function (dateHeader) {\n        var indentHeight = 0;\n        var headerRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.HEADER_ROW_CLASS));\n        headerRows.forEach(function (element) {\n            var tdEle = [].slice.call(element.children);\n            tdEle.forEach(function (ele) { ele.style.top = indentHeight + 'px'; });\n            indentHeight += element.offsetHeight;\n        });\n        indentHeight = dateHeader.offsetHeight - indentHeight;\n        this.parent.element.querySelector('.' + cls.ALLDAY_CELLS_CLASS).style.height = (indentHeight / 12) + 'em';\n        if (this.parent.uiStateValues.expand) {\n            addClass([dateHeader], cls.ALLDAY_APPOINTMENT_SCROLL);\n        }\n        else {\n            removeClass([dateHeader], cls.ALLDAY_APPOINTMENT_SCROLL);\n        }\n    };\n    EventBase.prototype.updateEventMinimumDuration = function (startEndHours, startTime, endTime) {\n        if (startTime.getTime() < endTime.getTime() || (startTime.getTime() === endTime.getTime() &&\n            (startEndHours.startHour.getTime() < endTime.getTime() && startEndHours.endHour.getTime() > startTime.getTime()) &&\n            this.parent.currentView.indexOf('Timeline') === -1)) {\n            var eventDuration = (util.getUniversalTime(endTime) - util.getUniversalTime(startTime)) / util.MS_PER_MINUTE;\n            if (eventDuration < this.parent.eventSettings.minimumEventDuration) {\n                var tempEnd = new Date(startTime);\n                tempEnd.setMinutes(tempEnd.getMinutes() + this.parent.eventSettings.minimumEventDuration);\n                endTime = tempEnd;\n                if (endTime.getTime() > startEndHours.endHour.getTime()) {\n                    var tempStart = new Date(startEndHours.endHour.getTime());\n                    tempStart.setMinutes(tempStart.getMinutes() - this.parent.eventSettings.minimumEventDuration);\n                    startTime = tempStart;\n                    endTime = startEndHours.endHour;\n                }\n            }\n        }\n        return { startDate: startTime, endDate: endTime };\n    };\n    EventBase.prototype.createEventWrapper = function (type, index) {\n        if (type === void 0) { type = ''; }\n        if (index === void 0) { index = 0; }\n        var tr = createElement('tr');\n        var levels = this.parent.activeView.colLevels.slice(-1)[0];\n        var className = this.parent.isReact && this.parent.activeViewOptions.eventTemplate ?\n            ' ' + cls.APPOINTMENT_WRAPPER_HIDDEN_CLASS : '';\n        for (var i = 0, len = levels.length; i < len; i++) {\n            var col = levels[parseInt(i.toString(), 10)];\n            var appointmentWrap = createElement('td', {\n                className: (type === 'allDay') ? cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS + className : (type === 'timeIndicator') ?\n                    cls.TIMELINE_WRAPPER_CLASS : cls.DAY_WRAPPER_CLASS + className, attrs: { 'data-date': col.date.getTime().toString() }\n            });\n            if (!isNullOrUndefined(col.groupIndex)) {\n                appointmentWrap.setAttribute('data-group-index', col.groupIndex.toString());\n            }\n            if (type === '') {\n                var innerWrapper = createElement('div', {\n                    id: cls.APPOINTMENT_WRAPPER_CLASS + '-' + index.toString(),\n                    className: cls.APPOINTMENT_WRAPPER_CLASS\n                });\n                appointmentWrap.appendChild(innerWrapper);\n            }\n            tr.appendChild(appointmentWrap);\n            index = index + 1;\n        }\n        return tr;\n    };\n    EventBase.prototype.getPageCoordinates = function (e) {\n        if (isNullOrUndefined(e)) {\n            return e;\n        }\n        var eventArgs = e.event;\n        return eventArgs && eventArgs.changedTouches ? eventArgs.changedTouches[0] : e.changedTouches ? e.changedTouches[0] :\n            eventArgs || e;\n    };\n    EventBase.prototype.renderSpannedIcon = function (element, spanEvent) {\n        var iconElement = createElement('div', { className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON });\n        if (spanEvent.isLeft) {\n            var iconLeft = iconElement.cloneNode();\n            addClass([iconLeft], cls.EVENT_ICON_LEFT_CLASS);\n            prepend([iconLeft], element);\n        }\n        if (spanEvent.isRight) {\n            var iconRight = iconElement.cloneNode();\n            addClass([iconRight], cls.EVENT_ICON_RIGHT_CLASS);\n            append([iconRight], element);\n        }\n        if (spanEvent.isTop) {\n            var iconTop = iconElement.cloneNode();\n            addClass([iconTop], cls.EVENT_ICON_UP_CLASS);\n            prepend([iconTop], element);\n        }\n        if (spanEvent.isBottom) {\n            var iconBottom = iconElement.cloneNode();\n            addClass([iconBottom], cls.EVENT_ICON_DOWN_CLASS);\n            append([iconBottom], element);\n        }\n    };\n    EventBase.prototype.addCellHeight = function (selector, eventHeight, eventGap, headerHeight, indHeight, isScrollUpdate) {\n        if (isScrollUpdate === void 0) { isScrollUpdate = true; }\n        if (this.parent.activeViewOptions.maxEventsPerRow && !this.parent.rowAutoHeight) {\n            var rows = [].slice.call(this.parent.element.querySelectorAll(selector));\n            var weekNumberRows = this.parent.showWeekNumber\n                ? [].slice.call(this.parent.element.querySelectorAll('.' + cls.WEEK_NUMBER_WRAPPER_CLASS + ' tbody tr'))\n                : [];\n            for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n                var row = rows_1[_i];\n                var height = (this.parent.activeViewOptions.maxEventsPerRow *\n                    ((eventHeight + (this.parent.currentView === 'Month' ? eventGap : 2)))) + headerHeight + indHeight;\n                if (weekNumberRows.length > 0) {\n                    setStyleAttribute(weekNumberRows[rows.indexOf(row)].firstElementChild, { 'height': height + 'px' });\n                }\n                setStyleAttribute(row.firstElementChild, { 'height': height + 'px' });\n            }\n            if (!this.parent.enablePersistence && !this.parent.activeViewOptions.allowVirtualScrolling && isScrollUpdate) {\n                this.parent.notify(event.contentReady, {});\n            }\n        }\n    };\n    EventBase.prototype.unWireEvents = function () {\n        var appElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n        for (var _i = 0, appElements_1 = appElements; _i < appElements_1.length; _i++) {\n            var element = appElements_1[_i];\n            EventHandler.clearEvents(element);\n        }\n    };\n    EventBase.prototype.destroy = function () {\n        this.unWireEvents();\n        this.parent = null;\n    };\n    return EventBase;\n}());\nexport { EventBase };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}